import{r as e,m as a,h as t,ac as s,b as n,aN as r,o,p as i,y as c,g as l,cx as h,cy as m,q as u,u as d,E as b,s as p,F as g,G as T}from"./main.js";import{l as f}from"./layout-ae040024.js";import{s as v,g as _,a as S}from"./teamsXhr-c875ec56.js";import{T as y,a as w}from"./TabView-408b9801.js";class TeamsListCtrl{constructor(r){this.isSearchOpen=!1,this.onTabChange=a=>{const t=window.location.search.replace(/\?tab=\w+$/,"");try{window.history.replaceState(window.history.state,"",t+"?tab="+a)}catch(e){}this.currentTab=a,e()},this.closeSearch=e=>{"backbutton"!==e&&this.isSearchOpen&&a.backbutton.stack.pop(),this.isSearchOpen=!1},this.onInput=t((a=>{const t=a.target.value.trim();t.length>=3&&v(t).then((a=>{this.searchResults=a,e()}))}),1e3),this.goSearch=()=>{a.backbutton.stack.push(this.closeSearch),this.isSearchOpen=!0},this.goToTeam=e=>{a.set("/teams/"+e.id)},this.currentTab=r||0,_().then((a=>{this.allTeams=a,e()})).catch(s);const o=n.getUserId();o&&S(o).then((a=>{this.myTeams=a,e()})).catch(s)}}function C(e){const a=[{id:"allTeams",f:()=>function(e){if(!e.allTeams)return o("div.loader_container",[d.getVdom("monochrome")]);return o("ul.teamsSuggestion.native_scroller.page",{oncreate:u(k,void 0,b)},[e.allTeams.currentPageResults.map(j)])}(e)},{id:"myTeams",f:()=>function(e){if(!e.myTeams)return o("div.loader_container",[d.getVdom("monochrome")]);return o("ul.teamsSuggestion.native_scroller.page",{oncreate:u(k,void 0,b)},[e.myTeams.map(j)])}(e)}];return[o("div.tabs-nav-header.subHeader",o(y,{buttons:[{label:i("allTeams")},{label:i("myTeams")}],selectedIndex:e.currentTab,onTabChange:e.onTabChange})),o(w,{selectedIndex:e.currentTab,tabs:a,onTabChange:e.onTabChange})]}function k(e){const t=b(e),s=null==t?void 0:t.dataset;s.id&&a.set("/teams/"+s.id)}function j(e,a){return o("li.list_item.teamSuggestion.nav."+(a%2==0?"even":"odd"),{"data-id":e.id},[e.name,o("span.nbMembers",[e.nbMembers])])}var I={oninit({attrs:e}){p.createDefault(),this.ctrl=new TeamsListCtrl(g(e.tab))},oncreate:T,view(){const e=this.ctrl,a=function(e){return r(o("div.teams_main_header",[o("div.main_header_title",i("teams")),o("button.main_header_button[data-icon=y]",{oncreate:c(e.goSearch)})]))}(e),t=C(e),s=function(e){if(!e.isSearchOpen)return null;const a=["modal","show",l.general.theme.background()].join(" ");return o("div."+a,{id:"searchTeamsModal"},[o("header.main_header",[o("button.main_header_button",{oncreate:c((()=>e.closeSearch()))},[h]),o("div.search_input.allow_select",[o("input",{id:"searchTeams",type:"search",placeholder:i("search"),oninput:e.onInput,autocapitalize:"off",autocomplete:"off",oncreate:m})])]),o("ul.modal_content.native_scroller",{oncreate:u(k,void 0,b)},[e.searchResults?e.searchResults.currentPageResults.map(j):null])])}(e);return f.free(a,t,void 0,s)}};export{I as default};
