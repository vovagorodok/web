/*! Capacitor: https://capacitorjs.com/ - MIT License */
var e;!function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(e||(e={}));class CapacitorException extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const t=t=>{const n=t.CapacitorCustomPlatform||null,r=t.Capacitor||{},i=r.Plugins=r.Plugins||{},a=()=>null!==n?n.name:(e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(t),o=e=>{var t;return null===(t=r.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))},s=new Map;return r.convertFileSrc||(r.convertFileSrc=e=>e),r.getPlatform=a,r.handleError=e=>t.console.error(e),r.isNativePlatform=()=>"web"!==a(),r.isPluginAvailable=e=>{const t=s.get(e);return!!(null==t?void 0:t.platforms.has(a()))||!!o(e)},r.registerPlugin=(t,c={})=>{const l=s.get(t);if(l)return l.proxy;const u=a(),d=o(t);let h;const p=i=>{let a;const o=(...o)=>{const s=(async()=>(!h&&u in c?h=h="function"==typeof c[u]?await c[u]():c[u]:null!==n&&!h&&"web"in c&&(h=h="function"==typeof c.web?await c.web():c.web),h))().then((n=>{const s=((n,i)=>{var a,o;if(!d){if(n)return null===(o=n[i])||void 0===o?void 0:o.bind(n);throw new CapacitorException(`"${t}" plugin is not implemented on ${u}`,e.Unimplemented)}{const e=null==d?void 0:d.methods.find((e=>i===e.name));if(e)return"promise"===e.rtype?e=>r.nativePromise(t,i.toString(),e):(e,n)=>r.nativeCallback(t,i.toString(),e,n);if(n)return null===(a=n[i])||void 0===a?void 0:a.bind(n)}})(n,i);if(s){const e=s(...o);return a=null==e?void 0:e.remove,e}throw new CapacitorException(`"${t}.${i}()" is not implemented on ${u}`,e.Unimplemented)}));return"addListener"===i&&(s.remove=async()=>a()),s};return o.toString=()=>`${i.toString()}() { [capacitor code] }`,Object.defineProperty(o,"name",{value:i,writable:!1,configurable:!1}),o},m=p("addListener"),f=p("removeListener"),g=(e,t)=>{const n=m({eventName:e},t),r=async()=>{const r=await n;f({eventName:e,callbackId:r},t)},i=new Promise((e=>n.then((()=>e({remove:r})))));return i.remove=async()=>{await r()},i},v=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return d?g:m;case"removeListener":return f;default:return p(t)}}});return i[t]=v,s.set(t,{name:t,proxy:v,platforms:new Set([...Object.keys(c),...d?[u]:[]])}),v},r.Exception=CapacitorException,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},n=(e=>e.Capacitor=t(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),r=n.registerPlugin;class WebPlugin{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),n&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const r=this.listeners[e];if(r)r.forEach((e=>e(t)));else if(n){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(t="not implemented"){return new n.Exception(t,e.Unimplemented)}unavailable(t="not available"){return new n.Exception(t,e.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const r=n.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach((t=>{this.notifyListeners(e,t)})))}}const i=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),a=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class CapacitorCookiesPluginWeb extends WebPlugin{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[n,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=a(n).trim(),r=a(r).trim(),t[n]=r})),t}async setCookie(e){try{const t=i(e.key),n=i(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),o=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${r}; path=${a}; ${o};`}catch(e){return Promise.reject(e)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(e){return Promise.reject(e)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}r("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});const o=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),r=((e={})=>{const t=Object.keys(e);return Object.keys(e).map((e=>e.toLocaleLowerCase())).reduce(((n,r,i)=>(n[r]=e[t[i]],n)),{})})(e.headers)["content-type"]||"";if("string"==typeof e.data)n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,r]of Object.entries(e.data||{}))t.set(n,r);n.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,n)=>{t.append(n,e)}));else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const r=new Headers(n.headers);r.delete("content-type"),n.headers=r}else(r.includes("application/json")||"object"==typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class CapacitorHttpPluginWeb extends WebPlugin{async request(e){const t=o(e,e.webFetchExtra),n=((e,t=!0)=>e?Object.entries(e).reduce(((e,n)=>{const[r,i]=n;let a,o;return Array.isArray(i)?(o="",i.forEach((e=>{a=t?encodeURIComponent(e):e,o+=`${r}=${a}&`})),o.slice(0,-1)):(a=t?encodeURIComponent(i):i,o=`${r}=${a}`),`${e}&${o}`}),"").substr(1):null)(e.params,e.shouldEncodeUrlParams),r=n?`${e.url}?${n}`:e.url,i=await fetch(r,t),a=i.headers.get("content-type")||"";let s,c,{responseType:l="text"}=i.ok?e:{};switch(a.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":c=await i.blob(),s=await(async e=>new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>n(e),r.readAsDataURL(e)})))(c);break;case"json":s=await i.json();break;default:s=await i.text()}const u={};return i.headers.forEach(((e,t)=>{u[t]=e})),{data:s,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}r("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb});const s=r("App",{web:()=>import("./web-8a4ee7b5.js").then((e=>new e.AppWeb))}),c=r("Device",{web:()=>import("./web-50f5b535.js").then((e=>new e.DeviceWeb))}),l=r("SplashScreen",{web:()=>import("./web-695214a0.js").then((e=>new e.SplashScreenWeb))}),u=r("Network",{web:()=>import("./web-475114e0.js").then((e=>new e.NetworkWeb))});var d,h;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(d||(d={})),function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"}(h||(h={}));const p=r("Keyboard");function m(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var f="object"==typeof global&&global&&global.Object===Object&&global,g="object"==typeof self&&self&&self.Object===Object&&self,v=f||g||Function("return this")(),b=function(){return v.Date.now()},w=/\s/;var y=/^\s+/;function k(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&w.test(e.charAt(t)););return t}(e)+1).replace(y,""):e}var S=v.Symbol,C=Object.prototype,T=C.hasOwnProperty,P=C.toString,E=S?S.toStringTag:void 0;var O=Object.prototype.toString;var x="[object Null]",_="[object Undefined]",M=S?S.toStringTag:void 0;function N(e){return null==e?void 0===e?_:x:M&&M in Object(e)?function(e){var t=T.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch(e){}var i=P.call(e);return r&&(t?e[E]=n:delete e[E]),i}(e):function(e){return O.call(e)}(e)}var j="[object Symbol]";var D=NaN,L=/^[-+]0x[0-9a-f]+$/i,I=/^0b[01]+$/i,q=/^0o[0-7]+$/i,R=parseInt;function A(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&N(e)==j}(e))return D;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=k(e);var n=I.test(e);return n||q.test(e)?R(e.slice(2),n?2:8):L.test(e)?D:+e}var B="Expected a function",$=Math.max,F=Math.min;function U(e,t,n){var r,i,a,o,s,c,l=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(B);function p(t){var n=r,a=i;return r=i=void 0,l=t,o=e.apply(a,n)}function f(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-l>=a}function g(){var e=b();if(f(e))return v(e);s=setTimeout(g,function(e){var n=t-(e-c);return d?F(n,a-(e-l)):n}(e))}function v(e){return s=void 0,h&&r?p(e):(r=i=void 0,o)}function w(){var e=b(),n=f(e);if(r=arguments,i=this,c=e,n){if(void 0===s)return function(e){return l=e,s=setTimeout(g,t),u?p(e):o}(c);if(d)return clearTimeout(s),s=setTimeout(g,t),p(c)}return void 0===s&&(s=setTimeout(g,t)),o}return t=A(t)||0,m(n)&&(u=!!n.leading,a=(d="maxWait"in n)?$(A(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),w.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=c=i=s=void 0},w.flush=function(){return void 0===s?o:v(b())},w}const z=r("Toast",{web:()=>import("./web-a080d389.js").then((e=>new e.ToastWeb))});var W=6e4;function H(e){return e.getTime()%W}function V(e){var t=new Date(e.getTime()),n=Math.ceil(t.getTimezoneOffset());t.setSeconds(0,0);var r=n>0?(W+H(t))%W:H(t);return n*W+r}function G(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function K(e){G(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):new Date(NaN)}function Y(e,t){G(2,arguments);var n=function(e,t){G(2,arguments);var n=K(e),r=K(t);return n.getTime()-r.getTime()}(e,t)/1e3;return n>0?Math.floor(n):Math.ceil(n)}function X(e){return function(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t=t||{})t.hasOwnProperty(n)&&(e[n]=t[n]);return e}({},e)}var Q={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function J(e){return function(t){var n=t||{},r=n.width?String(n.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}var Z={date:J({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:J({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:J({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ee={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function te(e){return function(t,n){var r,i=n||{};if("formatting"===(i.context?String(i.context):"standalone")&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,o=i.width?String(i.width):a;r=e.formattingValues[o]||e.formattingValues[a]}else{var s=e.defaultWidth,c=i.width?String(i.width):e.defaultWidth;r=e.values[c]||e.values[s]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function ne(e){return function(t,n){var r=String(t),i=n||{},a=i.width,o=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=r.match(o);if(!s)return null;var c,l=s[0],u=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth];return c="[object Array]"===Object.prototype.toString.call(u)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}(u,(function(e){return e.test(l)})):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}(u,(function(e){return e.test(l)})),c=e.valueCallback?e.valueCallback(c):c,{value:c=i.valueCallback?i.valueCallback(c):c,rest:r.slice(l.length)}}}var re,ie={code:"en-US",formatDistance:function(e,t,n){var r;return n=n||{},r="string"==typeof Q[e]?Q[e]:1===t?Q[e].one:Q[e].other.replace("{{count}}",t),n.addSuffix?n.comparison>0?"in "+r:r+" ago":r},formatLong:Z,formatRelative:function(e,t,n,r){return ee[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:te({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:te({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:te({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:te({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:te({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(re={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e,t){var n=String(e),r=t||{},i=n.match(re.matchPattern);if(!i)return null;var a=i[0],o=n.match(re.parsePattern);if(!o)return null;var s=re.valueCallback?re.valueCallback(o[0]):o[0];return{value:s=r.valueCallback?r.valueCallback(s):s,rest:n.slice(a.length)}}),era:ne({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:ne({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:ne({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:ne({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:ne({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},ae=1440,oe=43200,se=525600;function ce(e,t,n){G(2,arguments);var r=n||{},i=r.locale||ie;if(!i.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var a=function(e,t){G(2,arguments);var n=K(e),r=K(t),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}(e,t);if(isNaN(a))throw new RangeError("Invalid time value");var o,s,c=X(r);c.addSuffix=Boolean(r.addSuffix),c.comparison=a,a>0?(o=K(t),s=K(e)):(o=K(e),s=K(t));var l,u=null==r.roundingMethod?"round":String(r.roundingMethod);if("floor"===u)l=Math.floor;else if("ceil"===u)l=Math.ceil;else{if("round"!==u)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");l=Math.round}var d,h=Y(s,o),p=l((h-(V(s)-V(o))/1e3)/60);if("second"===(d=null==r.unit?p<1?"second":p<60?"minute":p<ae?"hour":p<oe?"day":p<se?"month":"year":String(r.unit)))return i.formatDistance("xSeconds",h,c);if("minute"===d)return i.formatDistance("xMinutes",p,c);if("hour"===d){var m=l(p/60);return i.formatDistance("xHours",m,c)}if("day"===d){var f=l(p/ae);return i.formatDistance("xDays",f,c)}if("month"===d){var g=l(p/oe);return i.formatDistance("xMonths",g,c)}if("year"===d){var v=l(p/se);return i.formatDistance("xYears",v,c)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function le(e){G(1,arguments);var t=K(e);return t.setHours(0,0,0,0),t}var ue=864e5;function de(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function he(e,t){G(2,arguments);var n=K(e).getTime(),r=de(t);return new Date(n+r)}function pe(e,t){return G(2,arguments),he(e,-de(t))}function me(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var fe={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return me("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):me(n+1,2)},d:function(e,t){return me(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return n.toUpperCase();case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return me(e.getUTCHours()%12||12,t.length)},H:function(e,t){return me(e.getUTCHours(),t.length)},m:function(e,t){return me(e.getUTCMinutes(),t.length)},s:function(e,t){return me(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return me(Math.floor(r*Math.pow(10,n-3)),t.length)}};function ge(e){G(1,arguments);var t=K(e),n=t.getUTCDay(),r=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function ve(e){G(1,arguments);var t=K(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=ge(r),a=new Date(0);a.setUTCFullYear(n,0,4),a.setUTCHours(0,0,0,0);var o=ge(a);return t.getTime()>=i.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function be(e){G(1,arguments);var t=K(e),n=ge(t).getTime()-function(e){G(1,arguments);var t=ve(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),ge(n)}(t).getTime();return Math.round(n/6048e5)+1}function we(e,t){G(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.weekStartsOn,a=null==i?0:de(i),o=null==n.weekStartsOn?a:de(n.weekStartsOn);if(!(o>=0&&o<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=K(e),c=s.getUTCDay(),l=(c<o?7:0)+c-o;return s.setUTCDate(s.getUTCDate()-l),s.setUTCHours(0,0,0,0),s}function ye(e,t){G(1,arguments);var n=K(e,t),r=n.getUTCFullYear(),i=t||{},a=i.locale,o=a&&a.options&&a.options.firstWeekContainsDate,s=null==o?1:de(o),c=null==i.firstWeekContainsDate?s:de(i.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=new Date(0);l.setUTCFullYear(r+1,0,c),l.setUTCHours(0,0,0,0);var u=we(l,t),d=new Date(0);d.setUTCFullYear(r,0,c),d.setUTCHours(0,0,0,0);var h=we(d,t);return n.getTime()>=u.getTime()?r+1:n.getTime()>=h.getTime()?r:r-1}function ke(e,t){G(1,arguments);var n=K(e),r=we(n,t).getTime()-function(e,t){G(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.firstWeekContainsDate,a=null==i?1:de(i),o=null==n.firstWeekContainsDate?a:de(n.firstWeekContainsDate),s=ye(e,t),c=new Date(0);return c.setUTCFullYear(s,0,o),c.setUTCHours(0,0,0,0),we(c,t)}(n,t).getTime();return Math.round(r/6048e5)+1}var Se="midnight",Ce="noon",Te="morning",Pe="afternoon",Ee="evening",Oe="night",xe={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return fe.y(e,t)},Y:function(e,t,n,r){var i=ye(e,r),a=i>0?i:1-i;return"YY"===t?me(a%100,2):"Yo"===t?n.ordinalNumber(a,{unit:"year"}):me(a,t.length)},R:function(e,t){return me(ve(e),t.length)},u:function(e,t){return me(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return me(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return me(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return fe.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return me(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=ke(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):me(i,t.length)},I:function(e,t,n){var r=be(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):me(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):fe.d(e,t)},D:function(e,t,n){var r=function(e){G(1,arguments);var t=K(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):me(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var i=e.getUTCDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return me(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var i=e.getUTCDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return me(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return me(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,i=e.getUTCHours();switch(r=12===i?Ce:0===i?Se:i/12>=1?"pm":"am",t){case"b":case"bb":case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,i=e.getUTCHours();switch(r=i>=17?Ee:i>=12?Pe:i>=4?Te:Oe,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return fe.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):fe.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):me(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):me(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):fe.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):fe.s(e,t)},S:function(e,t){return fe.S(e,t)},X:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return Me(i);case"XXXX":case"XX":return Ne(i);default:return Ne(i,":")}},x:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Me(i);case"xxxx":case"xx":return Ne(i);default:return Ne(i,":")}},O:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_e(i,":");default:return"GMT"+Ne(i,":")}},z:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_e(i,":");default:return"GMT"+Ne(i,":")}},t:function(e,t,n,r){var i=r._originalDate||e;return me(Math.floor(i.getTime()/1e3),t.length)},T:function(e,t,n,r){return me((r._originalDate||e).getTime(),t.length)}};function _e(e,t){var n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),a=r%60;if(0===a)return n+String(i);var o=t||"";return n+String(i)+o+me(a,2)}function Me(e,t){return e%60==0?(e>0?"-":"+")+me(Math.abs(e)/60,2):Ne(e,t)}function Ne(e,t){var n=t||"",r=e>0?"-":"+",i=Math.abs(e);return r+me(Math.floor(i/60),2)+n+me(i%60,2)}var je=xe;function De(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}}function Le(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}}var Ie={p:Le,P:function(e,t){var n,r=e.match(/(P+)(p+)?/),i=r[1],a=r[2];if(!a)return De(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",De(i,t)).replace("{{time}}",Le(a,t))}},qe=Ie,Re=["D","DD"],Ae=["YY","YYYY"];function Be(e){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr");if("YY"===e)throw new RangeError("Use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr");if("D"===e)throw new RangeError("Use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr");if("DD"===e)throw new RangeError("Use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr")}var $e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Fe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ue=/^'([^]*?)'?$/,ze=/''/g,We=/[a-zA-Z]/;function He(e,t,n){G(2,arguments);var r=String(t),i=n||{},a=i.locale||ie,o=a.options&&a.options.firstWeekContainsDate,s=null==o?1:de(o),c=null==i.firstWeekContainsDate?s:de(i.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=a.options&&a.options.weekStartsOn,u=null==l?0:de(l),d=null==i.weekStartsOn?u:de(i.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!a.localize)throw new RangeError("locale must contain localize property");if(!a.formatLong)throw new RangeError("locale must contain formatLong property");var h=K(e);if(!function(e){G(1,arguments);var t=K(e);return!isNaN(t)}(h))throw new RangeError("Invalid time value");var p=pe(h,V(h)),m={firstWeekContainsDate:c,weekStartsOn:d,locale:a,_originalDate:h};return r.match(Fe).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,qe[t])(e,a.formatLong,m):e})).join("").match($e).map((function(e){if("''"===e)return"'";var t=e[0];if("'"===t)return e.match(Ue)[1].replace(ze,"'");var n,r=je[t];if(r)return i.useAdditionalWeekYearTokens||(n=e,-1===Ae.indexOf(n))||Be(e),!i.useAdditionalDayOfYearTokens&&function(e){return-1!==Re.indexOf(e)}(e)&&Be(e),r(p,e,a.localize,m);if(t.match(We))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return e})).join("")}function Ve(e,t,n){G(2,arguments);var r=K(e),i=K(t),a=n||{},o=a.locale||ie;if(!o.localize)throw new RangeError("locale must contain localize property");if(!o.formatLong)throw new RangeError("locale must contain formatLong property");if(!o.formatRelative)throw new RangeError("locale must contain formatRelative property");var s,c=function(e,t){G(2,arguments);var n=le(e),r=le(t),i=n.getTime()-V(n),a=r.getTime()-V(r);return Math.round((i-a)/ue)}(r,i);if(isNaN(c))throw new RangeError("Invalid time value");s=c<-6?"other":c<-1?"lastWeek":c<0?"yesterday":c<1?"today":c<2?"tomorrow":c<7?"nextWeek":"other";var l=pe(r,V(r)),u=pe(i,V(i));return He(r,o.formatRelative(s,l,u,a),a)}function Ge(e,t){return G(2,arguments),he(e,1e3*de(t))}const Ke=r("Preferences",{web:()=>import("./web-2aeff089.js").then((e=>new e.PreferencesWeb))});var Ye={get:function(e){return Ke.get({key:e}).then((({value:e})=>null!==e?JSON.parse(e):e))},set:function(e,t){return Ke.set({key:e,value:JSON.stringify(t)}).then((()=>t))},remove:e=>Ke.remove({key:e}),async migrate(){await Ke.migrate()}};const Xe=Object.prototype.hasOwnProperty;function Qe(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++)if(!Xe.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function Je(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function Ze(e,t,n){if("string"==typeof t&&(t=t.split(".")),t.length>1){const r=t.shift();null!==e[r]&&"object"==typeof e[r]||(e[r]={}),Ze(e[r],t,n)}else e[t[0]]=n}function et(e,t){return Object.assign({},t.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{}))}function tt(e){return[e.toString(),e.toString()]}function nt(e,t,n=1){const r=[];for(let i=e;i<=t;i+=n)r.push(i.toString());return r}function rt(e,t,n=1){return nt(e,t,n).map(tt)}const it="settings",at=[["Standard","standard"],["Crazyhouse","crazyhouse"],["Chess960","chess960"],["King of the Hill","kingOfTheHill"],["Three-check","threeCheck"],["Antichess","antichess"],["Atomic","atomic"],["Horde","horde"],["Racing Kings","racingKings"]],ot=[["Sudden Death","simple"],["Increment","increment"],["Increment with Handicap","handicapInc"],["Simple Delay","delay"],["Bronstein Delay","bronstein"],["Hourglass","hourglass"],["Stage","stage"]],st=[...Array(11).keys()].map((e=>50*e)),ct={};var lt={general:{locale:ut("lang",null),sound:ut("sound",!0),theme:{availableBackgroundThemes:[{key:"dark",name:"dark",ext:""},{key:"light",name:"light",ext:""},{key:"system",name:"bgThemeSyncWithSystem",ext:""},{key:"bgshapes",name:"Shapes",ext:"jpg"},{key:"anthracite",name:"Anthracite",ext:"jpg"},{key:"blue-maze",name:"Blue Maze",ext:"jpg"},{key:"red-maze",name:"Red Maze",ext:"jpg"},{key:"checkerboard",name:"Checkerboard",ext:"png"},{key:"wood",name:"Wood",ext:"jpg"},{key:"space",name:"Space",ext:"jpg"}],availableBoardThemes:[{key:"blue",name:"Blue",ext:"svg"},{key:"blue2",name:"Blue 2",ext:"jpg"},{key:"blue3",name:"Blue 3",ext:"jpg"},{key:"blue-marble",name:"Blue Marble",ext:"jpg"},{key:"canvas",name:"Canvas",ext:"jpg"},{key:"wood",name:"Wood",ext:"jpg"},{key:"wood2",name:"Wood 2",ext:"jpg"},{key:"wood3",name:"Wood 3",ext:"jpg"},{key:"wood4",name:"Wood 4",ext:"jpg"},{key:"maple",name:"Maple",ext:"jpg"},{key:"maple2",name:"Maple 2",ext:"jpg"},{key:"brown",name:"Brown",ext:"svg"},{key:"leather",name:"Leather",ext:"jpg"},{key:"green",name:"Green",ext:"svg"},{key:"marble",name:"Marble",ext:"jpg"},{key:"green-plastic",name:"Green Plastic",ext:"png"},{key:"grey",name:"Grey",ext:"jpg"},{key:"metal",name:"Metal",ext:"jpg"},{key:"olive",name:"Olive",ext:"jpg"},{key:"newspaper",name:"Newspaper",ext:"png"},{key:"purple",name:"Purple",ext:"svg"},{key:"purple-diag",name:"Purple 2",ext:"png"},{key:"pink",name:"Pink",ext:"png"},{key:"ic",name:"IC",ext:"svg"},{key:"horsey",name:"horsey",ext:"jpg"}],bundledBoardThemes:["brown","blue","green","purple","ic"],availablePieceThemes:[["cburnett","Colin M.L. Burnett"],["merida"],["pirouetti"],["chessnut"],["chess7"],["alpha"],["reilly"],["companion"],["riohacha"],["kosal"],["leipzig"],["fantasy"],["spatial"],["california"],["pixel"],["maestro"],["fresca"],["cardinal"],["gioco"],["tatiana"],["staunty"],["governor"],["symmetric"],["dubrovny"],["icpieces"],["libra"],["shapes"],["letter"],["horsey"],["anarcandy"]],background:ut("bgTheme","system"),board:ut("theme.board","brown"),piece:ut("theme.piece","cburnett")},vibrateOnGameEvents:ut("vibrateOnGameEvents",!1),bluetooth:{useDevice:ut("bluetooth.useDevice",!1),deviceId:ut("bluetooth.deviceId",void 0)},notifications:{enable:ut("notifications",!0),vibrate:ut("notifications.vibrate",!0),sound:ut("notifications.sound",!0)}},game:{supportedVariants:["standard","chess960","antichess","fromPosition","kingOfTheHill","threeCheck","atomic","horde","racingKings","crazyhouse"],animations:ut("gameAnimations",!0),highlights:ut("boardHighlights",!0),pieceDestinations:ut("pieceDestinations",!0),coords:ut("coords",!0),magnified:ut("pieceMagnified",!0),pieceNotation:ut("pieceNotation",!0),zenMode:ut("zenMode",!1),blindfoldChess:ut("blindfoldChess",!1),clockPosition:ut("game.inversedClockPos","right"),pieceMove:ut("game.pieceMove","both"),rookCastle:ut("game.rookCastle",1),moveList:ut("game.moveList",!0),landscapeBoardSide:ut("game.landscapeBoardSide","left")},analyse:{supportedVariants:["standard","chess960","antichess","fromPosition","kingOfTheHill","threeCheck","atomic","horde","racingKings","crazyhouse"],availableVariants:at,syntheticVariant:ut("analyse.syntheticVariant","standard"),enableCeval:ut("analyse.enableCeval",!1),cevalMultiPvs:ut("ceval.multipv",1),cevalCores:ut("ceval.cores",1),cevalHashSize:ut("ceval.hashSize",16),cevalUseNNUE:ut("ceval.useNNUE",!0),cevalInfinite:ut("ceval.infinite",!1),cevalMaxDepth:ut("ceval.maxDepth",18),showBestMove:ut("analyse.showBestMove",!0),showComments:ut("analyse.showComments",!0),smallBoard:ut("analyse.smallBoard",!0),explorer:{db:ut("analyse.explorer.db","lichess"),availableRatings:[1600,1800,2e3,2200,2500],rating:ut("analyse.explorer.rating",[1600,1800,2e3,2200,2500]),availableSpeeds:["bullet","blitz","rapid","classical"],speed:ut("analyse.explorer.speed",["bullet","blitz","rapid","classical"])}},ai:{availableOpponents:[["Stockfish","1"],["Stockfish","2"],["Stockfish","3"],["Stockfish","4"],["Stockfish","5"],["Stockfish","6"],["Stockfish","7"],["Stockfish","8"]],color:ut("ai.color","white"),opponent:ut("ai.opponent","1"),variant:ut("ai.variant","standard"),availableVariants:at},otb:{flipPieces:ut("otb.flipPieces",!1),useSymmetric:ut("otb.useSymmetric",!1),variant:ut("otb.variant","standard"),availableVariants:at,whitePlayer:ut("otb.whitePlayer","White"),blackPlayer:ut("otb.blackPlayer","Black"),clockType:ut("otb.clockType","none"),availableClocks:[["None","none"]].concat(ot)},clock:{availableClocks:ot,clockType:ut("clock.clockType","simple"),simple:{time:ut("clock.simple.time","5")},increment:{time:ut("clock.increment.time","3"),increment:ut("clock.increment.increment","2")},handicapInc:{topTime:ut("clock.handicapInc.topTime","3"),topIncrement:ut("clock.handicapInc.topIncrement","2"),bottomTime:ut("clock.handicapInc.bottomTime","3"),bottomIncrement:ut("clock.handicapInc.bottomIncrement","2")},delay:{time:ut("clock.delay.time","3"),increment:ut("clock.delay.increment","2")},bronstein:{time:ut("clock.bronstein.time","3"),increment:ut("clock.bronstein.increment","2")},hourglass:{time:ut("clock.hourglass.time","5")},stage:{stages:ut("clock.stage.stages",[{time:"120",moves:"40"},{time:"60",moves:null}]),increment:ut("clock.stage.increment","30")},availableTimes:[["0","0"],["½","0.5"],["¾","0.75"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["15","15"],["20","20"],["25","25"],["30","30"],["45","45"],["60","60"],["90","90"],["120","120"],["150","150"],["180","180"]],availableIncrements:["0","1","2","3","4","5","6","7","8","9","10","15","20","25","30","45","60","90","120","150","180"],availableMoves:["5","10","15","20","25","30","35","40","45","50","55","60"]},gameSetup:{availableTimes:[["0","0"],["¼","0.25"],["½","0.5"],["¾","0.75"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["15","15"],["20","20"],["25","25"],["30","30"],["45","45"],["60","60"],["90","90"],["120","120"],["150","150"],["180","180"]],availableIncrements:["0","1","2","3","4","5","6","7","8","9","10","15","20","25","30","45","60","90","120","150","180"],availableDays:["1","2","3","5","7","10","14"],isTimeValid:function(e){return"1"!==e.timeMode()||"0"!==e.time()||"0"!==e.increment()},ai:{color:ut("game.ai.color","random"),availableVariants:[["Standard","1"],["Crazyhouse","10"],["Chess960","2"],["King of the Hill","4"],["Three-check","5"],["Antichess","6"],["Atomic","7"],["Horde","8"],["Racing Kings","9"],["From Position","3"]],variant:ut("game.ai.variant","1"),availableTimeModes:[["unlimited","0"],["realTime","1"]],timeMode:ut("game.ai.clock","1"),time:ut("game.ai.time","10"),increment:ut("game.ai.increment","0"),days:ut("game.ai.days","2"),level:ut("game.ai.aiLevel","3")},human:{availableVariants:[["Standard","1"],["Crazyhouse","10"],["Chess960","2"],["King of the Hill","4"],["Three-check","5"],["Antichess","6"],["Atomic","7"],["Horde","8"],["Racing Kings","9"]],availableRatingRanges:{min:[...st].reverse().map((e=>["-"+e,"-"+e])),max:st.map((e=>["+"+e,"+"+e]))},ratingRangeMin:ut("game.human.rating.range_min","-500"),ratingRangeMax:ut("game.human.rating.range_max","+500"),color:ut("game.human.color","random"),variant:ut("game.human.variant","1"),availableTimeModes:[["realTime","1"],["correspondence","2"],["unlimited","0"]],timeMode:ut("game.human.clock","1"),time:ut("game.human.time","5"),increment:ut("game.human.increment","0"),days:ut("game.human.days","2"),mode:ut("game.human.mode","0"),preset:ut("game.human.preset","quick"),pool:ut("game.human.pool","")},challenge:{availableVariants:[["Standard","1"],["Crazyhouse","10"],["Chess960","2"],["King of the Hill","4"],["Three-check","5"],["Antichess","6"],["Atomic","7"],["Horde","8"],["Racing Kings","9"],["From Position","3"]],color:ut("game.invite.color","random"),variant:ut("game.invite.variant","1"),availableTimeModes:[["realTime","1"],["correspondence","2"],["unlimited","0"]],timeMode:ut("game.invite.clock","1"),time:ut("game.invite.time","5"),increment:ut("game.invite.increment","0"),days:ut("game.invite.days","2"),mode:ut("game.invite.mode","0")}},tournament:{availableVariants:[["Standard","1"],["Crazyhouse","10"],["Chess960","2"],["King of the Hill","4"],["Three-check","5"],["Antichess","6"],["Atomic","7"],["Horde","8"],["Racing Kings","9"]],availableModes:[["Casual","0"],["Rated","1"]],availableTimes:[["0","0"],["½","0.5"],["¾","0.75"],["1","1"],["1.5","1.5"]].concat(rt(2,7,1)).concat(rt(10,25,5)).concat(rt(30,60,10)),availableIncrements:nt(0,7,1).concat(nt(10,25,5)).concat(nt(30,60,10)),availableDurations:nt(20,55,5).concat(nt(60,110,10)).concat(nt(120,360,30)).concat(nt(420,540,60)).concat(["600","720"]),availableTimesToStart:["1","2","3","5","10","15","20","30","45","60"],variant:ut("tournament.variant","1"),mode:ut("tournament.mode","0"),time:ut("tournament.time","5"),increment:ut("tournament.increment","0"),duration:ut("tournament.duration","45"),timeToStart:ut("tournament.timeToStart","15"),position:ut("tournament.timeToStart","15"),private:ut("tournament.private",!1),join:{lastTeam:ut("tournament.join.lastTeam","")}},tv:{channel:ut("tv.channel","best")},importer:{analyse:ut("importer.analyse",!1)},training:{puzzleBufferLen:50,ratingDiffThreshold:100},coordinates:{colorChoice:ut("coordinates.colorChoice","random")},study:{tour:ut("study.tour",null)}};function ut(e,t){return function(n){if(void 0!==n)return Ze(ct,e,n),Ye.set(it,ct).then((()=>{})),n;const r=Je(ct,e);return void 0!==r?r:t}}const dt="en-GB",ht={},pt={day:"2-digit",month:"long",year:"numeric"},mt=Object.assign(Object.assign({},pt),{hour:"2-digit",minute:"2-digit"});let ft,gt=dt,vt={},bt=new Intl.DateTimeFormat(void 0,pt),wt=new Intl.DateTimeFormat(void 0,mt);function yt(e,...t){const n=vt[e]||Rt[e];return n?Ct(n,...t):e}function kt(e,...t){const n=vt[e]||Rt[e];return n?function(e,...t){const n=e.split(/(%(?:\d\$)?s)/g);for(let e=1;e<=t.length;e++){const r=n.indexOf("%"+e+"$s");-1!==r&&(n[r]=t[e-1])}for(let e=0;e<t.length;e++){const r=n.indexOf("%s");if(-1===r)break;n[r]=t[e]}return n}(n,...t):e}function St(e,t,n){const r=e+":"+function(e,t){const n=t%100,r=t%10;switch(_t(e)){case"fr":case"ff":case"kab":return t<2?"one":"other";case"cs":case"sk":return 1===t?"one":t>=2&&t<=4?"few":"other";case"hr":case"ru":case"sr":case"uk":case"be":case"bs":case"sh":return 1===r&&11!==n?"one":r>=2&&r<=4&&!(n>=12&&n<=14)?"few":0===r||r>=5&&r<=9||n>=11&&n<=14?"many":"other";case"lv":return 0===t?"zero":t%10==1&&t%100!=11?"one":"other";case"lt":return 1!==r||n>=11&&n<=19?r>=2&&r<=9&&!(n>=11&&n<=19)?"few":"other":"one";case"pl":return 1===t?"one":r>=2&&r<=4&&!(n>=12&&n<=14)?"few":"other";case"ro":case"mo":return 1===t?"one":0===t||n>=1&&n<=19?"few":"other";case"sl":return 1===n?"one":2===n?"two":n>=3&&n<=4?"few":"other";case"ar":return 0===t?"zero":1===t?"one":2===t?"two":n>=3&&n<=10?"few":n>=11&&n<=99?"many":"other";case"mk":return t%10==1&&11!==t?"one":"other";case"cy":case"br":return 0===t?"zero":1===t?"one":2===t?"two":3===t?"few":6===t?"many":"other";case"mt":return 1===t?"one":0===t||n>=2&&n<=10?"few":n>=11&&n<=19?"many":"other";case"ga":case"se":case"sma":case"smi":case"smj":case"smn":case"sms":return 1===t?"one":2===t?"two":"other";case"ak":case"am":case"bh":case"fil":case"tl":case"guw":case"hi":case"ln":case"mg":case"nso":case"ti":case"wa":return 0===t||1===t?"one":"other";case"az":case"bm":case"fa":case"ig":case"hu":case"ja":case"kde":case"kea":case"ko":case"my":case"ses":case"sg":case"to":case"tr":case"vi":case"wo":case"yo":case"zh":case"bo":case"dz":case"id":case"jv":case"ka":case"km":case"kn":case"ms":case"th":case"tp":case"io":case"ia":return"other";default:return 1===t?"one":"other"}}(gt,t),i=vt[r]||vt[e+":other"]||vt[e];return i?Ct(i,void 0!==n?n:t):e}function Ct(e,...t){let n=e;if(t.length){if(n.includes("$s"))for(let e=1;e<4;e++)n=n.replace("%"+e+"$s",String(t[e-1]));for(const e of t)n=n.replace("%s",String(e))}return n}function Tt(e){return bt.format(e)}function Pt(e){return wt.format(e)}function Et(e){const t=new Date(0);return ce(t,Ge(t,e),{locale:ft})}function Ot(e){return Ve(e,new Date,{locale:ft})}function xt(e,t=!1){return function(e,t){return G(1,arguments),ce(e,Date.now(),t)}(e,{locale:ft,addSuffix:t})}function _t(e){return e.split("-")[0]}function Mt(e){return qt[e]||It.find((t=>_t(t)===e))}function Nt(){return gt}function jt(e){return function(e){const t=Lt[e]?e:dt;return import("./i18n/"+t+".js").then((({default:e})=>(gt=t,vt=Object.assign(Object.assign({},ht),e),bt=new Intl.DateTimeFormat(t,pt),wt=new Intl.DateTimeFormat(t,mt),t)))}(e).then(lt.general.locale).then((()=>function(e){if(e===dt)return Promise.resolve(e);const t=Dt.includes(e)?e:_t(e);return import(`./i18n/date/${t}.js`).then((t=>(ft=t.default||void 0,e))).catch((()=>(ft=void 0,e)))}(e)))}const Dt=["ar-DZ","ar-MA","ar-SA","en-AU","en-CA","en-GB","en-IN","en-US","fa-IR","fr-CA","fr-CH","nl-BE","pt-BR","zh-CN","zh-TW"];const Lt={"af-ZA":"Afrikaans","an-ES":"aragonés","ar-SA":"العربية","as-IN":"অসমীয়া","az-AZ":"Azərbaycanca","be-BY":"Беларуская","bg-BG":"български език","bn-BD":"বাংলা","br-FR":"brezhoneg","bs-BA":"bosanski","ca-ES":"Català, valencià","cs-CZ":"čeština","cv-CU":"чӑваш чӗлхи","cy-GB":"Cymraeg","da-DK":"Dansk","de-CH":"Schwiizerdüütsch","de-DE":"Deutsch","el-GR":"Ελληνικά","en-GB":"English","en-US":"English (US)","eo-UY":"Esperanto","es-ES":"español","et-EE":"eesti keel","eu-ES":"Euskara","fa-IR":"فارسی","fi-FI":"suomen kieli","fo-FO":"føroyskt","fr-FR":"français","frp-IT":"arpitan","fy-NL":"Frysk","ga-IE":"Gaeilge","gd-GB":"Gàidhlig","gl-ES":"Galego","gu-IN":"ગુજરાતી","he-IL":"עִבְרִית","hi-IN":"हिन्दी, हिंदी","hr-HR":"hrvatski","hu-HU":"Magyar","hy-AM":"Հայերեն","ia-IA":"Interlingua","id-ID":"Bahasa Indonesia","io-EN":"Ido","is-IS":"Íslenska","it-IT":"Italiano","ja-JP":"日本語","jbo-EN":"lojban","jv-ID":"basa Jawa","ka-GE":"ქართული","kab-DZ":"Taqvaylit","kk-KZ":"қазақша","kmr-TR":"Kurdî (Kurmancî)","kn-IN":"ಕನ್ನಡ","ko-KR":"한국어","ky-KG":"кыргызча","la-LA":"lingua Latina","lb-LU":"Lëtzebuergesch","lt-LT":"lietuvių kalba","lv-LV":"latviešu valoda","mg-MG":"fiteny malagasy","mk-MK":"македонски јази","ml-IN":"മലയാളം","mn-MN":"монгол","mr-IN":"मराठी","nb-NO":"Norsk bokmål","ne-NP":"नेपाली","nl-NL":"Nederlands","nn-NO":"Norsk nynorsk","pi-IN":"पालि","pl-PL":"polski","ps-AF":"پښتو","pt-PT":"Português","pt-BR":"Português (BR)","ro-RO":"Română","ru-RU":"русский язык","sa-IN":"संस्कृत","sk-SK":"slovenčina","sl-SI":"slovenščina","sq-AL":"Shqip","sr-SP":"Српски језик","sv-SE":"svenska","sw-KE":"Kiswahili","ta-IN":"தமிழ்","tg-TJ":"тоҷикӣ","th-TH":"ไทย","tk-TM":"Türkmençe","tl-PH":"Tagalog","tp-TP":"toki pona","tr-TR":"Türkçe","uk-UA":"українська","ur-PK":"اُردُو","uz-UZ":"oʻzbekcha","vi-VN":"Tiếng Việt","yo-NG":"Yorùbá","zh-CN":"中文","zh-TW":"繁體中文","zu-ZA":"isiZulu"},It=Object.keys(Lt),qt={de:"de-DE",en:"en-US",pt:"pt-PT",zh:"zh-CN"},Rt={apiUnsupported:"Your version of lichess app is too old! Please upgrade for free to the latest version.",apiDeprecated:"Upgrade for free to the latest lichess app! Support for this version will be dropped on %s.",playerisInvitingYou:"%s is inviting you",unsupportedVariant:"Variant %s is not supported in this version",notesSynchronizationHasFailed:"Notes synchronization with lichess has failed, please try later.",localEvalCaution:"Caution: intensive usage will drain battery.",incorrectThreefoldClaim:"Incorrect threefold repetition claim.",useBluetoothDevice:"Use bluetooth device",resetToDefault:"Reset to default",deviceOptions:"Device options",vibrateOnGameEvents:"Vibrate on game events",offline:"Offline"},At=Object.assign({},{apiVersion:5,fetchTimeoutMs:15e3},window.lichess);var Bt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function $t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var Ft=$t((function(e){
/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)
 */
!function(t){function n(e,t,n,r,i){this._listener=t,this._isOnce=n,this.context=r,this._signal=e,this._priority=i||0}function r(e,t){if("function"!=typeof e)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function i(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){i.prototype.dispatch.apply(e,arguments)}}n.prototype={active:!0,params:null,execute:function(e){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},i.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,t,r,i){var a,o=this._indexOfListener(e,r);if(-1!==o){if((a=this._bindings[o]).isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else a=new n(this,e,t,r,i),this._addBinding(a);return this.memorize&&this._prevParams&&a.execute(this._prevParams),a},_addBinding:function(e){var t=this._bindings.length;do{--t}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var n,r=this._bindings.length;r--;)if((n=this._bindings[r])._listener===e&&n.context===t)return r;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,n){return r(e,"add"),this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){return r(e,"addOnce"),this._registerListener(e,!0,t,n)},remove:function(e,t){r(e,"remove");var n=this._indexOfListener(e,t);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t,n=Array.prototype.slice.call(arguments),r=this._bindings.length;if(this.memorize&&(this._prevParams=n),r){t=this._bindings.slice(),this._shouldPropagate=!0;do{r--}while(t[r]&&this._shouldPropagate&&!1!==t[r].execute(n))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var a=i;a.Signal=i,e.exports?e.exports=a:t.signals=a}(Bt)})),Ut={redraw:new Ft.Signal,afterLogin:new Ft.Signal,afterLogout:new Ft.Signal,sessionRestored:new Ft.Signal,homePong:new Ft.Signal,gameBackButton:new Ft.Signal};let zt=new Set,Wt=!1;function Ht(e){zt.add(e),Wt||(Wt=!0,requestAnimationFrame((e=>{const t=zt;Wt=!1,zt=new Set,t.forEach((t=>t(e)))})))}function Vt(e){zt.delete(e)}const Gt=Ut.redraw.dispatch;function Kt(){Ht(Gt)}let Yt;function Xt(){return Yt||Qt()}function Qt(){const e=window.crypto.getRandomValues(new Uint8Array(9));return Yt=btoa(String.fromCharCode(...e)).replace(/[/+]/g,"_"),Yt}function Jt(e){return new Promise(((t,n)=>{const r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",e,!0),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||200===r.status?t(JSON.parse(r.responseText)):n(r))},r.send(null)}))}function Zt(e){return new Promise(((t,n)=>{if(function(e){const t=document.head.getElementsByTagName("script");for(let n=0,r=t.length;n<r;n++)if(t[n].getAttribute("src")===e)return!0;return!1}(e))setTimeout(t,0);else{const r=document.createElement("script");r.src=e,r.onload=()=>t(),r.onerror=()=>n(),document.head.appendChild(r)}}))}function en(e){return new Promise(((t,n)=>{if(function(e){const t=document.head.getElementsByTagName("link");for(let n=0,r=t.length;n<r;n++)if(t[n].getAttribute("href")===e)return!0;return!1}(e))setTimeout(t,0);else{const r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=()=>t(),r.onerror=()=>n(),document.head.appendChild(r)}}))}function tn(e){const t=e();return Kt(),t}function nn(){return!1}function rn(e){const t=e.status,n=e.body;let r;r=t&&0!==t?401===t?"You are not authorized to do that.":404===t?"Resource not found.":503===t?"lichess.org is temporarily down for maintenance.":t>=500?"Server error.":"Something went wrong.":"lichess.org is unreachable.",n&&("string"==typeof n?r+=` ${n}`:"string"==typeof n.error?r+=` ${n.error}`:n.global&&n.global.constructor===Array&&(r+=` ${yt(n.global[0])}`)),z.show({text:r,duration:"short"})}function an(e){let t="";return Object.keys(e).forEach((n=>{const r=e[n];null!=r&&(""!==t&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(r))})),t}function on(){}const sn={bullet:"T",blitz:")",rapid:"#",classical:"+",correspondence:";",chess960:"'",kingOfTheHill:"(",threeCheck:".",antichess:"@",atomic:">",puzzle:"-",horde:"_",fromPosition:"*",racingKings:"",crazyhouse:"",ultraBullet:"{",computer:"n",bot:"n"};function cn(e){return e&&sn[e]||"8"}function ln(e){return 0===e?e:e/60}function un(e){return"white"===e?"black":"white"}function dn(e){return e.charAt(0).toUpperCase()+e.slice(1)}function hn(e,t){return Math.random()*(t-e)+e}function pn(e,t){return"racingKings"===e.game.variant.key?t?"black":"white":t?e.opponent.color:e.player.color}function mn(e,t){let n=e+"";for(;n.length<t;)n="0"+n;return n}function fn(e,t="hour_min_secs"){let n="";const r=Math.floor(e/60/60),i=Math.floor(e/60)-60*r,a=e%60;return n="hour_min_secs"===t?r>0?r+":"+mn(i,2)+":"+mn(a,2):i+":"+mn(a,2):mn(a,2),n}function gn(e){const t=Math.floor(e/60),n=Math.floor(e-60*t);return(t?t+"H ":"")+(n?n+"M":"")}function vn(e){if(e){const t=ln(e.limit);return(.25===t?"¼":.5===t?"½":.75===t?"¾":t.toString())+"+"+e.increment}return"∞"}function bn(e){return null!=e}function wn(e){return`${At.apiEndPoint}/assets/${e}`}function yn(e){const t=Number(e);return isNaN(t)?void 0:t}function kn(e){if(!(void 0===e||e.length>7||0===e.length||/[^a-zA-Z0-9]/.exec(e)))return e.split("").reduce(((e,t,n)=>e+function(e){const t=e.charCodeAt(0);return t>96?t-71:t>64?t-65:t+4}(t)*Math.pow(62,n)),0)}const Sn=window.requestIdleCallback||window.setTimeout;function Cn(e){let t=e;return e=>(void 0!==e&&(t=e),t)}function Tn(e){return e?250:0}function Pn(){return Math.random()>.5?"white":"black"}function En(e,t){return"1"===e&&-1!==["5","6","7","8","9"].indexOf(t)?[["randomColor","random"]]:[["randomColor","random"],["white","white"],["black","black"]]}function On(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return m(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),U(e,t,{leading:r,maxWait:t,trailing:i})}function xn(e){try{return window.localStorage?e(window.localStorage):null}catch(e){}}var _n={get:function(e){return xn((t=>{const n=t.getItem(e);return n?JSON.parse(n):null}))},set:function(e,t){xn((n=>{try{n.setItem(e,JSON.stringify(t))}catch(r){n.removeItem(e),n.setItem(e,JSON.stringify(t))}}))},remove:function(e){xn((t=>{t.removeItem(e)}))}};function Mn(e,t,n,r,i,a){return{tag:e,key:t,attrs:n,children:r,text:i,dom:a,domSize:void 0,state:void 0,events:void 0,instance:void 0}}Mn.normalize=function(e){return Array.isArray(e)?Mn("[",void 0,void 0,Mn.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:Mn("#",void 0,void 0,String(e),void 0,void 0)},Mn.normalizeChildren=function(e){var t=[];if(window.lichess&&"dev"===window.lichess.mode&&e.length)for(var n=null!=e[0]&&null!=e[0].key,r=1;r<e.length;r++)if((null!=e[r]&&null!=e[r].key)!==n)throw new TypeError(!n||null==e[r]&&"boolean"!=typeof e[r]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(r=0;r<e.length;r++)t[r]=Mn.normalize(e[r]);return t};var Nn=Mn,jn=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return Nn("",t.key,t,e)},Dn={}.hasOwnProperty,Ln=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,In={};function qn(e){for(var t in e)if(Dn.call(e,t))return!1;return!0}var Rn=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=jn.apply(1,arguments);return"string"==typeof e&&(t.children=Nn.normalizeChildren(t.children),"["!==e)?function(e,t){var n=t.attrs,r=Nn.normalizeChildren(t.children),i=Dn.call(n,"class"),a=i?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!qn(e.attrs)&&!qn(n)){var o={};for(var s in n)Dn.call(n,s)&&(o[s]=n[s]);n=o}for(var s in e.attrs)Dn.call(e.attrs,s)&&"className"!==s&&!Dn.call(n,s)&&(n[s]=e.attrs[s]);for(var s in null==a&&null==e.attrs.className||(n.className=null!=a?null!=e.attrs.className?String(e.attrs.className)+" "+String(a):a:null!=e.attrs.className?e.attrs.className:null),i&&(n.class=null),n)if(Dn.call(n,s)&&"key"!==s){t.attrs=n;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?t.text=r[0].children:t.children=r,t}(In[e]||function(e){for(var t,n="div",r=[],i={};t=Ln.exec(e);){var a=t[1],o=t[2];if(""===a&&""!==o)n=o;else if("#"===a)i.id=o;else if("."===a)r.push(o);else if("["===t[3][0]){var s=t[6];s&&(s=s.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?r.push(s):i[t[4]]=""===s?s:s||!0}}return r.length>0&&(i.className=r.join(" ")),In[e]={tag:n,attrs:i}}(e),t):(t.tag=e,t)};Rn.trust=function(e){return null==e&&(e=""),Nn("<",void 0,void 0,e,void 0,void 0)},Rn.fragment=function(){var e=jn.apply(0,arguments);return e.tag="[",e.children=Nn.normalizeChildren(e.children),e};var An=Rn;let Bn;var $n={spin(){if(void 0!==Bn||document.getElementById("globalSpinner"))return;const e=document.createElement("div");e.id="globalSpinner",e.className="spinner globalSpinner";const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 40 40");const n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttribute("cx","20"),n.setAttribute("cy","20"),n.setAttribute("r","18"),n.setAttribute("fill","none"),t.appendChild(n),e.appendChild(t),Bn=setTimeout((()=>{document.body.appendChild(e)}),200)},stop(){clearTimeout(Bn),Bn=void 0;const e=document.getElementsByClassName("globalSpinner");e.length&&setTimeout((function(){for(;e[0];)document.body.removeChild(e[0])}),500)},getVdom:e=>An("div.spinner",{className:e||""},[An("svg",{viewBox:"0 0 40 40"},[An("circle",{cx:"20",cy:"20",r:"18",fill:"none"})])]),getHtml:()=>'<div class="spinner monochrome"><svg viewBox="0 0 40 40"><circle cx=20 cy=20 r=18 fill="none"></circle></svg></div>'};function Fn(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e.toString():"";default:return""}}function Un(e,t,n,r){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((r=>{const i=encodeURIComponent(Fn(r))+n;return Array.isArray(e[r])?e[r].map((e=>i+encodeURIComponent(Fn(e)))).join(t):i+encodeURIComponent(Fn(e[r]))})).join(t):r?encodeURIComponent(Fn(r))+n+encodeURIComponent(Fn(e)):""}var zn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Wn="sessionId",Hn=At.apiEndPoint;function Vn(e,t,n,r=!1){let i;function a(){clearTimeout(i),r&&$n.stop()}const o=new Headers({"X-Requested-With":"XMLHttpRequest",Accept:"application/vnd.lichess.v"+At.apiVersion+"+json"}),s=_n.get(Wn);null!=s&&o.append(Wn,s);const c={method:"GET",credentials:"include"};let l;if(void 0!==n){const{headers:t,query:r,timeout:i}=n,a=zn(n,["headers","query","timeout"]);if(l=i,r){const t=Un(r);""!==t&&(e=function(e,t){const n=e.indexOf("?")<0?"?":"&";return e+n+t}(e,t))}Object.assign(c,a),t&&Object.keys(t).forEach((e=>{const n=t[e];"__delete"!==n?o.set(e,n):o.delete(e)}))}"POST"!==c.method&&"PUT"!==c.method||o.has("Content-Type")||(o.set("Content-Type","application/json; charset=UTF-8"),c.body||(c.body="{}"));const u=e.indexOf("http")>-1?e:Hn+e,d=new Promise(((e,t)=>{i=setTimeout((()=>t(new Error("Request timeout."))),l||At.fetchTimeoutMs)})),h=Promise.race([fetch(u,Object.assign(Object.assign({},c),{headers:o})),d]);return r&&$n.spin(),new Promise(((e,n)=>{h.then((r=>{a(),r.ok?e(r[t]()):r.text().then((e=>{try{n({status:r.status,body:JSON.parse(e)})}catch(e){n({status:r.status,body:r.statusText})}}))})).catch((e=>{a(),n({status:0,body:e.message})}))}))}function Gn(e,t,n=!1){return Vn(e,"json",t,n)}function Kn(e,t,n=!1){return Vn(e,"text",t,n)}var Yn={isStub:!0,init(){},register:async()=>Promise.resolve(),unregister:()=>Promise.resolve("")};const Xn=new Map;var Qn={list:()=>[...Xn.values()].sort(((e,t)=>{return r=t,(n=e).name.toLowerCase()<r.name.toLowerCase()?-1:n.name.toLowerCase()>r.name.toLowerCase()?1:0;var n,r})),count:()=>Xn.size,reset(e,t,n){Xn.clear(),e.forEach((e=>{const[r,i]=Jn(e),a=r.toLowerCase(),o=t.includes(a),s=n.includes(a);Xn.set(e,{name:r,title:i,playing:o,patron:s})}))},set(e,t,n){const[r,i]=Jn(e);Xn.set(e,{name:r,title:i,playing:t,patron:n})},playing(e){const t=Xn.get(e);t&&Xn.set(e,Object.assign(Object.assign({},t),{playing:!0}))},stoppedPlaying(e){const t=Xn.get(e);t&&Xn.set(e,Object.assign(Object.assign({},t),{playing:!1}))},remove(e){Xn.delete(e)},clear(){Xn.clear()}};function Jn(e){const t=e.split(" ");return[t.length>1?t[1]:t[0],t.length>1?t[0]:void 0]}const Zn=r("SoundEffect",{web:()=>import("./web-457b8b65.js").then((e=>new e.SoundEffectWeb))});let er=!0;function tr(){return er}let nr=void 0!==window.AudioContext?new AudioContext:null;var rr={load:()=>Promise.all([ar("move"),ar("capture"),ar("explosion"),ar("lowtime"),ar("dong"),ar("berserk"),ar("clock"),ar("confirmation")]).then((()=>{})),resume(){null!=nr&&(nr.close(),nr=new AudioContext)},move(){or("move")},throttledMove:On((()=>{or("move")}),50),capture(){or("capture")},throttledCapture:On((()=>{or("capture")}),50),explosion(){or("explosion")},throttledExplosion:On((()=>{or("explosion")}),50),lowtime(){or("lowtime")},dong(){or("dong")},berserk(){or("berserk")},clock(){or("clock")},confirmation(){or("confirmation")}};const ir={};async function ar(e){const t=`sounds/${e}.mp3`;"ios"===n.getPlatform()&&null!=nr?window.fetch(t).then((e=>e.arrayBuffer())).then((e=>nr.decodeAudioData(e))).then((t=>ir[e]=t)):Zn.loadSound({id:e,path:t})}function or(e){if(lt.general.sound()&&tr())if("ios"===n.getPlatform()&&null!=nr){const t=nr.createBufferSource();t.buffer=ir[e],t.connect(nr.destination),t.start()}else Zn.play({id:e})}const sr=r("Dialog",{web:()=>import("./web-b0dc2976.js").then((e=>new e.DialogWeb))});function cr(e){return{mode:Number(e.mode()),variant:Number(e.variant()),timeMode:Number(e.timeMode()),time:Number(e.time()),increment:Number(e.increment()),days:Number(e.days()),color:e.color(),ratingRangeMin:Number(e.ratingRangeMin()),ratingRangeMax:Number(e.ratingRangeMax())}}function lr(e,t){const{ratingRangeMin:n,ratingRangeMax:r}=t;let i="correspondence";switch(t.variant){case 1:case 3:if(1===t.timeMode){const e=60*t.time+40*t.increment;i=e<30?"ultraBullet":e<180?"bullet":e<480?"blitz":e<1500?"rapid":"classical"}break;case 2:i="chess960";break;case 4:i="kingOfTheHill";break;case 5:i="threeCheck";break;case 6:i="antichess";break;case 7:i="atomic";break;case 8:i="horde";break;case 9:i="racingKings";break;case 10:i="crazyhouse"}const a=e.perfs[i];return a&&void 0!==n&&void 0!==r?`${a.rating+n}-${a.rating+r}`:null}var ur=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function dr(e){const t=lt.gameSetup.ai,n={variant:t.variant(),timeMode:t.timeMode(),days:t.days(),time:t.time(),increment:t.increment(),level:t.level(),color:t.color()};return e&&(n.fen=e),Gn("/setup/ai",{method:"POST",body:JSON.stringify(n)},!0)}function hr(e){const t=ur(e,["ratingRangeMin","ratingRangeMax"]),n=Yr.get(),r=n?lr(n,e):null,i=r?Object.assign(Object.assign({},t),{ratingRange:r}):Object.assign({},t);return Gn("/setup/hook/"+Xt(),{method:"POST",body:JSON.stringify(i)},!0)}function pr(){return Gn("/challenge")}function mr(e){return Gn(`/challenge/${e}`,{},!0)}function fr(e){return Kn(`/challenge/${e}/cancel`,{method:"POST"},!0)}function gr(e){return Kn(`/challenge/${e}/decline`,{method:"POST"},!0)}function vr(e){return Gn(`/challenge/${e}/accept`,{method:"POST"},!0)}let br=[];function wr(e){return Gn("/",void 0,e).then((e=>(void 0!==e.lobby.pools&&(br=e.lobby.pools),e)))}function yr(e){return Gn("/lobby/seeks",{query:{_:Date.now()}},e)}function kr(e,t){let n="/"+e;return t&&(n+="/"+t),Gn(n)}function Sr(e){return Kn("/bookmark/"+e,{method:"POST"})}function Cr(e,t){return Gn("/tv/"+e,t?{query:{flip:1}}:{})}function Tr(e,t){return Gn(`/import/master/${e}/${t}`)}function Pr(e){return Yr.isConnected()?Gn("/translation/select",{method:"POST",body:JSON.stringify({lang:e})}).then((()=>{})):Promise.resolve()}function Er(e){return Gn(`/@/${e}/mini`)}function Or(){return Gn("/timeline",{query:{nb:10}},!1)}let xr=[],_r=[];function Mr(e){return-1!==lt.game.supportedVariants.indexOf(e.variant.key)&&"created"===e.status}function Nr(e){e.in.length>xr.length&&rr.dong(),xr=e.in,_r=e.out}var jr={all:()=>xr.filter(Mr).concat(_r.filter(Mr)),incoming:()=>xr.filter(Mr),sending:()=>_r.filter(Mr),set:Nr,refresh:()=>On(pr,1e3)().then(Nr),remove(e){xr=xr.filter((t=>t.id!==e)),_r=_r.filter((t=>t.id!==e))},isPersistent:e=>"correspondence"===e.timeControl.type||"unlimited"===e.timeControl.type,challengeTime:e=>function(e){return"clock"===e.type}(e.timeControl)?e.timeControl.show:function(e){return"correspondence"===e.type}(e.timeControl)?St("nbDays",e.timeControl.daysPerTurn):"∞"};const Dr="announce";let Lr;function Ir(e){return e.date}function qr(e){return new Date(e)<new Date}var Rr={get:function(){return Lr&&qr(Lr.date)&&(Lr=void 0),Lr},set:async function(e){if(e){const t=Ir(e),n=await Ye.get(Dr);if(null==n?void 0:n.includes(t))return}Lr=e,Kt()},dismiss:async function(){if(void 0===Lr)return;const e=Ir(Lr);Lr=void 0,Kt();const t=(await Ye.get(Dr)||[]).filter((e=>!qr(e)));t.push(e),await Ye.set(Dr,t)}};let Ar;function Br(e){Ye.set("session",e)}function $r(){Ye.remove("session"),_n.remove(Wn),Ut.afterLogout.dispatch()}function Fr(){return(Ar&&Ar.nowPlaying||[]).filter((e=>-1!==lt.game.supportedVariants.indexOf(e.variant.key)))}function Ur(e){return z.show({text:"✓ lichess.org: "+yt("yourPreferencesHaveBeenSaved"),position:"center",duration:"short"}),e}function zr(e){return!0===e?"1":!1===e?"0":String(e)}function Wr(e){return function(t,[n,r]){return Object.assign(Object.assign({},t),{[e+n]:zr(r)})}}const Hr=On((()=>{const e=Ar&&Ar.prefs||{},t=Object.entries(et(e,["animation","captured","highlight","destination","coords","replay","blindfold"])).reduce(Wr("display."),{}),n=Object.entries(et(e,["premove","takeback","autoQueen","autoThreefold","submitMove","confirmResign","moretime"])).reduce(Wr("behavior."),{}),r=Object.entries(et(e,["clockTenths","clockBar","clockSound","follow","challenge","message","insightShare"])).reduce(Wr(""),{});return Kn("/account/preferences",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json, text/*"},body:an(Object.assign(Object.assign(Object.assign({},r),t),n))},!0).then(Ur)}),1e3);function Vr(e){return void 0!==e.id}async function Gr(){try{const e=await Gn("/account/info",{cache:"reload"});Ar=e,Br(e),Rr.set(e.announce),Ar.nbChallenges!==jr.incoming().length&&jr.refresh().then(Kt),Kt()}catch(e){void 0!==Ar&&401===e.status&&(Ar=void 0,$r(),Kt(),z.show({text:"You have been signed out",position:"center",duration:"short"}))}}function Kr(){c.getId().then((({identifier:e})=>{"web"!==e&&Kn(`/auth/set-fp/${e}/0`,{method:"POST"})}))}var Yr={isConnected:function(){return void 0!==Ar},isKidMode:function(){return!(!Ar||!Ar.kid)},isShadowban:function(){return!(!Ar||!Ar.troll)},logout:function(){return Yn.unregister().then((()=>Gn("/logout",{method:"POST"},!0).then((()=>{Ar=void 0,$r(),Qn.clear(),Kt()})))).catch(rn)},signup:function(e,t,n){return Gn("/signup",{method:"POST",body:JSON.stringify({username:e,email:t,password:n,"can-confirm":!0})},!0).then((e=>(Vr(e)&&(Ar=e,Ar.sessionId&&_n.set(Wn,Ar.sessionId),Kr()),e)))},login:On((function(e,t,n){return Gn("/login",{method:"POST",body:JSON.stringify({username:e,password:t,token:n})},!0).then((e=>{if(Vr(e))return Ar=e,Ar.sessionId&&_n.set(Wn,Ar.sessionId),Br(e),Kr(),Ar;throw{ipban:!0}}))}),1e3),rememberLogin:On((function(){return Gn("/account/info").then((e=>(Ar=e,Br(e),e)))}),1e3),restoreStoredSession:function(){Ye.get("session").then((e=>{Ar=e||void 0,null!==e&&(Ut.sessionRestored.dispatch(),Kt())}))},refresh:On(Gr,1e3),backgroundRefresh:On((async function(){}),1e3),get:function(){return Ar},getUserId:function(){return Ar&&Ar.id},appUser:e=>Ar?Ar&&Ar.username:e,nowPlaying:Fr,myTurnGames:function(){return Fr().filter((e=>e.isMyTurn))},lichessBackedProp:function(e,t){return function(...n){if(n.length){let t;Ar&&(t=Je(Ar,e),Ze(Ar,e,n[0])),Hr().catch((n=>{Ar&&Ze(Ar,e,t)}))}return Ar?Je(Ar,e):t}},setKidMode:function(e,t){return Kn(`/account/kid?v=${e}`,{method:"POST",body:new URLSearchParams(t),headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json, text/*"}},!0).then(Gr)},confirmEmail:function(e){return Gn(`/signup/confirm/${e}`,void 0,!0).then((e=>(Ar=e,Br(e),Ar)))},hasCurrentBan:()=>void 0!==(null==Ar?void 0:Ar.playban)};const Xr="transition",Qr="transitionend";function Jr(e,t,n,r,i){var a=arguments,o=arguments.length;return 0===o||2===o||o>5?Promise.reject(new Error("Zanimo invalid arguments")):e instanceof Promise?e.then((function(e){return Jr.apply(this,[e].concat(Array.prototype.slice.call(a,1)))})):function(e){try{return e&&e.nodeType}catch(e){return!1}}(e)?1===o?Promise(e):3===o?function(e,t,n){e._zanimo&&Object.prototype.hasOwnProperty.call(e._zanimo,t);return function(e,t,n){return requestAnimationFrame((function(){e.style[t]=n})),Promise(e)}(e,t,n)}(e,t,n):window.isNaN(parseInt(r,10))?Promise.reject(new Error("Zanimo transition: duration must be an integer!")):function(e,t,n,r,i){var a,o=t,s=new Promise((function(s,c){function l(t){t.propertyName===o&&(u(!0),s(e))}function u(n){a&&(clearTimeout(a),a=null),function(e,t){e.style[Xr]=e.style[Xr].split(",").filter((function(e){return!e.match(t)})).join(",")}(e,t),e.removeEventListener(Qr,l),n&&delete e._zanimo[t]}e.addEventListener(Qr,l),requestAnimationFrame((function(){!function(e,t,n,r,i){var a=e.style[Xr];e.style[Xr]=a?a+", "+Zr(t,r,i):Zr(t,r,i);e.style[t]=n}(e,t,n,r,i),a=setTimeout((function(){u(!0),s(e)}),r+20),e._zanimo=e._zanimo||{},e._zanimo[t],e._zanimo[t]={value:n}}))}));return s}(e,t,n,r,i):Promise.reject(new Error("Zanimo require an HTMLElement, or a promise of an HTMLElement"))}function Zr(e,t,n){return e+" "+t+"ms "+(n||"linear")}var ei=$t((function(e){!function(t,n){var r=t.define;r&&r.amd?r("rlite",[],n):e.exports?e.exports=n():t.Rlite=n()}(Bt,(function(){return function(){var e={},t=decodeURIComponent;function n(e){return e}function r(r){var i=function(e){return~e.indexOf("/?")&&(e=e.replace("/?","?")),"/"==e[0]&&(e=e.slice(1)),"/"==e[e.length-1]&&(e=e.slice(0,-1)),e}(r).split("?"),a=~r.indexOf("%")?t:n;return function(e,t,n){if(e&&t.cb)for(var r=e.indexOf("#"),i=(r<0?e:e.slice(0,r)).split("&"),a=0;a<i.length;++a){var o=i[a].split("=");t.params[o[0]]=n(o[1])}return t}(i[1],function(t,n){for(var r=t.split("/"),i=e,a={},o=0;o<r.length&&i;++o){var s=n(r[o]);(i=i[s.toLowerCase()]||i[":"])&&i["~"]&&(a[i["~"]]=s)}return i&&{cb:i["@"],params:a}}(i[0],a)||{},a)}return{add:function(t,n){for(var r=t.split("/"),i=e,a=0;a<r.length;++a){var o=r[a],s=":"==o[0]?":":o.toLowerCase();i=i[s]||(i[s]={}),":"==s&&(i["~"]=o.slice(1))}i["@"]=n},exists:function(e){return!!r(e).cb},lookup:r,run:function(e){var t=r(e);return t.cb&&t.cb({url:e,params:t.params}),!!t.cb}}}}))})),ti=function(e){var t,n=e&&e.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function i(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function a(e,t){if(e.state!==t)throw new Error("'vnode.state' must not be modified.")}function o(e){var t=e.state;try{return this.apply(t,arguments)}finally{a(e,t)}}function s(){try{return n.activeElement}catch(e){return null}}function c(e,t,n,r,i,a,o){for(var s=n;s<r;s++){var c=t[s];null!=c&&l(e,c,i,o,a)}}function l(e,t,r,i,a){var o=t.tag;if("string"==typeof o)switch(t.state={},null!=t.attrs&&F(t.attrs,t,r),o){case"#":!function(e,t,r){t.dom=n.createTextNode(t.children),C(e,t.dom,r)}(e,t,a);break;case"<":d(e,t,i,a);break;case"[":!function(e,t,r,i,a){var o=n.createDocumentFragment();if(null!=t.children){var s=t.children;c(o,s,0,s.length,r,null,i)}t.dom=o.firstChild,t.domSize=o.childNodes.length,C(e,o,a)}(e,t,r,i,a);break;default:h(e,t,r,i,a)}else!function(e,t,n,r,i){p(t,n),null!=t.instance?(l(e,t.instance,n,r,i),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,r,i,a)}var u={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,r,i){var a=t.children.match(/^\s*?<(\w+)/im)||[],o=n.createElement(u[a[1]]||"div");"http://www.w3.org/2000/svg"===r?(o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",o=o.firstChild):o.innerHTML=t.children,t.dom=o.firstChild,t.domSize=o.childNodes.length,t.instance=[];for(var s,c=n.createDocumentFragment();s=o.firstChild;)t.instance.push(s),c.appendChild(s);C(e,c,i)}function h(e,t,r,a,o){var s=t.tag,l=t.attrs,u=l&&l.is,d=(a=i(t)||a)?u?n.createElementNS(a,s,{is:u}):n.createElementNS(a,s):u?n.createElement(s,{is:u}):n.createElement(s);if(t.dom=d,null!=l&&function(e,t,n){for(var r in t)M(e,r,null,t[r],n)}(t,l,a),C(e,d,o),!T(t)&&(null!=t.text&&(""!==t.text?d.textContent=t.text:t.children=[Nn("#",void 0,void 0,t.text,void 0,void 0)]),null!=t.children)){var h=t.children;c(d,h,0,h.length,r,null,a),"select"===t.tag&&null!=l&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&M(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,l)}}function p(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}if(F(e.state,e,t),null!=e.attrs&&F(e.attrs,e,t),e.instance=Nn.normalize(o.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null}function m(e,t,n,r,i,a){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,r,i,a);else if(null==n||0===n.length)P(e,t,0,t.length);else{var o=null!=t[0]&&null!=t[0].key,s=null!=n[0]&&null!=n[0].key,u=0,d=0;if(!o)for(;d<t.length&&null==t[d];)d++;if(!s)for(;u<n.length&&null==n[u];)u++;if(null===s&&null==o)return;if(o!==s)P(e,t,d,t.length),c(e,n,u,n.length,r,i,a);else if(s){for(var h,p,m,g,v,S=t.length-1,C=n.length-1;S>=d&&C>=u&&(m=t[S],g=n[C],m.key===g.key);)m!==g&&f(e,m,g,r,i,a),null!=g.dom&&(i=g.dom),S--,C--;for(;S>=d&&C>=u&&(h=t[d],p=n[u],h.key===p.key);)d++,u++,h!==p&&f(e,h,p,r,y(t,d,i),a);for(;S>=d&&C>=u&&u!==C&&h.key===g.key&&m.key===p.key;)k(e,m,v=y(t,d,i)),m!==p&&f(e,m,p,r,v,a),++u<=--C&&k(e,h,i),h!==g&&f(e,h,g,r,i,a),null!=g.dom&&(i=g.dom),d++,m=t[--S],g=n[C],h=t[d],p=n[u];for(;S>=d&&C>=u&&m.key===g.key;)m!==g&&f(e,m,g,r,i,a),null!=g.dom&&(i=g.dom),C--,m=t[--S],g=n[C];if(u>C)P(e,t,d,S+1);else if(d>S)c(e,n,u,C+1,r,i,a);else{var T,O,x=i,_=C-u+1,M=new Array(_),N=0,j=0,D=2147483647,L=0;for(j=0;j<_;j++)M[j]=-1;for(j=C;j>=u;j--){null==T&&(T=b(t,d,S+1));var I=T[(g=n[j]).key];null!=I&&(D=I<D?I:-1,M[j-u]=I,m=t[I],t[I]=null,m!==g&&f(e,m,g,r,i,a),null!=g.dom&&(i=g.dom),L++)}if(i=x,L!==S-d+1&&P(e,t,d,S+1),0===L)c(e,n,u,C+1,r,i,a);else if(-1===D)for(O=function(e){var t=[0],n=0,r=0,i=0,a=w.length=e.length;for(i=0;i<a;i++)w[i]=e[i];for(i=0;i<a;++i)if(-1!==e[i]){var o=t[t.length-1];if(e[o]<e[i])w[i]=o,t.push(i);else{for(n=0,r=t.length-1;n<r;){var s=(n>>>1)+(r>>>1)+(n&r&1);e[t[s]]<e[i]?n=s+1:r=s}e[i]<e[t[n]]&&(n>0&&(w[i]=t[n-1]),t[n]=i)}}n=t.length,r=t[n-1];for(;n-- >0;)t[n]=r,r=w[r];return w.length=0,t}(M),N=O.length-1,j=C;j>=u;j--)p=n[j],-1===M[j-u]?l(e,p,r,a,i):O[N]===j-u?N--:k(e,p,i),null!=p.dom&&(i=n[j].dom);else for(j=C;j>=u;j--)p=n[j],-1===M[j-u]&&l(e,p,r,a,i),null!=p.dom&&(i=n[j].dom)}}else{var q=t.length<n.length?t.length:n.length;for(u=u<d?u:d;u<q;u++)(h=t[u])===(p=n[u])||null==h&&null==p||(null==h?l(e,p,r,a,y(t,u+1,i)):null==p?E(e,h):f(e,h,p,r,y(t,u+1,i),a));t.length>q&&P(e,t,u,t.length),n.length>q&&c(e,n,u,n.length,r,i,a)}}}function f(e,t,n,r,i,a){var s=t.tag;if(s===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=o.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=o.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(n,t))return;if("string"==typeof s)switch(null!=n.attrs&&U(n.attrs,n,r),s){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,r,i){t.children!==n.children?(O(e,t),d(e,n,r,i)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(e,t,n,a,i);break;case"[":!function(e,t,n,r,i,a){m(e,t.children,n.children,r,i,a);var o=0,s=n.children;if(n.dom=null,null!=s){for(var c=0;c<s.length;c++){var l=s[c];null!=l&&null!=l.dom&&(null==n.dom&&(n.dom=l.dom),o+=l.domSize||1)}1!==o&&(n.domSize=o)}}(e,t,n,r,i,a);break;default:g(t,n,r,a)}else v(e,t,n,r,i,a)}else E(e,t),l(e,n,r,a,i)}function g(e,t,n,r){var a=t.dom=e.dom;r=i(t)||r,"textarea"===t.tag&&(null==t.attrs&&(t.attrs={}),null!=t.text&&(t.attrs.value=t.text,t.text=void 0)),function(e,t,n,r){if(null!=n)for(var i in n)M(e,i,t&&t[i],n[i],r);var a;if(null!=t)for(var i in t)null==(a=t[i])||null!=n&&null!=n[i]||N(e,i,a,r)}(t,e.attrs,t.attrs,r),T(t)||(null!=e.text&&null!=t.text&&""!==t.text?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(null!=e.text&&(e.children=[Nn("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=t.text&&(t.children=[Nn("#",void 0,void 0,t.text,void 0,void 0)]),m(a,e.children,t.children,n,null,r)))}function v(e,t,n,r,i,a){if(n.instance=Nn.normalize(o.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");U(n.state,n,r),null!=n.attrs&&U(n.attrs,n,r),null!=n.instance?(null==t.instance?l(e,n.instance,r,a,i):f(e,t.instance,n.instance,r,i,a),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(E(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}function b(e,t,n){for(var r=Object.create(null);t<n;t++){var i=e[t];if(null!=i){var a=i.key;null!=a&&(r[a]=t)}}return r}var w=[];function y(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function k(e,t,r){var i=n.createDocumentFragment();S(e,i,t),C(e,i,r)}function S(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var r=0;r<n.instance.length;r++)t.appendChild(n.instance[r]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(r=0;r<n.children.length;r++){var i=n.children[r];null!=i&&S(e,t,i)}break}}function C(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function T(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted.");return!0}function P(e,t,n,r){for(var i=n;i<r;i++){var a=t[i];null!=a&&E(e,a)}}function E(e,t){var n,r,i,s=0,c=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(i=o.call(t.state.onbeforeremove,t))&&"function"==typeof i.then&&(s=1,n=i));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(i=o.call(t.attrs.onbeforeremove,t))&&"function"==typeof i.then&&(s|=2,r=i));if(a(t,c),s){if(null!=n){var l=function(){1&s&&((s&=2)||u())};n.then(l,l)}if(null!=r){l=function(){2&s&&((s&=1)||u())};r.then(l,l)}}else _(t),x(e,t);function u(){a(t,c),_(t),x(e,t)}}function O(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function x(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)O(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var r=t.children[n];null!=r&&x(e,r)}}break}}function _(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&o.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&o.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&_(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];null!=r&&_(r)}}}function M(e,t,r,i,a){if("key"!==t&&"is"!==t&&null!=i&&!j(t)&&(r!==i||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===s()||"option"===e.tag&&e.dom.parentNode===n.activeElement}(e,t)||"object"==typeof i)){if("o"===t[0]&&"n"===t[1])return $(e,t,i);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),i);else if("style"===t)A(e.dom,r,i);else if(D(e,t,a)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+i&&e.dom===s())return;if("select"===e.tag&&null!==r&&e.dom.value===""+i)return;if("option"===e.tag&&null!==r&&e.dom.value===""+i)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,i):e.dom[t]=i}else"boolean"==typeof i?i?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,i)}}function N(e,t,n,r){if("key"!==t&&"is"!==t&&null!=n&&!j(t))if("o"!==t[0]||"n"!==t[1]||j(t))if("style"===t)A(e.dom,n,null);else if(!D(e,t,r)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===s())||"input"===e.tag&&"type"===t){var i=t.indexOf(":");-1!==i&&(t=t.slice(i+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else $(e,t,void 0)}function j(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function D(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var L,I=/[A-Z]/g;function q(e){return"-"+e.toLowerCase()}function R(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(I,q)}function A(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var r in e.style.cssText="",n){null!=(i=n[r])&&e.style.setProperty(R(r),String(i))}else{for(var r in n){var i;null!=(i=n[r])&&(i=String(i))!==String(t[r])&&e.style.setProperty(R(r),i)}for(var r in t)null!=t[r]&&null==n[r]&&e.style.removeProperty(R(r))}}function B(){this._=t}function $(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new B,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function F(e,t,n){"function"==typeof e.oninit&&o.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(o.bind(e.oncreate,t))}function U(e,t,n){"function"==typeof e.onupdate&&n.push(o.bind(e.onupdate,t))}return B.prototype=Object.create(null),B.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,n,r){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(null!=L&&e.contains(L))throw new TypeError("Node is currently being rendered to and thus is locked.");var i=t,a=L,o=[],c=s(),l=e.namespaceURI;L=e,t="function"==typeof r?r:void 0;try{null==e.vnodes&&(e.textContent=""),n=Nn.normalizeChildren(Array.isArray(n)?n:[n]),m(e,e.vnodes,n,o,null,"http://www.w3.org/1999/xhtml"===l?void 0:l),e.vnodes=n,null!=c&&s()!==c&&"function"==typeof c.focus&&c.focus();for(var u=0;u<o.length;u++)o[u]()}finally{t=i,L=a}}}(window);function ni(e){if(!m(e))return!1;var t=N(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}const ri=function(){let e=0;return()=>e++}(),ii=new ei;let ai=0,oi="fwd",si="/";const ci=document.body;function li(e,t){const n={view:()=>Nn(e,void 0,t)};function r(){ti(ci,Nn(n))}Ut.redraw.removeAll(),Ut.redraw.add(r);try{r()}catch(e){throw Ut.redraw.removeAll(),e}}function ui(e){e&&e.state&&(oi=e.state.id<ai?"bwd":"fwd",ai=e.state.id),si=gi();const t=window.location.search||"?=";ii.run(t.slice(2))||ii.run("/")}const di={replaceState(e,t){try{const n=e?Object.assign({},window.history.state,e):window.history.state;void 0!==t?window.history.replaceState(n,"","?="+t):window.history.replaceState(n,"")}catch(e){}},pushState(e){const t=ri();ai=t,oi="fwd";try{window.history.pushState({id:t},"","?="+e)}catch(e){}}};function hi(e,t=!1){const n=(window.location.search||"?=/").substring(2).replace(/\?.+$/,"")+`?${an(e)}`;t?fi(n,!0):di.replaceState(void 0,n)}function pi(){const e=gi(),t=/\?.+$/.exec(e),n={};if(t&&t[0])for(const[e,r]of new URLSearchParams(t[0]))n[e]=r;return n}const mi=(()=>{const e=()=>{const t=e.stack.pop();ni(t)?(t("backbutton"),Kt()):/^\/$/.test(gi())?s.exitApp():/^\/game\/[a-zA-Z0-9]{12}/.test(gi())?Ut.gameBackButton.dispatch(event):vi()};return e.stack=[],e})();function fi(e,t=!1){setTimeout((()=>function(e,t=!1){mi.stack=[],si=gi(),t?di.replaceState(void 0,e):di.pushState(e),ii.run(e)||ii.run("/")}(e,t)),0)}function gi(){const e=window.location.search||"?=/";return decodeURIComponent(e.substring(2))}function vi(){window.history.go(-1)}window.backButton=mi;var bi={get:gi,set:fi,reload(){fi(gi(),!0)},setQueryParams:hi,getQueryParams:pi,deleteQueryParam:function(e,t=!1){const n=pi();n&&(delete n[e],hi(n,t))},History:di,backHistory:vi,getViewSlideDirection:()=>oi,backbutton:mi,getPreviousPath:()=>si};const wi=600,yi=4,ki=4,Si="active";function Ci(e,t,n,r,i,a,o,s=!0){let c,l,u,d,h,p,m,f=e;if("function"!=typeof t)throw new Error("ButtonHandler 2nd argument must be a function!");if(n&&"function"!=typeof n)throw new Error("ButtonHandler 3rd argument must be a function!");if(r&&"function"!=typeof r)throw new Error("ButtonHandler 4rd argument must be a function!");function g(){r()&&Ht(g),Gt()}const v={passive:!0};e.addEventListener("touchstart",(function(t){const i=t.changedTouches[0];if(f=o?o(t):e,!f)return;if(!0===f.disabled)return;const a=f.getBoundingClientRect();c=i.clientX,l=i.clientY,u={minX:a.left,maxX:a.right,minY:a.top,maxY:a.bottom},d=!0,clearTimeout(m),f.classList.add(Si),h=setTimeout((()=>function(e){n&&(n(e),d=!1,f&&f.classList.remove(Si))}(t)),wi),r&&(p=setTimeout((()=>{Ht(g)}),500))}),v),e.addEventListener("touchmove",(function(e){if(d&&f){const t=e.changedTouches[0];d=function(e){const t=e.clientX,n=e.clientY,r=u;let o=0,s=0;i&&(o=Math.abs(t-c));a&&(s=Math.abs(n-l));return t<r.maxX&&t>r.minX&&n<r.maxY&&n>r.minY&&o<yi&&s<ki}(t),d||(clearTimeout(h),clearTimeout(p),Vt(g),f.classList.remove(Si))}}),v),e.addEventListener("touchend",(function(e){e.cancelable&&s&&e.preventDefault(),clearTimeout(p),Vt(g),d&&f&&(clearTimeout(h),m=setTimeout((()=>f&&f.classList.remove(Si)),80),t(e),d=!1)}),!1),e.addEventListener("touchcancel",(function(){clearTimeout(h),clearTimeout(p),Vt(g),d=!1,f&&f.classList.remove(Si)}),!1),e.addEventListener("contextmenu",(function(e){e.preventDefault(),e.stopPropagation()}),!1)}let Ti,Pi=null;const Ei=56;function Oi(e){return({dom:t})=>e(t)}function xi(e,t=250,n="0.5",r="1"){let i;function a(){clearTimeout(i),e&&(e.removeAttribute("style"),e.removeEventListener("transitionend",a,!1))}e.style.opacity=n,e.style.transition=`opacity ${t}ms ease-out`,setTimeout((()=>{e.style.opacity=r})),e.addEventListener("transitionend",a,!1),i=setTimeout(a,t+10)}function _i(e){let t;function n(){clearTimeout(t),e&&(e.removeAttribute("style"),e.removeEventListener("transitionend",n,!1))}const r="fwd"===bi.getViewSlideDirection()?"100%":"-100%";e.style.transform=`translate3d(${r},0,0)`,setTimeout((()=>{e.style.transition="transform 250ms ease-out",e.style.transform="translate3d(0%,0,0)"}),10),e.addEventListener("transitionend",n,!1),t=setTimeout(n,270)}function Mi(e,t){let n;function r(){clearTimeout(n),e&&(e.removeAttribute("style"),e.removeEventListener("transitionend",r,!1))}const i="left"===t?"100%":"-100%";e.style.transform=`translate3d(${i},0,0)`,setTimeout((()=>{e.style.transition="transform 250ms ease-out",e.style.transform="translate3d(0%,0,0)"}),10),e.addEventListener("transitionend",r,!1),n=setTimeout(r,270)}function Ni(e,t){return e.closest(t)||e}function ji(){if(Pi)return Pi;const e=document.documentElement;return Pi={vw:e.clientWidth,vh:e.clientHeight}}const Di=Oi(_i),Li=Oi(xi);function Ii(e){const t=e.dom;return t.style.transform="translateY(100%)",e.state.lol=t.offsetHeight,Jr(t,"transform","translateY(0)",250,"ease-out").catch(console.log.bind(console))}function qi(e,t){return function(n){const r=document.getElementById(t);r&&Jr(r,"transform","translateY(100%)",250,"ease-out").then((()=>tn((()=>e(n))))).catch(console.log.bind(console))}}function Ri(e,t){return function(n){const r=document.getElementById(t);r&&Jr(r,"transform","translateX(100%)",250,"ease-out").then((()=>tn((()=>e(n))))).catch(console.log.bind(console))}}function Ai(e){const t=e.dom;return t.style.transform="translateX(100%)",e.state.lol=t.offsetHeight,Jr(t,"transform","translateX(0)",250,"ease-out").catch(console.log.bind(console))}function Bi(e,t,n,r=150){e.stopPropagation();const i=n?Ni(e.target,n):e.target;i?Jr(i,"opacity",0,r).then((()=>tn(t))).catch(console.log.bind(console)):(t(),Kt())}function $i(e,t,n,r,i,a,o){return function(s){Ci(s.dom,(t=>{e(t),Kt()}),t?e=>tn((()=>t(e))):void 0,n,r,i,a,o)}}function Fi(e){return t=>{t.dom.addEventListener("touchstart",e)}}function Ui(e,t,n,r){return $i(e,t,n,!1,!1,r)}function zi(e,t,n){return $i(e,t,void 0,!0,!1,n)}function Wi(e,t,n,r=!0){return $i(e,t,void 0,!1,!0,n,r)}function Hi(e,t,n,r=!0){return $i(e,t,void 0,!0,!0,n,r)}function Vi(e){return 0===e?null:An("span",{className:"progress "+(e>0?"positive":"negative"),"data-icon":e>0?"N":"M"},String(Math.abs(e)))}function Gi(e){const t=[];for(const n in e)e[n]&&t.push(n);return t.join(" ")}function Ki(){const{vw:e,vh:t}=ji();return e>=768&&t>=768}function Yi(){return void 0!==Ti||(Ti=window.matchMedia("(orientation: portrait)").matches),Ti}let Xi=null;function Qi(e){const t=/\d{1,3}/.exec(e),n=t&&t[0],r=Number(n);return isNaN(r)?0:r}function Ji(e,t){const{vh:n,vw:r}=e,i=function(){if(!Xi){const e=getComputedStyle(document.documentElement);return Xi={top:Qi(e.getPropertyValue("--sat")),right:Qi(e.getPropertyValue("--sar")),bottom:Qi(e.getPropertyValue("--sab")),left:Qi(e.getPropertyValue("--sal"))},Xi}return Xi}(),a=Ki();if(t){if(a){const e=.94*r;return{width:e,height:e}}return{width:r,height:r}}if(a){const e=n-Ei-.06*n-i.top;return{width:e,height:e}}{const e=n-Ei-i.top;return{width:e,height:e}}}function Zi(e,t){const n=Ji(e,t);return e.vh-n.height-56-45-110>=25}function ea(e){e.dom.focus()}function ta(e){return void 0===e.ratingDiff?null:0===e.ratingDiff?An("span.rp.null"," +0"):e.ratingDiff>0?An("span.rp.up"," +"+e.ratingDiff):e.ratingDiff<0?An("span.rp.down"," "+e.ratingDiff):null}function na(e){const t=e.target;return"BUTTON"===t.tagName?t:t.closest("button")}function ra(e){const t=e.target;return"LI"===t.tagName?t:t.closest("li")}function ia(e){const t=e.target;return"TR"===t.tagName?t:t.closest("tr")}function aa(e,t){var n;return null===(n=e.target)||void 0===n?void 0:n.closest(t)}function oa(e){return t=>{var n;return null===(n=t.target)||void 0===n?void 0:n.closest(e)}}const sa=r("KeepAwake",{web:()=>import("./web-ac19d938.js").then((e=>new e.KeepAwakeWeb))}),ca=9e5,la=27e5;let ua,da;function ha(){sa.keepAwake(),void 0!==da&&da(),da=function(e,t,n){const r=["touchstart"];let i,a=!1,o=!0,s=performance.now();const c=()=>{o||n(),o=!0,s=performance.now(),u()},l=()=>{a||(r.forEach((e=>{document.addEventListener(e,c)})),a=!0)},u=()=>{a&&(r.forEach((e=>{document.removeEventListener(e,c)})),a=!1)},d=()=>{clearInterval(i),u()};return i=setInterval((()=>{o&&performance.now()-s>e&&(t(),o=!1),l()}),3e4),d}(ca,(()=>{ua=setTimeout((()=>{sa.allowSleep()}),la)}),(()=>{clearTimeout(ua)}))}function pa(){void 0!==da&&(da(),da=void 0),sa.allowSleep()}function ma(e,t,n){void 0!==n?e.postMessage({topic:t,payload:n}):e.postMessage({topic:t})}function fa(e,t){return new Promise(((n,r)=>{e.addEventListener("message",(function i(a){a.data.topic!==t.topic||void 0!==t.reqid&&a.data.reqid!==t.reqid?"error"!==a.data.topic||a.data.payload.callerTopic!==t.topic||void 0!==t.reqid&&a.data.reqid!==t.reqid||(e.removeEventListener("message",i),r(a.data.payload.error)):(e.removeEventListener("message",i),n(a.data.payload))})),e.postMessage(t)}))}const ga="seekLobby",va=new Worker("socketWorker.js");let ba,wa=!1,ya=0,ka=2e3;const Sa={following_onlines:function(e,t){const n=t.playing,r=t.patrons;Qn.reset(e,n,r),Kt()},following_enters:(e,t)=>tn((()=>Qn.set(e,t.playing||!1,t.patron||!1))),following_leaves:e=>tn((()=>Qn.remove(e))),following_playing:e=>tn((()=>Qn.playing(e))),following_stopped_playing:e=>tn((()=>Qn.stoppedPlaying(e))),challenges:e=>{jr.set(e),Kt()},mlat:e=>{ya=e},deployPost(){ma(va,"deploy")},resync(){bi.reload()},announce:e=>{const t=e;t.date?Rr.set(t):Rr.set(void 0)}};function Ca(e,t){const n=_n.get(Wn);null!==n?e.opts.params?e.opts.params[Wn]=n:e.opts.params={[Wn]:n}:e.opts.params&&delete e.opts.params.sessionId,e.opts.options.isAuth=!!n,va.onmessage=e=>{switch(e.data.topic){case"onOpen":t.onOpen&&t.onOpen();break;case"disconnected":wa&&(wa=!1,Kt());break;case"connected":wa||(wa=!0,Kt());break;case"onError":t.onError&&t.onError();break;case"resync":bi.reload();break;case"handle":{const n=t.events[e.data.payload.t];n&&n(e.data.payload.d,e.data.payload);break}case"pingInterval":ka=e.data.payload}},ba={setup:e,handlers:t},ma(va,"create",e)}function Ta(e){return{send:(t,n,r)=>function(e,t,n,r){ma(va,"send",[e,t,n,r])}(e,t,n,r),ask:(t,n,r,i)=>function(e,t,n,r,i){return new Promise(((a,o)=>{let s;function c(e){"handle"===e.data.topic&&e.data.payload.t===n&&(clearTimeout(s),va.removeEventListener("message",c),a(e.data.payload.d))}va.addEventListener("message",c),ma(va,"ask",{msg:[e,t,r,i],listenTo:n}),s=setTimeout((()=>{va.removeEventListener("message",c),o()}),3e3)}))}(e,t,n,r,i)}}function Pa(){ba?Ca(ba.setup,ba.handlers):ma(va,"connect")}Ut.afterLogout.add(Pa);var Ea={createGame:function(e,t,n,r,i){let a=!1;const o={onError:function(){a||(a=!0,kr(r.substring(1)).catch((e=>{401===e.status&&(z.show({text:"Access is unauthorised.",position:"center",duration:"short"}),bi.set("/"))})))},onOpen:Yr.backgroundRefresh,events:Object.assign({},Sa,n)},s={options:{name:"game",debug:"dev"===At.mode,sendOnOpen:[{t:"following_onlines"}],registeredEvents:Object.keys(o.events)}};return i&&(s.params={userTv:i}),Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:e,version:t,opts:s},o),Ta(e)},createChallenge:function(e,t,n,r){const i={onOpen:()=>{Yr.backgroundRefresh(),n()},events:Object.assign({},Sa,r)},a=`/challenge/${e}/socket/v${At.apiVersion}`,o={options:{name:"challenge",debug:"dev"===At.mode,ignoreUnknownMessages:!0,pingDelay:2e3,sendOnOpen:[{t:"following_onlines"}],registeredEvents:Object.keys(i.events)}};return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:a,version:t,opts:o},i),Ta(a)},createLobby:function(e,t,n){const r={onOpen:()=>{Yr.refresh(),t()},events:Object.assign({},Sa,n)},i={options:{name:e,debug:"dev"===At.mode,pingDelay:2e3,sendOnOpen:[{t:"following_onlines"}],registeredEvents:Object.keys(r.events)}},a=`/lobby/socket/v${At.apiVersion}`;return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:a,opts:i},r),Ta(a)},createTournament:function(e,t,n,r){const i="/tournament/"+e+`/socket/v${At.apiVersion}`,a={events:Object.assign({},Sa,n),onOpen:Yr.backgroundRefresh},o={options:{name:"tournament",debug:"dev"===At.mode,pingDelay:2e3,sendOnOpen:[{t:"following_onlines"},{t:"startWatching",d:r}],registeredEvents:Object.keys(a.events)}};return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:i,version:t,opts:o},a),Ta(i)},createDefault:function(){},createAnalysis:function(e){const t={events:Object.assign(Object.assign({},Sa),e),onOpen:Yr.backgroundRefresh},n={options:{name:"analysis",debug:"dev"===At.mode,pingDelay:3e3,sendOnOpen:[{t:"following_onlines"}],registeredEvents:Object.keys(t.events)}},r=`/analysis/socket/v${At.apiVersion}`;return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:r,opts:n},t),Ta(r)},createStudy:function(e,t){const n={events:Object.assign(Object.assign({},Sa),t),onOpen:Yr.backgroundRefresh},r={options:{name:"study",debug:"dev"===At.mode,pingDelay:3e3,sendOnOpen:[{t:"following_onlines"}],registeredEvents:Object.keys(n.events)}},i=`/study/${e}/socket/v${At.apiVersion}`;return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:i,opts:r},n),Ta(i)},createChat:function(e,t){const n={events:Object.assign(Object.assign({},Sa),e),onOpen:()=>{Yr.backgroundRefresh(),t&&t()}},r={options:{name:"chat",debug:"dev"===At.mode,pingDelay:2500,registeredEvents:Object.keys(n.events)}},i=`/socket/v${At.apiVersion}`;return Ca({clientId:Qt(),socketEndPoint:At.socketEndPoint,url:i,opts:r},n),Ta(i)},redirectToGame:function(e){let t;if("string"==typeof e)t=e;else if(t=e.url,e.cookie){const t=document.domain.replace(/^.+(\.[^.]+\.[^.]+)$/,"$1"),n=[encodeURIComponent(e.cookie.name)+"="+e.cookie.value,"; max-age="+e.cookie.maxAge,"; path=/","; domain="+t].join("");document.cookie=n}bi.set("/game"+t)},sendWithNoCheck(e,t,n){["moveLat"].includes(e)&&ma(va,"send",["noCheck",e,t,n])},setVersion(e){ma(va,"setVersion",e)},connect(){ma(va,"connect")},reconnectCurrent:Pa,disconnect(){ma(va,"disconnect")},delayedDisconnect(e){ma(va,"delayedDisconnect",e)},cancelDelayedDisconnect(){ma(va,"cancelDelayedDisconnect")},isConnected:()=>wa,destroy(){ma(va,"destroy")},getVersion:()=>fa(va,{topic:"getVersion"}),getCurrentPing:()=>fa(va,{topic:"averageLag"}),getCurrentMoveLatency:()=>ya,getCurrentPingInterval:()=>ka,terminate(){va&&va.terminate()}};function Oa(e){return void 0!==e.id}function xa(e){return void 0!==e.timeMode}function _a(e){return void 0!==e.steps}async function Ma(e){return Ra(await Gn(`/inbox/${e}`))}async function Na(e,t){return Ra(await Gn(`/inbox/${e}?before=${t.getTime()}`))}async function ja(){return Ra(await Gn("/inbox"))}async function Da(e){const t=await Gn(`/inbox/search?q=${e}`);return Object.assign(Object.assign({},t),{contacts:t.contacts.map($a)})}function La(e){return Gn(`/rel/block/${e}`,{method:"POST"})}function Ia(e){return Gn(`/rel/unblock/${e}`,{method:"POST"})}async function qa(e){return Gn(`/inbox/${e}/delete`,{method:"POST"}).then(Ra)}class MessageSocket{constructor(e){const t=function(e){return{msgNew:t=>{e.receive(Object.assign(Object.assign({},Aa(t)),{read:!1}))},msgType:e.receiveTyping,blockedBy:e.changeBlockBy,unblockedBy:e.changeBlockBy}}(e);this.socket=Ea.createChat(t)}post(e,t){this.socket.send("msgSend",{dest:e,text:t})}setRead(e){this.socket.send("msgRead",e)}typing(e){this.socket.send("msgType",e)}}function Ra(e){return Object.assign(Object.assign({},e),{convo:e.convo&&(t=e.convo,Object.assign(Object.assign({},t),{user:Ba(t.user),msgs:t.msgs.map(Aa)})),contacts:e.contacts.map($a)});var t}function Aa(e){return Object.assign(Object.assign({},e),{date:new Date(e.date)})}function Ba(e){return Object.assign(Object.assign({},e),{id:e.name.toLowerCase()})}function $a(e){return Object.assign(Object.assign({},e),{user:Ba(e.user),lastMsg:Aa(e.lastMsg)})}const Fa=.6,Ua=25,za=.7;function Wa(){const e=ji().vw;return e*(e>=960?.35:e>=500?.5:.85)}function Ha(e,t){e.style.transform=`translate3d(${t}px, 0, 0)`}function Va(e,t){e.style.opacity=`${t}`}class SideMenuCtrl{constructor(e,t,n,r,i){this.isOpen=!1,this.open=()=>{this.isOpen=!0,bi.backbutton.stack.push(this.close);const e=document.getElementById(this.menuID),t=document.getElementById(this.backdropID);return this.onOpen&&this.onOpen(),Promise.all([Jr(t,"visibility","visible",0),Jr(t,"opacity",.7,250,"linear"),Jr(e,"visibility","visible",0),Jr(e,"transform","translate3d(0,0,0)",250,"ease-out")]).then(Kt).catch(console.error.bind(console))},this.close=e=>{"backbutton"!==e&&this.isOpen&&bi.backbutton.stack.pop(),this.isOpen=!1;const t=document.getElementById(this.menuID),n=document.getElementById(this.backdropID);return this.onClose&&this.onClose(),Promise.all([Jr(n,"opacity",0,250,"linear"),Jr(t,"transform",this.closeTranslate(),250,"ease-out")]).then((()=>Promise.all([Jr(t,"visibility","hidden",0),Jr(n,"visibility","hidden",0)]))).catch(console.error.bind(console))},this.toggle=e=>{e.stopPropagation(),this.isOpen?this.close():this.open()},this.closeTranslate=()=>"left"===this.side?"translate3d(-100%,0,0)":"translate3d(100%,0,0)",this.side=e,this.menuID=t,this.backdropID=n,this.onOpen=r,this.onClose=i}getMenuEl(){return document.getElementById(this.menuID)}getBackdropEl(){return document.getElementById(this.backdropID)}}let Ga;const Ka=Cn(0),Ya=Cn(!1),Xa=Cn(0),Qa=Cn(0);const Ja=new SideMenuCtrl("left","side_menu","menu-close-overlay",(function(){Ga=setTimeout(no,2e3)}),(function(){Ya(!1),clearTimeout(Ga)}));function Za(e){return function(){return Ja.close().then((()=>bi.set(e)))}}function eo(e){return function(){return Ja.close().then((()=>{e(),Kt()}))}}function to(){const e=!Ya();e&&Gn("/inbox/unread-count",{},!1).then((e=>{Ka(e),Kt()})),Ya(e)}function no(){}const ro=Ui((e=>{e.stopPropagation(),Ja.close()})),io=Symbol("newer"),ao=Symbol("older");class LRUMap{constructor(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[io]&&(e===this.oldest&&(this.oldest=e[io]),e[io][ao]=e[ao]),e[ao]&&(e[ao][io]=e[io]),e[io]=void 0,e[ao]=this.newest,this.newest&&(this.newest[io]=e),this.newest=e)}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let r=e[Symbol.iterator]();for(let e=r.next();!e.done;e=r.next()){let r=new oo(e.value[0],e.value[1]);if(this._keymap.set(r.key,r),t?(t[io]=r,r[ao]=t):this.oldest=r,t=r,0==n--)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}get(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value}set(e,t){var n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,n=new oo(e,t)),this.newest?(this.newest[io]=n,n[ao]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){var e=this.oldest;if(e)return this.oldest[io]?(this.oldest=this.oldest[io],this.oldest[ao]=void 0):(this.oldest=void 0,this.newest=void 0),e[io]=e[ao]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}toJSON(){for(var e=new Array(this.size),t=0,n=this.oldest;n;)e[t++]=[n.key,n.value],n=n[io];return e}}function oo(e,t){this.key=e,this.value=t,this[io]=void 0,this[ao]=void 0}const so=new LRUMap(100);function co(e,t){return e?(e.title?e.title+" "+e.name:e.name)+(t?" ("+e.rating+")":""):"Anonymous"}function lo(e,t=!1,n=!1,r){if(e.name||e.username||e.user){let o=e.name||e.username||e.user.username;return e.user&&e.user.title&&(o=e.user.title+" "+o),n&&(a=r||100,o=(i=o).length>a?i.slice(0,a)+"…":i),t&&(e.user||e.rating)&&(o+=" ("+(e.rating||e.user.rating),e.provisional&&(o+="?"),o+=")"),o}var i,a;return e.ai?uo(e):"Anonymous"}function uo(e){return yt("aiNameLevelAiLevel","Stockfish",e.ai)}const ho="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",po={standard:{name:"Standard",tinyName:"Std",id:1,link:"https://en.wikipedia.org/wiki/Rules_of_chess",title:"Standard rules of chess (FIDE)"},chess960:{name:"Chess960",tinyName:"960",id:2,link:"https://lichess.org/variant/chess960",alert:"This is a Chess960 game!\n\nThe starting position of the pieces on the players' home ranks is randomized.",title:"Starting position of the home rank pieces is randomized."},fromPosition:{name:"From position",shortName:"Fen",tinyName:"Fen",id:3,title:"Custom starting position"},kingOfTheHill:{name:"King of the Hill",shortName:"KotH",tinyName:"KotH",id:4,link:"https://lichess.org/variant/kingOfTheHill",alert:"This is a King of the Hill game!\n\nThe game can be won by bringing the king to the center.",title:"Bring your King to the center to win the game."},threeCheck:{name:"Three-check",shortName:"3-check",tinyName:"3+",id:5,link:"https://lichess.org/variant/threeCheck",alert:"This is a Three-check game!\n\nThe game can be won by checking the opponent 3 times.",title:"Check your opponent 3 times to win the game.",initialFen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1 +0+0"},antichess:{name:"Antichess",tinyName:"Anti",id:6,link:"https://lichess.org/variant/antichess",alert:"This is an antichess chess game!\n\n If you can take a piece, you must. The game can be won by losing all your pieces.",title:"Lose all your pieces (or reach a stalemate) to win the game."},atomic:{name:"Atomic",tinyName:"Atom",id:7,link:"https://lichess.org/variant/atomic",alert:"This is an atomic chess game!\n\nCapturing a piece causes an explosion, taking out your piece and surrounding non-pawns. Win by mating or exploding your opponent's king.",title:"Nuke your opponent's king to win."},horde:{name:"Horde",tinyName:"Horde",id:8,link:"https://lichess.org/variant/horde",alert:"This is a horde chess game!\n\nBlack must take all white pawns to win. White must checkmate black king.",title:"Destroy the horde to win!",initialFen:"rnbqkbnr/pppppppp/8/1PP2PP1/PPPPPPPP/PPPPPPPP/PPPPPPPP/PPPPPPPP w kq - 0 1"},racingKings:{name:"Racing Kings",shortName:"Racing",tinyName:"Racing",id:9,link:"https://lichess.org/variant/racingKings",alert:"Race to the eighth rank to win.",title:"Race your King to the eighth rank to win.",initialFen:"8/8/8/8/8/8/krbnNBRK/qrbnNBRQ w - - 0 1"},crazyhouse:{name:"Crazyhouse",tinyName:"Crazy",id:10,link:"https://lichess.org/variant/crazyhouse",alert:"This is a crazyhouse game!\n\nEvery time a piece is captured the capturing player gets a piece of the same type and of their color in their pocket.",title:"Captured pieces can be dropped back on the board instead of moving a piece.",initialFen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR/ w KQkq - 0 1"}};function mo(e){return po[e]}function fo(e){const t=po[e];return{key:e,name:t.name,short:t.shortName||t.tinyName||t.name,title:t.title}}function go(e){return po[e].initialFen||ho}function vo(e){switch(e){case"fromPosition":case"standard":case"chess960":return"chess";case"threeCheck":return"3check";default:return e.toLowerCase()}}const bo=new Set(["crazyhouse","threeCheck"]);class Siema{constructor(e){if(this.config=Siema.mergeSettings(e),this.selector="string"==typeof this.config.selector?document.querySelector(this.config.selector):this.config.selector,null===this.selector)throw new Error("Something wrong with your selector ??");this.resolveSlidesNumber(),this.selectorWidth=this.selector.offsetWidth,this.innerElements=[].slice.call(this.selector.children),this.currentSlide=Math.max(0,Math.min(this.config.startIndex,this.innerElements.length-this.perPage)),this.transformProperty="transform",["resizeHandler","touchstartHandler","touchendHandler","touchmoveHandler"].forEach((e=>{this[e]=this[e].bind(this)})),this.init()}static mergeSettings(e){const t={selector:".siema",duration:200,easing:"ease-out",perPage:1,startIndex:0,draggable:!0,threshold:20,rtl:!1,onInit:()=>{},onChange:()=>{}},n=e;for(const e in n)t[e]=n[e];return t}attachEvents(){if(window.addEventListener("resize",this.resizeHandler),this.config.draggable){this.pointerDown=!1,this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:!1};const e={passive:!0};this.selector.addEventListener("touchstart",this.touchstartHandler,e),this.selector.addEventListener("touchend",this.touchendHandler,e),this.selector.addEventListener("touchmove",this.touchmoveHandler,e)}}detachEvents(){window.removeEventListener("resize",this.resizeHandler),this.selector.removeEventListener("touchstart",this.touchstartHandler),this.selector.removeEventListener("touchend",this.touchendHandler),this.selector.removeEventListener("touchmove",this.touchmoveHandler)}init(){this.attachEvents(),this.selector.style.overflow="hidden",this.selector.style.direction=this.config.rtl?"rtl":"ltr",this.buildSliderFrame(),this.config.onInit.call(this)}buildSliderFrame(){const e=this.selectorWidth/this.perPage,t=this.innerElements.length;this.sliderFrame=document.createElement("div"),this.sliderFrame.style.width=e*t+"px";const n=document.createDocumentFragment();for(let e=0;e<this.innerElements.length;e++){const t=this.buildSliderFrameItem(this.innerElements[e]);n.appendChild(t)}this.sliderFrame.appendChild(n),this.selector.innerHTML="",this.selector.appendChild(this.sliderFrame),this.slideToCurrent()}buildSliderFrameItem(e){const t=document.createElement("div");return t.style.cssFloat=this.config.rtl?"right":"left",t.style.float=this.config.rtl?"right":"left",t.style.width=100/this.innerElements.length+"%",t.appendChild(e),t}resolveSlidesNumber(){if("number"==typeof this.config.perPage)this.perPage=this.config.perPage;else if("object"==typeof this.config.perPage){this.perPage=1;for(const e in this.config.perPage)window.innerWidth>=e&&(this.perPage=this.config.perPage[e])}}prev(e=1){if(this.innerElements.length<=this.perPage)return;const t=this.currentSlide;this.currentSlide=Math.max(this.currentSlide-e,0),t!==this.currentSlide&&(this.slideToCurrent(),setTimeout((()=>this.config.onChange()),0))}next(e=1){if(this.innerElements.length<=this.perPage)return;const t=this.currentSlide;this.currentSlide=Math.min(this.currentSlide+e,this.innerElements.length-this.perPage),t!==this.currentSlide&&(this.slideToCurrent(),setTimeout((()=>this.config.onChange()),0))}goTo(e){if(this.innerElements.length<=this.perPage)return;const t=this.currentSlide;this.currentSlide=Math.min(Math.max(e,0),this.innerElements.length-this.perPage),t!==this.currentSlide&&(this.slideToCurrent(),setTimeout((()=>this.config.onChange()),0))}slideToCurrent(){const e=this.currentSlide,t=(this.config.rtl?1:-1)*e*(this.selectorWidth/this.perPage);Jr(this.sliderFrame,"transform",`translate3d(${t}px, 0, 0)`,this.config.duration,this.config.easing)}updateAfterDrag(){const e=(this.config.rtl?-1:1)*(this.drag.endX-this.drag.startX),t=Math.abs(e);e>0&&t>this.config.threshold&&this.innerElements.length>this.perPage&&this.currentSlide-1>=0?this.prev(1):e<0&&t>this.config.threshold&&this.innerElements.length>this.perPage&&this.currentSlide+1<=this.innerElements.length-this.perPage?this.next(1):this.slideToCurrent()}resizeHandler(){this.resolveSlidesNumber(),this.currentSlide+this.perPage>this.innerElements.length&&(this.currentSlide=this.innerElements.length<=this.perPage?0:this.innerElements.length-this.perPage),this.selectorWidth=this.selector.offsetWidth,this.buildSliderFrame()}clearDrag(){this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:this.drag.preventClick}}touchstartHandler(e){-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.target.nodeName)||(e.stopPropagation(),this.pointerDown=!0,this.drag.startX=e.touches[0].pageX,this.drag.startY=e.touches[0].pageY)}touchendHandler(e){e.stopPropagation(),this.pointerDown=!1,this.drag.endX&&this.updateAfterDrag(),this.clearDrag()}touchmoveHandler(e){if(e.stopPropagation(),null===this.drag.letItGo&&(this.drag.letItGo=Math.abs(this.drag.startY-e.touches[0].pageY)<Math.abs(this.drag.startX-e.touches[0].pageX)),this.pointerDown&&this.drag.letItGo){this.drag.endX=e.touches[0].pageX;const t=this.currentSlide*(this.selectorWidth/this.perPage),n=this.drag.endX-this.drag.startX,r=this.config.rtl?t+n:t-n;this.sliderFrame.style[this.transformProperty]=`translate3d(${(this.config.rtl?1:-1)*r}px, 0, 0)`}}remove(e,t){if(e<0||e>=this.innerElements.length)throw new Error("Item to remove doesn't exist ??");const n=e<this.currentSlide,r=this.currentSlide+this.perPage-1===e;(n||r)&&this.currentSlide--,this.innerElements.splice(e,1),this.buildSliderFrame(),t&&t.call(this)}insert(e,t,n){if(t<0||t>this.innerElements.length+1)throw new Error("Unable to inset it at this index ??");if(-1!==this.innerElements.indexOf(e))throw new Error("The same item in a carousel? Really? Nope ??");const r=t<=this.currentSlide>0&&this.innerElements.length;this.currentSlide=r?this.currentSlide+1:this.currentSlide,this.innerElements.splice(t,0,e),this.buildSliderFrame(),n&&n.call(this)}prepend(e,t){this.insert(e,0),t&&t.call(this)}append(e,t){this.insert(e,this.innerElements.length+1),t&&t.call(this)}destroy(e=!1,t){if(this.detachEvents(),this.selector.style.cursor="auto",e){const e=document.createDocumentFragment();for(let t=0;t<this.innerElements.length;t++)e.appendChild(this.innerElements[t]);this.selector.innerHTML="",this.selector.appendChild(e),this.selector.removeAttribute("style")}t&&t.call(this)}}function wo(e,...t){e&&setTimeout((()=>e(...t)),1)}function yo(){}const ko=["a","b","c","d","e","f","g","h"],So=ko.slice().reverse(),Co=[1,2,3,4,5,6,7,8],To=[8,7,6,5,4,3,2,1];function Po(e,t){return Math.round(e*t)/t}function Eo(e){return ko[e[0]-1]+e[1]}function Oo(e){return[e.charCodeAt(0)-96,e.charCodeAt(1)-48]}function xo(e,t,n){return[(t?e[0]-1:8-e[0])*n.width/8,(t?8-e[1]:e[1]-1)*n.height/8]}(()=>{const e=[];To.forEach((t=>{Co.forEach((n=>{e.push([n,t])}))}))})();const _o=Array.prototype.concat(...ko.map((e=>Co.map((t=>e+t)))));function Mo(e){return"white"===e?"black":"white"}function No(e,t){return void 0!==e&&-1!==e.indexOf(t)}function jo(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Do(e,t,n){if(e.otb){const r=e.orientation,i=e.otbMode,a=e.turnColor;return"facing"===i&&"white"===r&&"black"===t||"facing"===i&&"black"===r&&"white"===t||"flip"===i&&"white"===r&&"black"===a||"flip"===i&&"black"===r&&"white"===a?n+" rotate(180deg)":n}return n}function Lo(e){return"translate("+e[0]+"px,"+e[1]+"px)"}function Io(e){return"translate3d("+e[0]+"px,"+e[1]+"px, 0)"}_o.slice(0).reverse();const qo=Lo([-99999,-99999]),Ro=Io([-99999,-99999]);function Ao(e){const t=e.targetTouches[0];return[t.clientX,t.clientY]}function Bo(e,t,n){const r=Oo(n);return"white"!==e&&(r[0]=9-r[0],r[1]=9-r[1]),{left:t.left+t.width*(r[0]-1)/8,top:t.top+t.height*(8-r[1])/8,width:t.width/8,height:t.height/8}}function $o(e,t){let n=e.board.firstChild;for(;n;){if("PIECE"===n.tagName&&n.cgKey===t)return n;n=n.nextSibling}return null}function Fo(e,t){return Math.abs(e-t)}const Uo=(e,t,n,r)=>{const i=Fo(e,n),a=Fo(t,r);return 1===i&&2===a||2===i&&1===a},zo=(e,t,n,r)=>Fo(e,n)===Fo(t,r),Wo=(e,t,n,r)=>e===n||t===r,Ho=(e,t,n,r)=>zo(e,t,n,r)||Wo(e,t,n,r);function Vo(e,t,n){const r=e.get(t);if(!r)return[];const i=Oo(t);let a;switch(r.role){case"pawn":o=r.color,a=(e,t,n,r)=>Fo(e,n)<2&&("white"===o?r===t+1||t<=2&&r===t+2&&e===n:r===t-1||t>=7&&r===t-2&&e===n);break;case"knight":a=Uo;break;case"bishop":a=zo;break;case"rook":a=Wo;break;case"queen":a=Ho;break;case"king":a=function(e,t,n){return(r,i,a,o)=>Fo(r,a)<2&&Fo(i,o)<2||n&&i===o&&i===("white"===e?1:8)&&(5===r&&(3===a||7===a)||No(t,a))}(r.color,function(e,t){const n=[];for(const[r,i]of e)i&&i.color===t&&"rook"===i.role&&n.push(Oo(r)[0]);return n}(e,r.color),n)}var o;return _o.map(Oo).filter((e=>(i[0]!==e[0]||i[1]!==e[1])&&a(i[0],i[1],e[0],e[1]))).map(Eo)}function Go(e){e.orientation=Mo(e.orientation)}function Ko(e,t){for(const[n,r]of t)r?e.pieces.set(n,r):e.pieces.delete(n)}function Yo(e,t){if(e.check=null,!0===t&&(t=e.turnColor),t)for(const[n,r]of e.pieces)"king"===r.role&&r.color===t&&(e.check=n)}function Xo(e){e.premovable.current&&(e.premovable.current=null,wo(e.premovable.events.unset))}function Qo(e){e.predroppable.current&&(e.predroppable.current=null,wo(e.predroppable.events.unset))}function Jo(e,t,n,r){if(is(e,t,n)){if(us(e,t,n))return ts(e,null),wo(e.movable.events.after,t,n,{premove:!1,promote:r}),!0}else!function(e,t,n){return t!==n&&as(e,t)&&No(Vo(e.pieces,t,e.premovable.castle),n)}(e,t,n)?rs(e,n)||as(e,n)?ts(e,n):ns(e):(!function(e,t,n){Qo(e),e.premovable.current=[t,n],wo(e.premovable.events.set,t,n)}(e,t,n),ts(e,null));return!1}function Zo(e,t,n,r=!1){const i=e.pieces.get(t);i&&(function(e,t,n){const r=e.pieces.get(t);return!!r&&n&&(t===n||!e.pieces.has(n))&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}(e,t,n)||r)?(e.pieces.delete(t),ls(e,i,n,r),wo(e.movable.events.afterNewPiece,i.role,n,{predrop:!1})):i&&function(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);return!!r&&n&&(!i||i.color!==e.movable.color)&&e.predroppable.enabled&&("pawn"!==r.role||"1"!==n[1]&&"8"!==n[1])&&e.movable.color===r.color&&e.turnColor!==r.color}(e,t,n)?function(e,t,n){Xo(e),e.predroppable.current={role:t,key:n},wo(e.predroppable.events.set,t,n)}(e,i.role,n):(Xo(e),Qo(e)),e.pieces.delete(t),ts(e,null)}function es(e,t){e.selected?e.selected!==t||e.draggable.enabled?e.selectable.enabled&&e.selected!==t&&Jo(e,e.selected,t):ns(e):(rs(e,t)||as(e,t))&&ts(e,t),wo(e.events.select,t)}function ts(e,t){e.selected=t,t&&as(e,t)?e.premovable.dests=Vo(e.pieces,t,e.premovable.castle):e.premovable.dests=null}function ns(e){e.selected=null,e.premovable.dests=null}function rs(e,t){const n=e.pieces.get(t);return!!n&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}function is(e,t,n){return t!==n&&rs(e,t)&&(e.movable.free||null!==e.movable.dests&&No(e.movable.dests[t],n))}function as(e,t){const n=e.pieces.get(t);return!!n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}function os(e){const t=e.premovable.current;if(!t)return;const n=t[0],r=t[1];is(e,n,r)&&us(e,n,r)&&wo(e.movable.events.after,n,r,{premove:!0}),Xo(e)}function ss(e){Xo(e),Qo(e),ts(e,null)}function cs(e,t,n){const r=e.pieces.get(t);if(t===n||!r)return!1;const i=e.pieces.get(n),a=i&&i.color!==r.color?i:void 0;return wo(e.events.move,t,n,a),function(e,t,n){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||"king"!==r.role)return!1;const i=Oo(t),a=Oo(n);if(1!==i[1]&&8!==i[1]||i[1]!==a[1])return!1;5!==i[0]||e.pieces.has(n)||(7===a[0]?n=Eo([8,a[1]]):3===a[0]&&(n=Eo([1,a[1]])));const o=e.pieces.get(n);if(!o||o.color!==r.color||"rook"!==o.role)return!1;e.pieces.delete(t),e.pieces.delete(n),i[0]<a[0]?(e.pieces.set(Eo([7,a[1]]),r),e.pieces.set(Eo([6,a[1]]),o)):(e.pieces.set(Eo([3,a[1]]),r),e.pieces.set(Eo([4,a[1]]),o));return!0}(e,t,n)||(e.pieces.set(n,r),e.pieces.delete(t)),e.lastMove=[t,n],e.check=null,wo(e.events.change),!0}function ls(e,t,n,r=!1){if(e.pieces.has(n)){if(!r)return!1;e.pieces.delete(n)}return wo(e.events.dropNewPiece,t,n),e.pieces.set(n,t),e.lastMove=[n,n],e.check=null,wo(e.events.change),e.movable.dests={},e.turnColor=Mo(e.turnColor),!0}function us(e,t,n){const r=cs(e,t,n);return r&&(e.movable.dests=null,e.turnColor=Mo(e.turnColor),e.animation.current=null),r}function ds(){return{variant:"standard",pieces:new Map,orientation:"white",turnColor:"white",check:null,lastMove:null,lastPromotion:null,selected:null,coordinates:!0,symmetricCoordinates:!1,otb:!1,otbMode:"facing",shift:null,shiftView:null,autoCastle:!0,viewOnly:!1,fixed:!1,edit:!1,exploding:null,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200,current:null},movable:{free:!0,color:"both",dests:null,dropped:null,showDests:!0,rookCastle:!0,events:{}},premovable:{enabled:!0,showDests:!0,castle:!0,dests:null,current:null,events:{}},predroppable:{enabled:!1,current:null,events:{}},draggable:{enabled:!0,distance:3,magnified:!0,centerPiece:!1,preventDefault:!0,showGhost:!0,deleteOnDropOff:!1,current:null},selectable:{enabled:!0},events:{},prev:{orientation:null,bounds:null,turnColor:null,otbMode:null},peripheral:{isMoveRejected:!1,lastMove:null,lastPromotion:null,isVariantSupported:!1,isSynchronized:!0,isGettable:!1,isSettable:!1,pieces:new Map}}}const hs={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king",m:"unsupport",d:"unsupport",P:"pawn",R:"rook",N:"knight",B:"bishop",Q:"queen",K:"king",M:"unsupport",D:"unsupport"},ps={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k",unsupport:"p"};var ms={convertFenToPeripheralPieces:function(e){const t=new Map;let n=8,r=0;for(let i=0;i<e.length;i++){const a=e[i];switch(a){case" ":return t;case"/":if(--n,0===n)return t;r=0;break;default:{const e=~~a;if(e)r+=e;else{++r;const e=a.toLowerCase();t.set(Eo([r,n]),{role:"u?".includes(e)?void 0:hs[e],color:"?"===e?void 0:a===e?"black":"white"})}}}}return t},convertFenToPieces:function(e){"start"===e&&(e="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR");const t=new Map;let n=8,r=0;for(let i=0;i<e.length;i++){const a=e[i];switch(a){case" ":return t;case"/":if(--n,0===n)return t;r=0;break;case"~":{const e=Eo([r,n]),i=t.get(e);i&&(i.promoted=!0,t.set(e,i));break}default:{const e=~~a;if(e)r+=e;else{++r;const e=a.toLowerCase();t.set(Eo([r,n]),{role:hs[e],color:a===e?"black":"white"})}}}}return t},convertPeripheralPiecesToFen:function(e){return[8,7,6,5,4,3,2].reduce((function(e,t){return e.replace(new RegExp(Array(t+1).join("1"),"g"),String(t))}),To.map((t=>Co.map((n=>{const r=e.get(Eo([n,t]));if(r){if(r.role){const e=ps[r.role];return"white"===r.color?e.toUpperCase():e}return r.color?"white"===r.color?"U":"u":"?"}return"1"})).join(""))).join("/"))},convertPiecesToFen:function(e){return[8,7,6,5,4,3,2].reduce((function(e,t){return e.replace(new RegExp(Array(t+1).join("1"),"g"),String(t))}),To.map((t=>Co.map((n=>{const r=e.get(Eo([n,t]));if(r){const e=ps[r.role];return"white"===r.color?e.toUpperCase():e}return"1"})).join(""))).join("/"))}};function fs(e,t){t&&(t.movable&&t.movable.dests&&(e.movable.dests=null),bs(e,t),t.variant&&(e.variant=t.variant),t.fen&&(e.pieces=ms.convertFenToPieces(t.fen)),Object.prototype.hasOwnProperty.call(t,"check")&&Yo(e,t.check||!1),Object.prototype.hasOwnProperty.call(t,"lastMove")&&!t.lastMove&&(e.lastMove=null),e.selected&&ts(e,e.selected),t.edit&&(e.edit=t.edit),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),vs(e))}function gs(e,t){t&&(t.variant&&(e.variant=t.variant),t.fen&&(e.pieces=ms.convertFenToPieces(t.fen)),void 0!==t.orientation&&(e.orientation=t.orientation),void 0!==t.turnColor&&(e.turnColor=t.turnColor),void 0!==t.otb&&(e.otb=t.otb),void 0!==t.shift&&(e.shift=t.shift),void 0!==t.shiftView&&(e.shiftView=t.shiftView),void 0!==t.dests&&(e.movable.dests=t.dests),void 0!==t.movableColor&&(e.movable.color=t.movableColor),Object.prototype.hasOwnProperty.call(t,"check")&&Yo(e,t.check||!1),Object.prototype.hasOwnProperty.call(t,"lastMove")&&!t.lastMove?e.lastMove=null:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&ts(e,e.selected),vs(e))}function vs(e){if(!e.movable.rookCastle&&e.movable.dests){const t="white"===e.movable.color?1:8,n="e"+t,r=e.movable.dests[n],i=e.pieces.get(n);if(!r||!i||"king"!==i.role)return;e.movable.dests[n]=r.filter((e=>!(e==="a"+t&&-1!==r.indexOf("c"+t)||e==="h"+t&&-1!==r.indexOf("g"+t))))}}function bs(e,t){for(const n in t)ws(e[n])&&ws(t[n])?bs(e[n],t[n]):e[n]=t[n]}function ws(e){return e&&"object"==typeof e}function ys(e,t){const n=t.board,r="white"===e.orientation,i=e.fixed?Cs:Ss(t.bounds),a=e.prev.orientation&&e.prev.orientation!==e.orientation;e.prev.orientation=e.orientation;const o=e.prev.bounds&&e.prev.bounds!==t.bounds;e.prev.bounds=t.bounds;const s=o||a,c=e.pieces,l=e.animation.current&&e.animation.current.plan.anims,u=e.animation.current&&e.animation.current.plan.captured,d=function(e){const t=new Map,n=e.pieces,r=e.peripheral.pieces,i=!r.size;if(e.peripheral.isSynchronized||i)e.lastMove&&e.highlight.lastMove&&(Ns(t,e.lastMove[0],"last-move"),Ns(t,e.lastMove[1],"last-move")),e.check&&e.highlight.check&&Ns(t,e.check,"check"),e.peripheral.isVariantSupported&&e.peripheral.isMoveRejected&&e.peripheral.lastMove&&(Ns(t,e.peripheral.lastMove[0],"rejected-move"),Ns(t,e.peripheral.lastMove[1],"rejected-move"));else if(e.peripheral.isVariantSupported){for(const[e,i]of n){const n=r.get(e);n?(n.role&&n.role!==i.role||n.color&&n.color!==i.color)&&Ns(t,e,"piece-replace"):Ns(t,e,"piece-add")}for(const e of r.keys())n.has(e)||Ns(t,e,"piece-remove")}if(e.selected&&(Ns(t,e.selected,"selected"),e.movable.showDests)){const n=e.movable.dests&&e.movable.dests[e.selected];if(n)for(let r=0,i=n.length;r<i;r++){const i=n[r];Ns(t,i,"move-dest"+(e.pieces.has(i)?" occupied":""))}const r=e.premovable.dests;if(r)for(let n=0,i=r.length;n<i;n++){const i=r[n];Ns(t,i,"premove-dest"+(e.pieces.has(i)?" occupied":""))}}const a=e.premovable.current;a&&(Ns(t,a[0],"current-premove"),Ns(t,a[1],"current-premove"));if(e.exploding)for(const n of e.exploding.keys)Ns(t,n,"exploding"+e.exploding.stage);return t}(e),h=new Set,p=new Set,m=new Map,f=new Map;let g,v,b,w,y,k,S,C,T,P,E=!1;e.otb&&(T=e.prev.turnColor&&e.prev.turnColor!==e.turnColor,P=e.prev.otbMode&&e.prev.otbMode!==e.otbMode,e.prev.otbMode=e.otbMode,e.prev.turnColor=e.turnColor,E=!(!T&&!P));let O=t.board.firstChild;for(;O;){const t=O.cgKey;if(Es(O))if(v=c.get(t),g=d.get(t),b=l&&l.get(t),w=u&&u.get(t),k=O.cgPiece,!O.cgDragging||e.draggable.current&&e.draggable.current.orig===t||(O.classList.remove("dragging"),O.classList.remove("magnified"),y=i(Oo(t),r),Ts(e,O,O.cgColor,y),O.cgDragging=!1),!w&&O.cgCaptured&&(O.cgCaptured=!1,O.classList.remove("captured")),v){const n=xs(v);b&&O.cgAnimating&&k===n?(y=i(Oo(t),r),y[0]+=b[1][0],y[1]+=b[1][1],O.classList.add("anim"),Ts(e,O,O.cgColor,y)):O.cgAnimating&&(y=i(Oo(t),r),Ts(e,O,O.cgColor,y),O.classList.remove("anim"),O.cgAnimating=!1),k!==n||s||E||w&&O.cgCaptured?w&&xs(w)===k?(O.classList.add("captured"),O.cgCaptured=!0):Ms(m,k,O):h.add(t)}else Ms(m,k,O);else Os(O)&&(s||g!==O.className?Ms(f,O.className,O):p.add(t));O=O.nextSibling}for(const[t,a]of d)if(!p.has(t))if(S=f.get(a),C=S&&S.pop(),C)C.cgKey=t,y=i(Oo(t),r),Ps(e,C,y);else{const o=document.createElement("square");o.className=a,o.cgKey=t,y=i(Oo(t),r),Ps(e,o,y),n.insertBefore(o,n.firstChild)}for(const[t,a]of c){const o=a.role+a.color;if(b=l&&l.get(t),!h.has(t))if(S=m.get(o),C=S&&S.pop(),C)C.cgKey=t,y=i(Oo(t),r),b&&(C.cgAnimating=!0,y[0]+=b[1][0],y[1]+=b[1][1]),Ts(e,C,C.cgColor,y);else{const o=document.createElement("piece"),s=xs(a);o.className=s,o.cgPiece=s,o.cgColor=a.color,o.cgKey=t,y=i(Oo(t),r),b&&(o.cgAnimating=!0,y[0]+=b[1][0],y[1]+=b[1][1]),Ts(e,o,a.color,y),n.appendChild(o)}}for(const e of m.values())_s(t,e);for(const e of f.values())_s(t,e)}function ks(e,t,n,r){return[(t?e[0]-1:8-e[0])*n,(t?8-e[1]:e[1]-1)*r]}const Ss=e=>{const t=e.width/8,n=e.height/8;return(e,r)=>ks(e,r,t,n)},Cs=(e,t)=>ks(e,t,12.5,12.5);function Ts(e,t,n,r){e.fixed?(t.style.left=r[0]+"%",t.style.top=r[1]+"%"):t.style.transform=Do(e,n,Lo(r))}function Ps(e,t,n){e.fixed?(t.style.left=n[0]+"%",t.style.top=n[1]+"%"):t.style.transform=Lo(n)}function Es(e){return"PIECE"===e.tagName}function Os(e){return"SQUARE"===e.tagName}function xs(e){return e.role+" "+e.color}function _s(e,t){for(const n of t)e.board.removeChild(n)}function Ms(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}function Ns(e,t,n){e.set(t,(e.get(t)||"")+" "+n)}function js(e,t){const n=document.createElement("li-coords");return n.className=t,e.forEach(((e,t)=>{const r=document.createElement("li-coord");r.className=t%2==0?"coord-odd":"coord-even",r.textContent=String(e),n.appendChild(r)})),n}function Ds(e,t){return t.state.animation.enabled?function(e,t){const n=t.state,r=new Map(n.pieces),i=e(n),a=void 0!==t.dom?function(e,t,n){const r=n.bounds,i=r.width/8,a=r.height/8,o=new Map,s=[],c=new Map,l=[],u=[],d=new Map,h="white"===t.orientation;for(const[t,n]of e)d.set(t,Is(t,n));for(let e=0,n=_o.length;e<n;e++){const n=_o[e],r=t.pieces.get(n),i=d.get(n);r?i?qs(r,i.piece)||(l.push(i),u.push(Is(n,r))):u.push(Is(n,r)):i&&l.push(i)}for(const e of u){const t=Rs(e,l.filter((t=>qs(e.piece,t.piece))));if(t){const n=h?t.pos:e.pos,r=h?e.pos:t.pos,c=[(n[0]-r[0])*i,(r[1]-n[1])*a];o.set(e.key,[c,c]),s.push(t.key)}}for(const e of l)No(s,e.key)||c.set(e.key,e.piece);return{anims:o,captured:c}}(r,n,t.dom):void 0;if(void 0!==a&&(a.anims.size||a.captured.size)){const e=n.animation.current&&null!==n.animation.current.start;n.animation.current={start:null,duration:n.animation.duration,plan:a},e||Ht(t.applyAnim)}else t.redraw();return i}(e,t):Ls(e,t)}function Ls(e,t){const n=e(t.state);return t.redraw(),n}function Is(e,t){return{key:e,pos:Oo(e),piece:t}}function qs(e,t){return e.role===t.role&&e.color===t.color}function Rs(e,t){return t.sort(((t,n)=>jo(e.pos,t.pos)-jo(e.pos,n.pos)))[0]}function As(e,t){if(t.touches&&t.touches.length>1)return;const n=e.state;n.draggable.preventDefault&&t.preventDefault();const r=n.draggable.current;r&&r.orig&&(r.epos=Ao(t),!r.started&&jo(r.epos,r.rel)>=n.draggable.distance&&(r.started=!0,Us(e)))}function Bs(e,t){const n=e.state,r=n.draggable,i=r.current;if(!i)return;if(i.originTarget!==t.target&&!i.newPiece)return;n.draggable.preventDefault&&t.preventDefault();const a=i.over;Xo(n),Qo(n),i.started&&a?i.newPiece?Zo(n,i.orig,a,i.force):Jo(n,i.orig,a):i.started&&r.deleteOnDropOff?(n.pieces.delete(i.orig),setTimeout(n.events.change||yo,0)):i.newPiece&&n.pieces.delete(i.orig),(!i||i.orig!==i.previouslySelected||i.orig!==a&&a)&&n.selectable.enabled||ns(n),n.draggable.current=null,Ht((()=>zs(e.dom))),e.redraw()}function $s(e){const t=e.state;e.dom&&zs(e.dom),t.draggable.current&&(t.draggable.current=null,ns(t))}function Fs(e,t,n){if("object"!=typeof n)throw new Error("function getKeyAtDomPos require bounds object arg");const r="white"===e.orientation,i=Math.ceil((t[0]-n.left)/n.width*8),a=r?i:9-i,o=Math.ceil(8-(t[1]-n.top)/n.height*8),s=r?o:9-o;return a>0&&a<9&&s>0&&s<9?Eo([a,s]):null}function Us(e){const t=e.state,n=e.dom,r=t.draggable.current;r&&(r.scheduledAnimationFrame||(r.scheduledAnimationFrame=!0,requestAnimationFrame((()=>{const i=n.bounds,a="white"===t.orientation;if(r.scheduledAnimationFrame=!1,r.orig){if(t.pieces.get(r.orig)!==r.piece)return void $s(e);t.animation.current&&t.animation.current.plan.anims.get(r.orig)&&(t.animation.current=null);const o=r.element;if(r.started&&o){if(!o.cgDragging){o.cgDragging=!0,o.classList.add("dragging"),t.draggable.magnified&&o.classList.add("magnified");const e=n.elements.ghost;if(e&&r.showGhost){e.className=`ghost ${r.piece.color} ${r.piece.role}`;const n=xo(Oo(r.orig),"white"===t.orientation,i);e.style.transform=Do(t,r.piece.color,Lo(n))}}r.pos=[r.epos[0]-r.rel[0],r.epos[1]-r.rel[1]],r.over=Fs(t,r.epos,i);const e=xo(r.origPos,a,i);e[0]+=r.pos[0]+r.dec[0],e[1]+=r.pos[1]+r.dec[1],o.style.transform=Do(t,r.piece.color,Io(e));const s=n.elements.shadow;if(s){if(r.over&&r.over!==r.prevOver){const e=i.width/8,t=xo(Oo(r.over),a,i);s.style.transform=Io([t[0]-e/2,t[1]-e/2])}else r.over||(s.style.transform=Ro);r.prevOver=r.over}}Us(e)}}))))}function zs(e){e.elements.shadow&&(e.elements.shadow.style.transform=Ro),e.elements.ghost&&(e.elements.ghost.style.transform=qo)}var Ws,Hs;function Vs(e){return new DataView(Uint8Array.from(e).buffer)}function Gs(e){return Array.from(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function Ks(e){const t=[];let n,r,i=1,a=0;for(n=0;n<e.length;n++)r=e.charCodeAt(n),(r>47&&r<58||r>64&&r<71||r>96&&r<103)&&(a=a<<4^15&(r>64?r+9:r),(i^=1)&&t.push(255&a));return Vs(t)}function Ys(e){return Gs(e).map((e=>{let t=e.toString(16);return 1==t.length&&(t="0"+t),t})).join("")}function Xs(e){if("string"==typeof e)return e;if("number"==typeof e)return`0000${e.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`;throw new Error("Invalid UUID")}function Qs(e){const t={};if(e)return e.forEach(((e,n)=>{t[n.toString()]=e})),t}!function(e){e[e.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",e[e.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",e[e.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"}(Ws||(Ws={})),function(e){e[e.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",e[e.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",e[e.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"}(Hs||(Hs={}));const Js=r("BluetoothLe",{web:()=>import("./web-dee3c1eb.js").then((e=>new e.BluetoothLeWeb))});function Zs(e){return e?(()=>{let e=Promise.resolve();return t=>new Promise(((n,r)=>{e=e.then((()=>t())).then(n).catch(r)}))})():e=>e()}function ec(e){if("string"!=typeof e)throw new Error(`Invalid UUID type ${typeof e}. Expected string.`);if(!((e=e.toLowerCase()).search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${e}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return e}const tc=new class BleClientClass{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=Zs(!0)}enableQueue(){this.queue=Zs(!0)}disableQueue(){this.queue=Zs(!1)}async initialize(e){await this.queue((async()=>{await Js.initialize(e)}))}async isEnabled(){return await this.queue((async()=>(await Js.isEnabled()).value))}async requestEnable(){await this.queue((async()=>{await Js.requestEnable()}))}async enable(){await this.queue((async()=>{await Js.enable()}))}async disable(){await this.queue((async()=>{await Js.disable()}))}async startEnabledNotifications(e){await this.queue((async()=>{var t;const n="onEnabledChanged";await(null===(t=this.eventListeners.get(n))||void 0===t?void 0:t.remove());const r=await Js.addListener(n,(t=>{e(t.value)}));this.eventListeners.set(n,r),await Js.startEnabledNotifications()}))}async stopEnabledNotifications(){await this.queue((async()=>{var e;const t="onEnabledChanged";await(null===(e=this.eventListeners.get(t))||void 0===e?void 0:e.remove()),this.eventListeners.delete(t),await Js.stopEnabledNotifications()}))}async isLocationEnabled(){return await this.queue((async()=>(await Js.isLocationEnabled()).value))}async openLocationSettings(){await this.queue((async()=>{await Js.openLocationSettings()}))}async openBluetoothSettings(){await this.queue((async()=>{await Js.openBluetoothSettings()}))}async openAppSettings(){await this.queue((async()=>{await Js.openAppSettings()}))}async setDisplayStrings(e){await this.queue((async()=>{await Js.setDisplayStrings(e)}))}async requestDevice(e){e=e?this.validateRequestBleDeviceOptions(e):void 0;return await this.queue((async()=>await Js.requestDevice(e)))}async requestLEScan(e,t){e=this.validateRequestBleDeviceOptions(e),await this.queue((async()=>{var n;await(null===(n=this.scanListener)||void 0===n?void 0:n.remove()),this.scanListener=await Js.addListener("onScanResult",(e=>{const n=Object.assign(Object.assign({},e),{manufacturerData:this.convertObject(e.manufacturerData),serviceData:this.convertObject(e.serviceData),rawAdvertisement:e.rawAdvertisement?this.convertValue(e.rawAdvertisement):void 0});t(n)})),await Js.requestLEScan(e)}))}async stopLEScan(){await this.queue((async()=>{var e;await(null===(e=this.scanListener)||void 0===e?void 0:e.remove()),this.scanListener=null,await Js.stopLEScan()}))}async getDevices(e){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return this.queue((async()=>(await Js.getDevices({deviceIds:e})).devices))}async getConnectedDevices(e){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(ec),this.queue((async()=>(await Js.getConnectedDevices({services:e})).devices))}async getBondedDevices(){return this.queue((async()=>(await Js.getBondedDevices()).devices))}async connect(e,t,n){await this.queue((async()=>{var r;if(t){const n=`disconnected|${e}`;await(null===(r=this.eventListeners.get(n))||void 0===r?void 0:r.remove());const i=await Js.addListener(n,(()=>{t(e)}));this.eventListeners.set(n,i)}await Js.connect(Object.assign({deviceId:e},n))}))}async createBond(e,t){await this.queue((async()=>{await Js.createBond(Object.assign({deviceId:e},t))}))}async isBonded(e){return await this.queue((async()=>(await Js.isBonded({deviceId:e})).value))}async disconnect(e){await this.queue((async()=>{await Js.disconnect({deviceId:e})}))}async getServices(e){return await this.queue((async()=>(await Js.getServices({deviceId:e})).services))}async discoverServices(e){await this.queue((async()=>{await Js.discoverServices({deviceId:e})}))}async getMtu(e){return await this.queue((async()=>(await Js.getMtu({deviceId:e})).value))}async requestConnectionPriority(e,t){await this.queue((async()=>{await Js.requestConnectionPriority({deviceId:e,connectionPriority:t})}))}async readRssi(e){return await this.queue((async()=>{const t=await Js.readRssi({deviceId:e});return parseFloat(t.value)}))}async read(e,t,n,r){t=ec(t),n=ec(n);return await this.queue((async()=>{const i=await Js.read(Object.assign({deviceId:e,service:t,characteristic:n},r));return this.convertValue(i.value)}))}async write(e,t,r,i,a){return t=ec(t),r=ec(r),this.queue((async()=>{if(!(null==i?void 0:i.buffer))throw new Error("Invalid data.");let o=i;"web"!==n.getPlatform()&&(o=Ys(i)),await Js.write(Object.assign({deviceId:e,service:t,characteristic:r,value:o},a))}))}async writeWithoutResponse(e,t,r,i,a){t=ec(t),r=ec(r),await this.queue((async()=>{if(!(null==i?void 0:i.buffer))throw new Error("Invalid data.");let o=i;"web"!==n.getPlatform()&&(o=Ys(i)),await Js.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:r,value:o},a))}))}async readDescriptor(e,t,n,r,i){t=ec(t),n=ec(n),r=ec(r);return await this.queue((async()=>{const a=await Js.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:n,descriptor:r},i));return this.convertValue(a.value)}))}async writeDescriptor(e,t,r,i,a,o){return t=ec(t),r=ec(r),i=ec(i),this.queue((async()=>{if(!(null==a?void 0:a.buffer))throw new Error("Invalid data.");let s=a;"web"!==n.getPlatform()&&(s=Ys(a)),await Js.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:r,descriptor:i,value:s},o))}))}async startNotifications(e,t,n,r,i){t=ec(t),n=ec(n),await this.queue((async()=>{var a;const o=`notification|${e}|${t}|${n}`;await(null===(a=this.eventListeners.get(o))||void 0===a?void 0:a.remove());const s=await Js.addListener(o,(e=>{r(this.convertValue(null==e?void 0:e.value))}));this.eventListeners.set(o,s),await Js.startNotifications(Object.assign({deviceId:e,service:t,characteristic:n},i))}))}async stopNotifications(e,t,n){t=ec(t),n=ec(n),await this.queue((async()=>{var r;const i=`notification|${e}|${t}|${n}`;await(null===(r=this.eventListeners.get(i))||void 0===r?void 0:r.remove()),this.eventListeners.delete(i),await Js.stopNotifications({deviceId:e,service:t,characteristic:n})}))}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(ec)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(ec)),e}convertValue(e){return"string"==typeof e?Ks(e):void 0===e?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(void 0===e)return;const t={};for(const n of Object.keys(e))t[n]=this.convertValue(e[n]);return t}};class DummyFeatures{get getState(){return!1}get setState(){return!1}get option(){return!1}}class DummyVariants{get standard(){return!1}get chess960(){return!1}get threeCheck(){return!1}get atomic(){return!1}get kingOfTheHill(){return!1}get antiChess(){return!1}get horde(){return!1}get racingKings(){return!1}get crazyHouse(){return!1}}const nc=[][Symbol.iterator]();const rc=new class DummyProtocol{constructor(){this._features=new DummyFeatures,this._variants=new DummyVariants}init(){}features(){return this._features}variants(){return this._variants}options(){return nc}onPeripheralCommand(){}onCentralStateCreated(){}onCentralStateChanged(){}onCentralStateShifted(){}onCentralStateEnded(){}onMoveRejectedByCentral(){}onCentralGetState(){}onCentralSetState(){}onCentralOptionsReset(){}};class BaseProtocol{transitionTo(e){this.state=e,this.state.setContext(this),this.state.onEnter()}init(e){}features(){return rc.features()}variants(){return rc.variants()}options(){return rc.options()}onPeripheralCommand(e){var t;null===(t=this.state)||void 0===t||t.onPeripheralCommand(e)}onCentralStateCreated(e){var t;null===(t=this.state)||void 0===t||t.onCentralStateCreated(e)}onCentralStateChanged(){var e;null===(e=this.state)||void 0===e||e.onCentralStateChanged()}onCentralStateShifted(e){var t;null===(t=this.state)||void 0===t||t.onCentralStateShifted(e)}onCentralStateEnded(e){var t;null===(t=this.state)||void 0===t||t.onCentralStateEnded(e)}onMoveRejectedByCentral(){var e;null===(e=this.state)||void 0===e||e.onMoveRejectedByCentral()}onCentralGetState(){var e;null===(e=this.state)||void 0===e||e.onCentralGetState()}onCentralSetState(){var e;null===(e=this.state)||void 0===e||e.onCentralSetState()}onCentralOptionsReset(){var e;null===(e=this.state)||void 0===e||e.onCentralOptionsReset()}}const ic=new BaseProtocol;class BaseState{constructor(){this.context=ic}setContext(e){this.context=e}transitionTo(e){this.context.transitionTo(e)}onEnter(){}onPeripheralCommand(e){}onCentralStateCreated(e){}onCentralStateChanged(){}onCentralStateShifted(e){}onCentralStateEnded(e){}onMoveRejectedByCentral(){}onCentralGetState(){}onCentralSetState(){}onCentralOptionsReset(){}}const ac={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k",unsupport:"p"},oc={P:"pawn",B:"bishop",N:"knight",R:"rook",Q:"queen",K:"king",M:"unsupport",D:"unsupport",p:"pawn",b:"bishop",n:"knight",r:"rook",q:"queen",k:"king",m:"unsupport",d:"unsupport"},sc={P:"pawn",N:"knight",B:"bishop",R:"rook",Q:"queen"},cc={e1a1:"e1c1",e1h1:"e1g1",e8a8:"e8c8",e8h8:"e8g8"};function lc(e){return[e.substr(0,2),e.substr(2,2)]}function uc(e){return"@"===e[1]?[e.substr(2,2),e.substr(2,2)]:[e.substr(0,2),e.substr(2,2)]}function dc(e){const t=e.substr(4,1);return oc[t]}function hc(e){return e.substr(2,2)}function pc(e){return oc[e.substr(0,1)]}function mc(e){return[e.substr(2,2),e.substr(2,2)]}function fc(e){return"P"===e[0]?e.slice(1):e}function gc(e){return[e.slice(0,2),e.slice(2,4),e.slice(4,5)]}function vc(e){if(void 0===e)return null;if(function(e){return m(e)}(e))return e;const t={};return e&&function(e){return"string"==typeof e}(e)&&e.split(" ").forEach((e=>{t[bc[e[0]]]=e.split("").slice(1).map((e=>bc[e]))})),t}const bc={a:"a1",b:"b1",c:"c1",d:"d1",e:"e1",f:"f1",g:"g1",h:"h1",i:"a2",j:"b2",k:"c2",l:"d2",m:"e2",n:"f2",o:"g2",p:"h2",q:"a3",r:"b3",s:"c3",t:"d3",u:"e3",v:"f3",w:"g3",x:"h3",y:"a4",z:"b4",A:"c4",B:"d4",C:"e4",D:"f4",E:"g4",F:"h4",G:"a5",H:"b5",I:"c5",J:"d5",K:"e5",L:"f5",M:"g5",N:"h5",O:"a6",P:"b6",Q:"c6",R:"d6",S:"e6",T:"f6",U:"g6",V:"h6",W:"a7",X:"b7",Y:"c7",Z:"d7",0:"e7",1:"f7",2:"g7",3:"h7",4:"a8",5:"b8",6:"c8",7:"d8",8:"e8",9:"f8","!":"g8","?":"h8"};function wc(e){return"white"===e.turnColor?"w":"b"}function yc(e){return[ms.convertPiecesToFen(e.pieces),wc(e)].join(" ")}function kc(e,t){e.peripheral.isMoveRejected=t}function Sc(e,t){e.peripheral.isSynchronized=t}function Cc(e,t){e.peripheral.isGettable=t}function Tc(e,t){e.peripheral.isSettable=t}function Pc(e,t){e.peripheral.pieces=ms.convertFenToPeripheralPieces(t)}function Ec(e){return t=e.lastMove[0],n=e.lastMove[1],(r=e.lastPromotion?e.lastPromotion:void 0)?t+n+ac[r]:t+n;var t,n,r}function Oc(e){zc.sendCommandToPeripheral(e)}function xc(){Vc.sendStateChangeToCentral()}function _c(){Vc.sendOptionsUpdateToCentral()}function Mc(e){return e.substring(e.indexOf(" ")+1)}function*Nc(e){for(const t of Object.keys(e))yield e[t]}var jc,Dc,Lc,Ic,qc,Rc,Ac,Bc;!function(e){e.LastMove="last_move",e.Check="check",e.Msg="msg",e.UndoRedo="undo_redo",e.Side="side",e.GetState="get_state",e.SetState="set_state",e.Option="option"}(jc||(jc={})),function(e){e.Standard="standard",e.Chess960="chess_960",e.ThreeCheck="3_check",e.Atomic="atomic",e.KingOfTheHill="king_of_the_hill",e.AntiChess="anti_chess",e.Horde="horde",e.RacingKings="racing_kings",e.CrazyHouse="crazy_house"}(Dc||(Dc={})),function(e){e.Ok="ok",e.Nok="nok",e.Feature="feature",e.Variant="variant",e.SetVariant="set_variant",e.Begin="begin",e.State="state",e.Sync="sync",e.Unsync="unsync",e.UnsyncSettable="unsync_settable",e.End="end",e.Move="move",e.Promote="promote",e.Err="err",e.LastMove="last_move",e.Check="check",e.Msg="msg",e.Undo="undo",e.Redo="redo",e.Side="side",e.GetState="get_state",e.SetState="set_state",e.OptionsBegin="options_begin",e.OptionsEnd="options_end",e.OptionsReset="options_reset",e.Option="option",e.SetOption="set_option"}(Lc||(Lc={})),function(e){e.Undefined="undefined",e.Checkmate="checkmate",e.Draw="draw",e.Timeout="timeout",e.Resign="resign",e.Abort="abort"}(Ic||(Ic={})),function(e){e.White="w",e.Black="b",e.Both="?"}(qc||(qc={})),function(e){e.Bool="bool",e.Enum="enum",e.Str="str",e.Int="int",e.Float="float"}(Rc||(Rc={})),function(e){e.True="true",e.False="false"}(Ac||(Ac={}));class Support{constructor(e){this.name=e,this.isSupported=!1}}class CppFeatures{constructor(){this.lastMove=new Support(jc.LastMove),this.check=new Support(jc.Check),this.msg=new Support(jc.Msg),this.undoRedo=new Support(jc.UndoRedo),this.side=new Support(jc.Side),this.getState=new Support(jc.GetState),this.setState=new Support(jc.SetState),this.option=new Support(jc.Option)}}class CppWrappedFeatures{constructor(e){this._features=e}get getState(){return this._features.getState.isSupported}get setState(){return this._features.setState.isSupported}get option(){return this._features.option.isSupported}}class CppVariants{constructor(){this.standard=new Support(Dc.Standard),this.chess960=new Support(Dc.Chess960),this.threeCheck=new Support(Dc.ThreeCheck),this.atomic=new Support(Dc.Atomic),this.kingOfTheHill=new Support(Dc.KingOfTheHill),this.antiChess=new Support(Dc.AntiChess),this.horde=new Support(Dc.Horde),this.racingKings=new Support(Dc.RacingKings),this.crazyHouse=new Support(Dc.CrazyHouse)}}class CppWrappedVariants{constructor(e){this._variants=e}get standard(){return this._variants.standard.isSupported}get chess960(){return this._variants.chess960.isSupported}get threeCheck(){return this._variants.threeCheck.isSupported}get atomic(){return this._variants.atomic.isSupported}get kingOfTheHill(){return this._variants.kingOfTheHill.isSupported}get antiChess(){return this._variants.antiChess.isSupported}get horde(){return this._variants.horde.isSupported}get racingKings(){return this._variants.racingKings.isSupported}get crazyHouse(){return this._variants.crazyHouse.isSupported}}!function(e){e[e.Bool=0]="Bool",e[e.Enum=1]="Enum",e[e.Str=2]="Str",e[e.Int=3]="Int",e[e.Float=4]="Float"}(Bc||(Bc={}));class TimerWrapper{start(e,t){this.stop(),this._handle=setTimeout((()=>{this._handle=void 0,e()}),t)}stop(){void 0!==this._handle&&(clearTimeout(this._handle),this._handle=void 0)}isActive(){return void 0!==this._handle}}class CppTypedOption{constructor(e,t){this._name=e,this._value=t,this._defaultValue=t,this._timer=new TimerWrapper,this._isHandled=!1}get name(){return this._name}get value(){return this._value}set value(e){this._value=e,this._timer.isActive()?this._isHandled=!1:this._handleValue()}set peripheralValue(e){this._value=e,this._timer.stop()}reset(){this._value=this._defaultValue,this._timer.stop()}_handleValue(){this._isHandled=!0,this._timer.start((()=>this._handleTimeout()),100),Oc(`${Lc.SetOption} ${this._name} ${this.valueString}`)}_handleTimeout(){this._isHandled||this._handleValue()}}class CppBoolOption extends CppTypedOption{constructor(e,t){super(e,t)}get valueString(){return this._value?Ac.True:Ac.False}get type(){return Bc.Bool}}class CppEnumOption extends CppTypedOption{constructor(e,t,n){super(e,t),this._values=n}get valueString(){return this._value}get type(){return Bc.Enum}get values(){return this._values}}class CppStrOption extends CppTypedOption{constructor(e,t){super(e,t)}get valueString(){return this._value}get type(){return Bc.Str}}class CppNumOption extends CppTypedOption{constructor(e,t,n,r,i){super(e,t),this._min=n,this._max=r,this._step=i}get min(){return this._min}get max(){return this._max}get step(){return this._step}}class CppIntOption extends CppNumOption{constructor(e,t,n,r,i){super(e,t,n,r,i)}get valueString(){return this._value.toString()}get type(){return Bc.Int}}class CppFloatOption extends CppNumOption{constructor(e,t,n,r,i){super(e,t,n,r,i)}get valueString(){return this._value.toFixed(2)}get type(){return Bc.Float}}class CppOptions{constructor(){this._map=new Map}get iterator(){return this._map.values()}add(e){try{const t=e.split(" "),n=t[0],r=t[1];return r===Rc.Bool?this._add(new CppBoolOption(n,t[2]===Ac.True)):r===Rc.Enum?this._add(new CppEnumOption(n,t[2],t.slice(3))):r===Rc.Str?this._add(new CppStrOption(n,t.slice(2).join(" "))):r===Rc.Int?this._add(new CppIntOption(n,parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),t.length>5?parseInt(t[5],10):void 0)):r===Rc.Float&&this._add(new CppFloatOption(n,parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4]),t.length>5?parseFloat(t[5]):void 0)),!0}catch(e){return!1}}set(e){try{const t=e.split(" "),n=t[0],r=t[1],i=this._map.get(n);return i instanceof CppBoolOption?i.peripheralValue=r===Ac.True:i instanceof CppEnumOption?i.peripheralValue=r:i instanceof CppStrOption?i.peripheralValue=t.slice(1).join(" "):i instanceof CppIntOption?i.peripheralValue=parseInt(r,10):i instanceof CppFloatOption&&(i.peripheralValue=parseFloat(r)),!0}catch(e){return!1}}reset(){this._map.forEach((e=>{e.reset()}))}_add(e){this._map.set(e.name,e)}}class BleChessState extends BaseState{setState(e){this.context._roundState=e}getState(){return this.context._roundState}getFeatures(){return this.context._features}getVariants(){return this.context._variants}getOptions(){return this.context._options}getVariant(e){return this.context._variantsMap[e]||this.context._variants.standard}getEndReason(e){return(null==e?void 0:e.name)&&this.context._endReasonsMap[e.name]}onPeripheralCommand(e){e.startsWith(Lc.Msg)||e.startsWith(Lc.Err)?z.show({text:Mc(e)}):e.startsWith(Lc.SetOption)?(this.getOptions().set(Mc(e))||z.show({text:`${yt("unexpected")}: ${e}`}),_c()):e.startsWith(Lc.OptionsReset)?(this.getOptions().reset(),_c()):z.show({text:`${yt("unexpected")}: ${this.constructor.name}: ${e}`})}onCentralStateCreated(e){this.setState(e)}onCentralOptionsReset(){this.getOptions().reset(),Oc(Lc.OptionsReset)}}class Init extends BleChessState{onEnter(){const e=new CheckSupportsIteration(Nc(this.getVariants()),Lc.Variant,new CheckOptions),t=new CheckSupportsIteration(Nc(this.getFeatures()),Lc.Feature,e);this.transitionTo(t)}}class CheckSupportsIteration extends BleChessState{constructor(e,t,n){super(),this.iterator=e,this.current=e.next(),this.command=t,this.nextState=n}onEnter(){this.handleCurrent()}onPeripheralCommand(e){e===Lc.Ok?(this.current.value.isSupported=!0,this.current=this.iterator.next(),this.handleCurrent()):e===Lc.Nok?(this.current.value.isSupported=!1,this.current=this.iterator.next(),this.handleCurrent()):super.onPeripheralCommand(e)}handleCurrent(){this.current.done?this.transitionTo(this.nextState):Oc(`${this.command} ${this.current.value.name}`)}}class CheckOptions extends BleChessState{onEnter(){this.getFeatures().option.isSupported?Oc(Lc.OptionsBegin):this.transitionTo(new Initialized)}onPeripheralCommand(e){e.startsWith(Lc.OptionsEnd)?(this.transitionTo(new Initialized),_c()):e.startsWith(Lc.Option)?this.getOptions().add(Mc(e))||z.show({text:`${yt("unexpected")}: ${e}`}):e.startsWith(Lc.SetOption)?this.getOptions().set(Mc(e))||z.show({text:`${yt("unexpected")}: ${e}`}):super.onPeripheralCommand(e)}}class Initialized extends BleChessState{onEnter(){const e=0!==this.getState().pieces.size;this.transitionTo(e?new RoundBegin:new Idle)}}class Idle extends BleChessState{onCentralStateCreated(e){this.setState(e),this.transitionTo(new RoundBegin)}onCentralGetState(){this.transitionTo(new GetState)}}class GetState extends Idle{onEnter(){Oc(`${Lc.GetState}`),Cc(this.getState(),!1),xc()}onPeripheralCommand(e){if(e.startsWith(Lc.State)){const t=this.getState();Pc(t,Mc(e)),Cc(t,function(e){const t=e.peripheral.pieces;for(const e of t.values())if(void 0===e.role||void 0===e.color)return!1;return!0}(t)),xc()}else super.onPeripheralCommand(e)}}class Round extends Idle{onCentralStateShifted(e){const t=this.getState();if(kc(t,!1),!this.getFeatures().undoRedo.isSupported)return this.transitionTo(new Idle),Oc(`${Lc.End} ${Ic.Abort}`),void z.show({text:yt("shiftUnsupported")});Oc(`${"undo"==e?Lc.Undo:Lc.Redo} ${yc(t)}`),this.getFeatures().lastMove.isSupported&&t.lastMove&&Oc(`${Lc.LastMove} ${Ec(t)}`),this.getFeatures().check.isSupported&&t.check&&Oc(`${Lc.Check} ${t.check}`)}onCentralStateEnded(e){const t=this.getEndReason(e);t&&(this.transitionTo(new Idle),Oc(`${Lc.End} ${t}`))}onCentralSetState(){Oc(`${Lc.SetState}`),Tc(this.getState(),!1),xc()}onPeripheralCommand(e){if(e.startsWith(Lc.State)){const t=this.getState();Pc(t,Mc(e)),kc(t,!1),xc()}else if(e.startsWith(Lc.Sync)){const t=this.getState();Pc(t,Mc(e)),Sc(t,!0),Tc(t,!1),kc(t,!1),xc(),z.show({text:yt("synchronized")})}else if(e.startsWith(Lc.UnsyncSettable)){const t=this.getState(),n=t.peripheral.isSynchronized;Pc(t,Mc(e)),Sc(t,!1),Tc(t,!0),kc(t,!1),xc(),n&&z.show({text:yt("unsynchronized")})}else if(e.startsWith(Lc.Unsync)){const t=this.getState(),n=t.peripheral.isSynchronized;Pc(t,Mc(e)),Sc(t,!1),Tc(t,!1),kc(t,!1),xc(),n&&z.show({text:yt("unsynchronized")})}else super.onPeripheralCommand(e)}}class RoundBegin extends Round{onEnter(){const e=this.getState(),t=this.getVariant(e.variant);var n,r;if(Oc(`${Lc.SetVariant} ${t.name}`),n=e,r=t.isSupported,n.peripheral.isVariantSupported=r,!t.isSupported)return this.transitionTo(new Idle),void z.show({text:yt("variantUnsupported")});if(this.transitionTo(new RoundOngoing),this.getFeatures().side.isSupported){const t=e.otb?qc.Both:"white"===e.orientation?qc.White:qc.Black;Oc(`${Lc.Side} ${t}`)}Oc(`${Lc.Begin} ${yc(e)}`),this.getFeatures().lastMove.isSupported&&e.lastMove&&Oc(`${Lc.LastMove} ${Ec(e)}`),this.getFeatures().check.isSupported&&e.check&&Oc(`${Lc.Check} ${e.check}`)}}class RoundOngoing extends Round{onCentralStateChanged(){const e=this.getState();Oc(`${Lc.Move} ${Ec(e)}`),this.getFeatures().check.isSupported&&e.check&&Oc(`${Lc.Check} ${e.check}`),kc(e,!1),xc()}onPeripheralCommand(e){if(e.startsWith(Lc.Move)){const t=this.getState(),n=Mc(e);kc(t,!1),function(e,t){const n=lc(t),r=dc(t);e.peripheral.lastMove=n,e.peripheral.lastPromotion=r||null}(t,n),this.transitionTo(new CheckPeripheralMove),function(e){const t=lc(e),n=dc(e);Vc.sendMoveToCentral(t[0],t[1],n)}(n)}else super.onPeripheralCommand(e)}}class CheckPeripheralMove extends Round{onCentralStateChanged(){const e=this.getState();this.transitionTo(new RoundOngoing),e.lastPromotion&&!e.peripheral.lastPromotion?Oc(`${Lc.Promote} ${Ec(e)}`):Oc(Lc.Ok),this.getFeatures().check.isSupported&&e.check&&Oc(`${Lc.Check} ${e.check}`)}onMoveRejectedByCentral(){const e=this.getState();this.transitionTo(new RoundOngoing),Oc(Lc.Nok),kc(e,!0),xc(),z.show({text:yt("rejected")})}}const $c=[{uuids:{srv:"f5351050-b2c9-11ec-a0c0-b3bc53b08d33",txCh:"f53513ca-b2c9-11ec-a0c1-639b8957db99",rxCh:"f535147e-b2c9-11ec-a0c2-8bbd706ec4e6"},protocol:class CppProtocol extends BaseProtocol{constructor(){super(...arguments),this._roundState=ds(),this._features=new CppFeatures,this._wrappedFeatures=new CppWrappedFeatures(this._features),this._variants=new CppVariants,this._wrappedVariants=new CppWrappedVariants(this._variants),this._variantsMap={standard:this._variants.standard,chess960:this._variants.chess960,antichess:this._variants.antiChess,kingOfTheHill:this._variants.kingOfTheHill,threeCheck:this._variants.threeCheck,atomic:this._variants.atomic,horde:this._variants.horde,racingKings:this._variants.racingKings,crazyhouse:this._variants.crazyHouse},this._endReasonsMap={mate:Ic.Checkmate,stalemate:Ic.Draw,draw:Ic.Draw,timeout:Ic.Timeout,outoftime:Ic.Timeout,resign:Ic.Resign,aborted:Ic.Abort,noStart:Ic.Undefined,unknownFinish:Ic.Undefined,cheat:Ic.Undefined,variantEnd:Ic.Undefined},this._options=new CppOptions}init(e){this._roundState=e,this.transitionTo(new Init)}features(){return this._wrappedFeatures}variants(){return this._wrappedVariants}options(){return this._options.iterator}}}],Fc={uuids:{srv:"0000180f-0000-1000-8000-00805f9b34fb",levelCh:"00002a19-0000-1000-8000-00805f9b34fb"},level:void 0};const Uc=new class BluetoothConnection{constructor(){this.isConnected=!1,this.protocol=rc,this.centralState=ds(),this.lastMove=null,this.batteryService=Fc}getDeviceId(){return lt.general.bluetooth.deviceId()}async onDisconnect(e){this.isConnected&&(this.isConnected=!1,this.protocol=rc,this.batteryService.level=void 0,Kt(),z.show({text:yt("disconnectedFromBluetoothDevice")}),lt.general.bluetooth.useDevice()&&this.connect())}async requestDevice(){return await tc.requestDevice({services:$c.map((e=>e.uuids.srv))})}async setupChessService(){const e=await tc.getServices(this.getDeviceId());for(const t of $c)if(e.some((e=>t.uuids.srv===e.uuid)))return this.uuids=t.uuids,void(this.protocol=new t.protocol)}async setupBatteryService(){if((await tc.getServices(this.getDeviceId())).some((e=>this.batteryService.uuids.srv===e.uuid))){const e=await tc.read(this.getDeviceId(),this.batteryService.uuids.srv,this.batteryService.uuids.levelCh);this.batteryService.level=e.getUint8(0),await this.registerBatteryCallback()}}async connect(){await tc.connect(this.getDeviceId(),(e=>this.onDisconnect(e))),await this.setupChessService(),await this.registerChessCallback(),await this.setupBatteryService(),this.protocol.init(this.centralState),this.isConnected=!0,Kt(),z.show({text:yt("connectedToBluetoothDevice")})}async disconnect(){this.isConnected&&(await this.unregisterChessCallback(),await this.unregisterBatteryCallback(),await tc.disconnect(this.getDeviceId()))}async sendCommandToPeripheral(e){var t;await tc.write(this.getDeviceId(),this.uuids.srv,this.uuids.txCh,(t=e,Vs(t.split("").map((e=>e.charCodeAt(0))))))}async reciveData(e){var t;this.protocol.onPeripheralCommand((t=e,String.fromCharCode(...Gs(t))))}async registerChessCallback(){await tc.startNotifications(this.getDeviceId(),this.uuids.srv,this.uuids.rxCh,(e=>this.reciveData(e)))}async unregisterChessCallback(){await tc.stopNotifications(this.getDeviceId(),this.uuids.srv,this.uuids.rxCh)}async registerBatteryCallback(){await tc.startNotifications(this.getDeviceId(),this.batteryService.uuids.srv,this.batteryService.uuids.levelCh,(e=>{this.batteryService.level=e.getUint8(0),Kt()}))}async unregisterBatteryCallback(){void 0!==this.batteryService.level&&await tc.stopNotifications(this.getDeviceId(),this.batteryService.uuids.srv,this.batteryService.uuids.levelCh)}};var zc={protocol:()=>Uc.protocol,saveCentralState(e){Uc.centralState=e,this.saveLastMove()},saveLastMove(){Uc.lastMove=Uc.centralState.lastMove},isRepeatedLastMove:()=>Uc.lastMove===Uc.centralState.lastMove,sendCommandToPeripheral(e){Uc.sendCommandToPeripheral(e)},state:()=>Uc.centralState,features:()=>Uc.protocol.features(),variants:()=>Uc.protocol.variants(),options:()=>Uc.protocol.options(),isConnected:()=>Uc.isConnected,batteryLevel:()=>Uc.batteryService.level,init(){lt.general.bluetooth.useDevice()&&(tc.initialize({androidNeverForLocation:!0}),Uc.connect())},onSettingChange(e){e?(tc.initialize({androidNeverForLocation:!0}),Uc.requestDevice().then((e=>{lt.general.bluetooth.deviceId(e.deviceId),Uc.connect()})).catch((()=>{lt.general.bluetooth.useDevice(!1),Kt()}))):Uc.disconnect()},updateSettings(){Kt()}};let Wc,Hc;var Vc={onCentralStateCreated(e){zc.protocol().onCentralStateCreated(e),zc.saveCentralState(e)},onCentralStateChanged(){zc.isRepeatedLastMove()||(zc.state().shiftView?zc.state().shiftView=null:(zc.state().shift?(zc.protocol().onCentralStateShifted(zc.state().shift),zc.state().shift=null):zc.protocol().onCentralStateChanged(),zc.saveLastMove()))},onCentralStateEnded(e){zc.protocol().onCentralStateEnded(e)},onMoveRejectedByCentral(){zc.protocol().onMoveRejectedByCentral()},onCentralGetState(){zc.protocol().onCentralGetState()},onCentralSetState(){zc.protocol().onCentralSetState()},sendMoveToCentral(e,t,n){null==Wc||Wc(e,t,n)},sendStateChangeToCentral(){null==Hc||Hc(),(this.features().getState||this.features().setState)&&Kt()},sendOptionsUpdateToCentral(){zc.updateSettings()},state:()=>zc.state(),features:()=>zc.features(),variants:()=>zc.variants(),options:()=>zc.options(),subscribe(e,t){Wc=e,Hc=t},unsubscribe(){Wc=void 0,Hc=void 0},isConnected:()=>zc.isConnected(),batteryLevel:()=>zc.batteryLevel()};const Gc={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0};class Chessground{constructor(e){this.detach=()=>{this.dom=void 0,window.removeEventListener("resize",this.onOrientationChange)},this.applyAnim=e=>{const t=this.state,n=t.animation.current;if(null===n)return void this.redrawSync();null===n.start&&(n.start=e);const r=1-(e-n.start)/n.duration;if(r<=0)t.animation.current=null,this.redrawSync();else{const e=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}(r);for(const t of n.plan.anims.values())t[1]=[Po(t[0][0]*e,10),Po(t[0][1]*e,10)];this.redrawSync(),Ht(this.applyAnim)}},this.setBounds=e=>{this.dom&&(this.dom.bounds=e)},this.redrawSync=()=>{this.dom&&ys(this.state,this.dom)},this.redraw=()=>{Ht(this.redrawSync)},this.getFen=()=>ms.convertPiecesToFen(this.state.pieces),this.toggleOrientation=()=>{Ds(Go,this)},this.externalMove=(e,t,n)=>{Ds((r=>Jo(r,e,t,n)),this)||Vc.onMoveRejectedByCentral()},this.playPremove=()=>{if(this.state.premovable.current){if(Boolean(Ds(os,this)))return!0;this.redraw()}return!1},this.playPredrop=e=>{if(this.state.predroppable.current){const t=function(e,t){const n=e.predroppable.current;if(!n)return!1;let r=!1;t(n)&&ls(e,{role:n.role,color:e.movable.color},n.key)&&(wo(e.movable.events.afterNewPiece,n.role,n.key,{predrop:!0}),r=!0);return Qo(e),r}(this.state,e);return this.redraw(),t}return!1},this.cancelPremove=()=>{Ls(Xo,this)},this.cancelPredrop=()=>{Ls(Qo,this)},this.setCheck=e=>{Ls((t=>Yo(t,e)),this)},this.cancelMove=()=>{$s(this),Ls((e=>ss(e)),this)},this.stop=e=>{$s(this),Ls((e=>function(e){e.movable.color=null,e.movable.dests={},ss(e)}(e)),this),Vc.onCentralStateEnded(e)},this.explode=e=>{this.dom&&(this.state.exploding={stage:1,keys:e},this.redraw(),setTimeout((()=>{this.state.exploding&&(this.state.exploding.stage=2,this.redraw()),setTimeout((()=>{this.state.exploding=null,this.redraw()}),120)}),120))},this.onOrientationChange=()=>{const e=this.dom;e&&requestAnimationFrame((()=>{e.bounds=e.board.getBoundingClientRect(),this.redraw()}))},this.state=function(e){const t=ds();return fs(t,e||{}),t}(e)}attach(e,t){const n=this.state.fixed||this.state.viewOnly,r=this.state.edit,i=document.createElement("div");if(i.className="cg-board",i.className+=n?" view-only":" manipulable",e.appendChild(i),this.dom={board:i,elements:{},bounds:t},this.redrawSync(),!n){const t=document.createElement("div");t.className="cg-square-target",t.style.transform=Ro,e.appendChild(t),this.dom.elements.shadow=t}if(!n&&this.state.draggable.showGhost){const t=document.createElement("piece");t.className="ghost",t.style.transform=qo,e.appendChild(t),this.dom.elements.ghost=t}this.state.coordinates&&(function(e,t){const n=document.createDocumentFragment();n.appendChild(js(Co,"ranks")),n.appendChild(js(ko,"files"+(t?" withSymm":""))),e.appendChild(n)}(e,!!this.state.symmetricCoordinates),this.state.symmetricCoordinates&&function(e){const t=document.createDocumentFragment();t.appendChild(js(To,"ranks symm")),t.appendChild(js(So,"files symm")),e.appendChild(t)}(e)),n||(i.addEventListener("touchstart",(e=>function(e,t){if(!t.isTrusted||t.touches&&t.touches.length>1)return;t.preventDefault();const n=e.state,r=e.dom,i=r.bounds,a=Ao(t),o=Fs(n,a,i);if(!o)return;const s=n.selected,c=!!n.premovable.current,l=!!n.predroppable.current;n.selected&&is(n,n.selected,o)?Ds((e=>es(e,o)),e):es(n,o);const u=n.selected===o,d=n.pieces.get(o);if(d&&u&&function(e,t){const n=e.pieces.get(t);return!!n&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}(n,o)){const c=Bo(n.orientation,i,o),l=Oo(o);n.draggable.current={previouslySelected:s,orig:o,piece:d,rel:a,epos:a,pos:[0,0],origPos:l,dec:n.draggable.magnified?[a[0]-(c.left+c.width),a[1]-(c.top+2*c.height)]:[a[0]-(c.left+c.width/2),a[1]-(c.top+c.height/2)],started:!1===n.selectable.enabled,over:o,prevOver:null,element:$o(r,o),originTarget:t.target,showGhost:n.draggable.showGhost,scheduledAnimationFrame:!1},n.draggable.magnified&&n.draggable.centerPiece&&(n.draggable.current.dec[1]=a[1]-(c.top+c.height)),n.draggable.current.started&&Us(e)}else c&&Xo(n),l&&Qo(n);e.redraw()}(this,e))),i.addEventListener("touchmove",(e=>As(this,e))),i.addEventListener("touchend",(e=>Bs(this,e))),i.addEventListener("touchcancel",(()=>$s(this)))),n||(Vc.subscribe(this.externalMove,this.redraw),r?Vc.features().getState&&Vc.onCentralGetState():Vc.onCentralStateCreated(this.state)),window.addEventListener("resize",this.onOrientationChange)}getMaterialDiff(){let e=0;const t={king:0,queen:0,rook:0,bishop:0,knight:0,pawn:0};for(const n of this.state.pieces.values())t[n.role]+="white"===n.color?1:-1,e+=Gc[n.role]*("white"===n.color?1:-1);const n={white:{pieces:{},score:e},black:{pieces:{},score:-e}};for(const e in t){const r=t[e];r>0?n.white.pieces[e]=r:r<0&&(n.black.pieces[e]=-r)}return n}set(e){Ds((t=>gs(t,e)),this),Vc.onCentralStateChanged()}reconfigure(e){Ds((t=>fs(t,e)),this),Vc.onCentralStateCreated(this.state)}setOtbMode(e){Ds((t=>{t.otbMode=e}),this)}setPieces(e){Ds((t=>Ko(t,e)),this)}setLastPromotion(e){this.state.lastPromotion=e||null}promote(e,t){const n=new Map,r=this.state.pieces.get(e);r&&"pawn"===r.role&&(n.set(e,{color:r.color,role:t}),this.setPieces(n))}dragNewPiece(e,t,n=!1){!function(e,t,n,r){const i="a0",a=e.state,o=e.dom;a.pieces.set(i,t),e.redrawSync();const s=Ao(n),c="white"===a.orientation,l=o.bounds,u=Bo(a.orientation,l,i),d=[(c?0:7)*u.width+l.left,(c?8:-1)*u.height+l.top];a.draggable.current={orig:i,origPos:Oo(i),piece:t,rel:d,epos:s,pos:[s[0]-d[0],s[1]-d[1]],dec:a.draggable.magnified?[-u.width,2*-u.height]:[-u.width/2,-u.height/2],over:null,prevOver:null,started:!0,element:$o(o,i),originTarget:n.target,previouslySelected:null,newPiece:!0,force:r||!1,showGhost:!1},Us(e)}(this,t,e,n)}selectSquare(e){e?Ds((t=>es(t,e)),this):this.state.selected&&(ns(this.state),this.redraw())}apiMove(e,t,n,r){Ds((i=>{!function(e,t,n){cs(e,t,n)}(i,e,t),n&&Ko(i,n),r&&(gs(i,r),Vc.onCentralStateChanged())}),this)}apiNewPiece(e,t,n){Ds((r=>{!function(e,t,n){ls(e,t,n)}(r,e,t),n&&gs(r,n)}),this)}}const Kc={oninit({attrs:e}){this.pieceTheme=lt.general.theme.piece(),this.boardTheme=lt.general.theme.board(),this.ground=new Chessground(function({fen:e,lastMove:t,orientation:n,fixed:r=!0}){return{batchRAF:Ht,viewOnly:!0,fixed:r,minimalDom:!0,coordinates:!1,fen:e,lastMove:t?lc(t):null,orientation:n||"white"}}(e))},oncreate({attrs:e,dom:t}){const n=e.fixed?{top:0,bottom:0,left:0,right:0,height:0,width:0}:t.getBoundingClientRect();void 0!==e.delay?setTimeout((()=>{this.ground.attach(t,n)}),e.delay):this.ground.attach(t,n)},onbeforeupdate:({attrs:e},{attrs:t})=>e.fen!==t.fen||e.lastMove!==t.lastMove||e.orientation!==t.orientation,onupdate({attrs:e}){this.ground.set(Object.assign(Object.assign({},e),{lastMove:e.lastMove?lc(e.lastMove):void 0}))},onremove(){this.ground.detach()},view({attrs:e}){const t=["display_board",e.customPieceTheme||this.pieceTheme,`board-${this.boardTheme}`,e.variant||"standard"].join(" ");return An("div",{className:t})}};let Yc,Xc=null,Qc=!1;var Jc={lastJoined:()=>Yc,resetLastJoined(){Yc=void 0},open:function(e){bi.backbutton.stack.push(il),Yr.refresh(),Qc=!0,setTimeout((()=>{Xc&&!Ki()&&Xc.goTo(void 0!==e?e:0)}),500)},close:il,view:()=>Qc?An("div#games_menu.overlay_popup_wrapper",{onbeforeremove:el},An.fragment({key:Yi()?"portrait":"landscape"},[An("div.wrapper_overlay_close",{oncreate:Zc}),ul(),An("div#wrapper_games",hl())])):null};const Zc=Ui((()=>il()));function el({dom:e}){return e.classList.add("fading_out"),new Promise((e=>{setTimeout(e,500)}))}let tl;function nl({dom:e}){Yi()&&(Xc=new Siema({selector:e,duration:250,loop:!1,perPage:Ki()?2:1,startIndex:0,threshold:50,draggable:!0,onChange:()=>{clearTimeout(tl),tl=setTimeout((()=>{Ht(dl)}),300)}}),Ht(dl),Kt())}function rl(){Xc&&(Xc.destroy(),Xc=null)}function il(e){"backbutton"!==e&&Qc&&bi.backbutton.stack.pop(),Qc=!1}function al(e,t,n,r){return An("div.boardWrapper",An(Kc,{fen:e,lastMove:n,orientation:t,variant:r}))}function ol(e){return e.isMyTurn?e.secondsLeft?An("time",{},Ot(Ge(new Date,e.secondsLeft))):yt("yourTurn"):yt("waitingForOpponent")}function sl(e){const t=e.opponent.ai?"n":cn(e.perf),n=lo(e.opponent,!1),r=["card","standard",e.color].join(" "),i=["timeIndication",e.isMyTurn?"myTurn":"opponentTurn"].join(" ");return An("div",{className:r,key:"game."+e.gameId,oncreate:Hi((()=>function(e){Yc=e,so.set(e.fullId,{fen:e.fen,orientation:e.color}),il(),bi.set("/game/"+e.fullId)}(e)))},[al(e.fen,e.color,e.lastMove,e.variant.key),An("div.infos",[An("div.icon-game",{"data-icon":t||""}),An("div.description",[An("h2.title",n),An("p",[An("span.variant",e.variant.name),An("span",{className:i},ol(e))])])])])}function cl(e){if(!e.challenger)return null;const t=e.rated?yt("rated"):yt("casual"),n=e.challenger.provisional?"?":"",r=`${e.challenger.id} (${e.challenger.rating}${n})`;return An("div.card.standard.challenge",{key:"incoming."+e.id},[al(e.initialFen||ho,"white",void 0,e.variant.key),An("div.infos",[An("div.icon-game",{"data-icon":cn(e.speed)}),An("div.description",[An("h2.title",yt("playerisInvitingYou",r)),An("p.variant",[An("span.time-indication[data-icon=p]",jr.challengeTime(e))," • ",An("span.variantName",e.variant.name)," • ",An("span",t)])]),An("div.actions",[An("button",{oncreate:zi((()=>{return vr(t=e.id).then((e=>{bi.set("/game"+e.url.round)})).then((()=>jr.remove(t))).then((()=>il()));var t}))},yt("accept")),An("button",{oncreate:zi((t=>{return(n=e.id,gr(n).then((()=>{jr.remove(n)}))).then((()=>{Bi(t,(()=>il()),".card",250)}));var n}))},yt("decline"))])])])}function ll(e){const t=e.rated?yt("rated"):yt("casual");return An("div.card.standard.challenge.sending",{key:"sending."+e.id},[al(e.initialFen||ho,"white",void 0,e.variant.key),An("div.infos",[An("div.icon-game",{"data-icon":cn(e.speed)}),An("div.description",[An("h2.title",e.destUser?function(e){const t=e.provisional?"?":"";return`${e.id} (${e.rating}${t})`}(e.destUser):"Open challenge"),An("p.variant",[An("span.time-indication[data-icon=p]",jr.challengeTime(e))," • ",An("span.variantName",e.variant.name)," • ",An("span",t)])]),An("div.actions",[e.destUser?null:An("button",{oncreate:zi((()=>{il(),bi.set(`/game/${e.id}`)}))},yt("viewInFullSize")),An("button",{oncreate:zi((t=>{return(n=e.id,fr(n).then((()=>{jr.remove(n)}))).then((()=>{Bi(t,(()=>il()),".card",250)}));var n}))},yt("cancel"))])])])}function ul(){return Yi()?An("div.#games_menu__dots"):null}function dl(){if(Yi()&&Xc){const e=Ki()?Math.ceil(Xc.innerElements.length/2):Xc.innerElements.length,t=document.getElementById("games_menu__dots");if(t){const n=e-t.childElementCount;if(0!==n)for(let e=0,r=Math.abs(n);e<r;e++)if(n>0){const e=document.createElement("i");e.className="dot",t.appendChild(e)}else{const e=t.firstChild;e&&t.removeChild(e)}const r=t.childNodes;for(let e=0;e<r.length;e++){const t=r[e];e===Xc.currentSlide?t.className="dot current":t.className="dot"}}}}function hl(){const e=Yr.nowPlaying(),t=jr.incoming(),n=jr.sending().filter(jr.isPersistent),r=t.map((e=>cl(e))).filter(bn),i=n.map((e=>ll(e))),a=[...r,...e.map((e=>sl(e))),...i];return An("div.games_carousel",{oncreate:nl,onremove:rl},a)}var pl={booleanChoice:[{label:"no",value:!1},{label:"yes",value:!0}],renderRadio(e,t,n,r,i,a,o){const s=t+"_"+n;return[An("input.radio[type=radio]",{name:t,id:s,className:n,value:n,checked:r,onchange:i,disabled:a}),An("label",{for:s,className:o},"string"==typeof e?yt(e):e)]},renderSelect(e,t,n,r,i,a){const o=r();return[An("label",{for:"select_"+t},yt(e)),An("select",{id:"select_"+t,disabled:i,onchange(e){const t=e.target.value;r(t),a&&a(t),setTimeout(Kt,10)}},n.map((e=>ml(e[0],e[1],o,e[2],e[3]))))]},renderSelectOption(e,t,n,r,i,a){const o=r();return An("div.check_container",{className:i?"disabled":""},[An("label",{for:"select_"+t},yt(e)),An("select",{id:"select_"+t,disabled:i,onchange(e){const t=e.target.value;r(t),a&&a(t),setTimeout(Kt,10)}},n.map((e=>ml(e[0],e[1],o,e[2],e[3]))))])},renderTextEditOption(e,t,n,r,i){const a=n();return An("div.check_container",{className:i?"disabled":""},[An("label",{for:"textedit_"+t},e),An("button",{type:"button",disabled:i,onclick(){const t=prompt(e,a);null!==t&&t!==a&&(n(t),r(t),setTimeout(Kt,10))}},a)])},renderCheckbox(e,t,n,r,i){const a=n();return An("div.check_container",{className:i?"disabled":""},[An("label",{for:t},e),An("input[type=checkbox]",{id:t,name:t,disabled:i,checked:a,onchange:()=>{const e=!a;n(e),r&&r(e),Kt()}})])},renderMultipleChoiceButton(e,t,n,r=!1,i){const a=n();return An("div.form-multipleChoiceContainer",[An("label",e),An("div.form-multipleChoice",{className:r?"wrap":""},t.map((e=>{const t=void 0!==e.labelArg?yt(e.label,e.labelArg):yt(e.label);return An("div",{className:e.value===a?"selected":"",oncreate:Ui((()=>{n(e.value),i&&i(e.value)}))},t)})))])},renderSliderOption(e,t,n,r,i,a,o,s){const c=a();return An("div.forms-rangeSlider",{className:s?"disabled":""},[An("label",{for:t},e),An("input[type=range]",{id:t,value:c,disabled:s,min:n,max:r,step:i,oninput(e){const t=~~e.target.value;a(t),o&&o(t),setTimeout(Kt,10)}}),An("div.forms-sliderValue",c)])},renderSlider(e,t,n,r,i,a,o,s){const c=a();return An("div.forms-rangeSlider",{className:s?"disabled":""},[An("label",{for:t},e),An("input[type=range]",{id:t,value:c,disabled:s,min:n,max:r,step:i,oninput(e){const t=~~e.target.value;a(t),o&&o(t),setTimeout(Kt,10)}}),An("div.forms-sliderValue",c+" / "+r)])}};function ml(e,t,n,r,i){const a=r&&i?yt(e,r,i):r?yt(e,r):yt(e);return An("option",{key:t,value:t,selected:n===t},a)}function fl(e,t,n,r,i){if(!r)return null;const a={overlay_popup:!0,native_scroller:!0};let o;if("object"==typeof e)o=Gi(Object.assign(Object.assign({},a),e));else{if("string"!=typeof e)throw new Error("First popup argument must be either a string or an object");o=Gi(a)+" "+e}const s=Gi({popup_content:!0,noheader:!t});return An("div",{className:"overlay_popup_wrapper fade-in",onbeforeremove:e=>(e.dom.classList.add("fading_out"),new Promise((e=>{setTimeout(e,500)})))},An("div",{className:"popup_overlay_close",oncreate:i?Ui(i):on}),An("div",{className:o},t?An("header",null,t()):null,An("div",{className:s},n())))}let gl=!1;const vl=lt.gameSetup.human;let bl=vl.preset(),wl=null;var yl={open:kl,close:Sl,openRealTime(e){vl.timeMode("1"),e&&(bl=e),kl()},openCorrespondence(){wl=bl,bl="custom",vl.timeMode("2"),kl()},view:()=>fl("game_form_popup",void 0,Tl,gl,Sl)};function kl(){Yr.hasCurrentBan()||(0===br.length&&wr(!1).then(Kt),bi.backbutton.stack.push(Sl),gl=!0)}function Sl(e){"backbutton"!==e&&gl&&bi.backbutton.stack.pop(),gl=!1,wl&&(bl=wl,wl=null)}function Cl(e){Sl(),Oa(e)||xa(e)&&1===e.timeMode?ed.startSeeking(e):hr(e).then((()=>bi.set("/?tab=1"))).catch(rn)}function Tl(){const e=vl,t=t=>tn((()=>{const n=t.target.value;bl=n,e.preset(n)}));return[An("div.newGame-preset_switch",[An("div.nice-radio",pl.renderRadio(yt("quickPairing"),"preset","quick","quick"===bl,t)),An("div.nice-radio",pl.renderRadio(yt("custom"),"preset","custom","custom"===bl,t))]),"quick"===bl?(n=()=>{bl="custom",vl.preset("custom")},An("div.newGame-pools",{className:br.length?"":"loading"},br.length?br.map((e=>function(e){return An("div.newGame-pool",{key:"pool-"+e.id,oncreate:Ui((()=>{vl.pool(e.id),Cl({id:e.id}),Sl()}))},[An("div.newGame-clock",e.id),An("div.newGame-perf",e.perf)])}(e))).concat(An("div.newGame-pool",{key:"pool-custom",oncreate:Ui(n)},An("div.newGame-custom",yt("custom")))):$n.getVdom("monochrome"))):Pl("human",e,e.availableVariants,e.availableTimeModes.filter((e=>"1"===e[1]||Yr.isConnected())))];var n}function Pl(e,t,n,r){const i=t.timeMode(),a="1"===i,o="2"===i&&Yr.isConnected(),s=t.variant();"2"===i&&"1"!==s&&t.mode("0");const c=t.mode();Yr.isConnected()||vl.timeMode("1"),"0"===i&&vl.mode("0");const l=!Yr.isConnected()||"0"===i||"2"===i&&"1"!==s?[["casual","0"]]:[["casual","0"],["rated","1"]],u=En(c,t.variant());1===u.length&&t.color(u[0][1]);const d=[An("div.select_input",pl.renderSelect("side",e+"color",u,t.color)),An("div.select_input",pl.renderSelect("variant",e+"variant",n,t.variant))];d.push(An("div.select_input",pl.renderSelect("mode",e+"mode",l,t.mode))),Yr.isConnected()&&d.push(An("div.rating_range",[An("div.title",yt("ratingRange")),An("div.select_input.inline",pl.renderSelect("Min",e+"rating_min",vl.availableRatingRanges.min,t.ratingRangeMin,!1)),An("div.select_input.inline",pl.renderSelect("Max",e+"rating_max",vl.availableRatingRanges.max,t.ratingRangeMax,!1))]));const h=[An("div.select_input",pl.renderSelect("clock",e+"timeMode",r,t.timeMode))];return a&&h.push(An("div.select_input.inline",pl.renderSelect("time",e+"time",lt.gameSetup.availableTimes,t.time,!1)),An("div.select_input.inline",pl.renderSelect("increment",e+"increment",lt.gameSetup.availableIncrements.map(tt),t.increment,!1))),o&&h.push(An("div.select_input.large_label",pl.renderSelect("daysPerTurn",e+"days",lt.gameSetup.availableDays.map(tt),t.days,!1))),An("form.game_form",{onsubmit(e){e.preventDefault(),lt.gameSetup.isTimeValid(t)&&(Sl(),Cl(cr(t)))}},[An("fieldset",d),An("fieldset",h),An("div.popupActionWrapper",[An("button[type=submit].defaultButton",yt("createAGame"))])])}function El(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ol,xl=function(){function e(){}var t=e.prototype;return t.unwrap=function(e,t){var n=this._chain((function(t){return Ol.ok(e?e(t):t)}),(function(e){return t?Ol.ok(t(e)):Ol.err(e)}));if(n.isErr)throw n.error;return n.value},t.map=function(e,t){return this._chain((function(t){return Ol.ok(e(t))}),(function(e){return Ol.err(t?t(e):e)}))},t.chain=function(e,t){return this._chain(e,t||function(e){return Ol.err(e)})},e}(),_l=function(e){function t(t){var n;return(n=e.call(this)||this).value=t,n.isOk=!0,n.isErr=!1,n}return El(t,e),t.prototype._chain=function(e,t){return e(this.value)},t}(xl),Ml=function(e){function t(t){var n;return(n=e.call(this)||this).error=t,n.isOk=!1,n.isErr=!0,n}return El(t,e),t.prototype._chain=function(e,t){return t(this.error)},t}(xl);!function(e){e.ok=function(e){return new _l(e)},e.err=function(e){return new Ml(e)},e.all=function(t){if(Array.isArray(t)){for(var n=[],r=0;r<t.length;r++){var i=t[r];if(i.isErr)return i;n.push(i.value)}return e.ok(n)}for(var a={},o=Object.keys(t),s=0;s<o.length;s++){var c=t[o[s]];if(c.isErr)return c;a[o[s]]=c.value}return e.ok(a)}}(Ol||(Ol={}));const Nl=["a","b","c","d","e","f","g","h"],jl=["1","2","3","4","5","6","7","8"],Dl=["white","black"],Ll=["pawn","knight","bishop","rook","queen","king"],Il=["a","h"];function ql(e){return"role"in e}function Rl(e){return e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24}function Al(e){return(e=e>>>8&16711935|(16711935&e)<<8)>>>16&65535|(65535&e)<<16}function Bl(e){return Al(e=(e=(e=e>>>1&1431655765|(1431655765&e)<<1)>>>2&858993459|(858993459&e)<<2)>>>4&252645135|(252645135&e)<<4)}class SquareSet{constructor(e,t){this.lo=e,this.hi=t,this.lo=0|e,this.hi=0|t}static fromSquare(e){return e>=32?new SquareSet(0,1<<e-32):new SquareSet(1<<e,0)}static fromRank(e){return new SquareSet(255,0).shl64(8*e)}static fromFile(e){return new SquareSet(16843009<<e,16843009<<e)}static empty(){return new SquareSet(0,0)}static full(){return new SquareSet(4294967295,4294967295)}static corners(){return new SquareSet(129,2164260864)}static center(){return new SquareSet(402653184,24)}static backranks(){return new SquareSet(255,4278190080)}static backrank(e){return"white"===e?new SquareSet(255,0):new SquareSet(0,4278190080)}static lightSquares(){return new SquareSet(1437226410,1437226410)}static darkSquares(){return new SquareSet(2857740885,2857740885)}complement(){return new SquareSet(~this.lo,~this.hi)}xor(e){return new SquareSet(this.lo^e.lo,this.hi^e.hi)}union(e){return new SquareSet(this.lo|e.lo,this.hi|e.hi)}intersect(e){return new SquareSet(this.lo&e.lo,this.hi&e.hi)}diff(e){return new SquareSet(this.lo&~e.lo,this.hi&~e.hi)}intersects(e){return this.intersect(e).nonEmpty()}isDisjoint(e){return this.intersect(e).isEmpty()}supersetOf(e){return e.diff(this).isEmpty()}subsetOf(e){return this.diff(e).isEmpty()}shr64(e){return e>=64?SquareSet.empty():e>=32?new SquareSet(this.hi>>>e-32,0):e>0?new SquareSet(this.lo>>>e^this.hi<<32-e,this.hi>>>e):this}shl64(e){return e>=64?SquareSet.empty():e>=32?new SquareSet(0,this.lo<<e-32):e>0?new SquareSet(this.lo<<e,this.hi<<e^this.lo>>>32-e):this}bswap64(){return new SquareSet(Al(this.hi),Al(this.lo))}rbit64(){return new SquareSet(Bl(this.hi),Bl(this.lo))}minus64(e){const t=this.lo-e.lo,n=(t&e.lo&1)+(e.lo>>>1)+(t>>>1)>>>31;return new SquareSet(t,this.hi-(e.hi+n))}equals(e){return this.lo===e.lo&&this.hi===e.hi}size(){return Rl(this.lo)+Rl(this.hi)}isEmpty(){return 0===this.lo&&0===this.hi}nonEmpty(){return 0!==this.lo||0!==this.hi}has(e){return 0!=(e>=32?this.hi&1<<e-32:this.lo&1<<e)}set(e,t){return t?this.with(e):this.without(e)}with(e){return e>=32?new SquareSet(this.lo,this.hi|1<<e-32):new SquareSet(this.lo|1<<e,this.hi)}without(e){return e>=32?new SquareSet(this.lo,this.hi&~(1<<e-32)):new SquareSet(this.lo&~(1<<e),this.hi)}toggle(e){return e>=32?new SquareSet(this.lo,this.hi^1<<e-32):new SquareSet(this.lo^1<<e,this.hi)}last(){return 0!==this.hi?63-Math.clz32(this.hi):0!==this.lo?31-Math.clz32(this.lo):void 0}first(){return 0!==this.lo?31-Math.clz32(this.lo&-this.lo):0!==this.hi?63-Math.clz32(this.hi&-this.hi):void 0}withoutFirst(){return 0!==this.lo?new SquareSet(this.lo&this.lo-1,this.hi):new SquareSet(0,this.hi&this.hi-1)}moreThanOne(){return 0!==this.hi&&0!==this.lo||!!(this.lo&this.lo-1)||!!(this.hi&this.hi-1)}singleSquare(){return this.moreThanOne()?void 0:this.last()}isSingleSquare(){return this.nonEmpty()&&!this.moreThanOne()}*[Symbol.iterator](){let e=this.lo,t=this.hi;for(;0!==e;){const t=31-Math.clz32(e&-e);e^=1<<t,yield t}for(;0!==t;){const e=31-Math.clz32(t&-t);t^=1<<e,yield 32+e}}*reversed(){let e=this.lo,t=this.hi;for(;0!==t;){const e=31-Math.clz32(t);t^=1<<e,yield 32+e}for(;0!==e;){const t=31-Math.clz32(e);e^=1<<t,yield t}}}class Board{constructor(){}static default(){const e=new Board;return e.reset(),e}static racingKings(){const e=new Board;return e.occupied=new SquareSet(65535,0),e.promoted=SquareSet.empty(),e.white=new SquareSet(61680,0),e.black=new SquareSet(3855,0),e.pawn=SquareSet.empty(),e.knight=new SquareSet(6168,0),e.bishop=new SquareSet(9252,0),e.rook=new SquareSet(16962,0),e.queen=new SquareSet(129,0),e.king=new SquareSet(33024,0),e}static horde(){const e=new Board;return e.occupied=new SquareSet(4294967295,4294901862),e.promoted=SquareSet.empty(),e.white=new SquareSet(4294967295,102),e.black=new SquareSet(0,4294901760),e.pawn=new SquareSet(4294967295,16711782),e.knight=new SquareSet(0,1107296256),e.bishop=new SquareSet(0,603979776),e.rook=new SquareSet(0,2164260864),e.queen=new SquareSet(0,134217728),e.king=new SquareSet(0,268435456),e}reset(){this.occupied=new SquareSet(65535,4294901760),this.promoted=SquareSet.empty(),this.white=new SquareSet(65535,0),this.black=new SquareSet(0,4294901760),this.pawn=new SquareSet(65280,16711680),this.knight=new SquareSet(66,1107296256),this.bishop=new SquareSet(36,603979776),this.rook=new SquareSet(129,2164260864),this.queen=new SquareSet(8,134217728),this.king=new SquareSet(16,268435456)}static empty(){const e=new Board;return e.clear(),e}clear(){this.occupied=SquareSet.empty(),this.promoted=SquareSet.empty();for(const e of Dl)this[e]=SquareSet.empty();for(const e of Ll)this[e]=SquareSet.empty()}clone(){const e=new Board;e.occupied=this.occupied,e.promoted=this.promoted;for(const t of Dl)e[t]=this[t];for(const t of Ll)e[t]=this[t];return e}equalsIgnorePromoted(e){return!!this.white.equals(e.white)&&Ll.every((t=>this[t].equals(e[t])))}equals(e){return this.equalsIgnorePromoted(e)&&this.promoted.equals(e.promoted)}getColor(e){return this.white.has(e)?"white":this.black.has(e)?"black":void 0}getRole(e){for(const t of Ll)if(this[t].has(e))return t}get(e){const t=this.getColor(e);if(!t)return;return{color:t,role:this.getRole(e),promoted:this.promoted.has(e)}}take(e){const t=this.get(e);return t&&(this.occupied=this.occupied.without(e),this[t.color]=this[t.color].without(e),this[t.role]=this[t.role].without(e),t.promoted&&(this.promoted=this.promoted.without(e))),t}set(e,t){const n=this.take(e);return this.occupied=this.occupied.with(e),this[t.color]=this[t.color].with(e),this[t.role]=this[t.role].with(e),t.promoted&&(this.promoted=this.promoted.with(e)),n}has(e){return this.occupied.has(e)}*[Symbol.iterator](){for(const e of this.occupied)yield[e,this.get(e)]}pieces(e,t){return this[e].intersect(this[t])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}kingOf(e){return this.king.intersect(this[e]).diff(this.promoted).singleSquare()}}class MaterialSide{constructor(){}static empty(){const e=new MaterialSide;for(const t of Ll)e[t]=0;return e}static fromBoard(e,t){const n=new MaterialSide;for(const r of Ll)n[r]=e.pieces(t,r).size();return n}clone(){const e=new MaterialSide;for(const t of Ll)e[t]=this[t];return e}equals(e){return Ll.every((t=>this[t]===e[t]))}add(e){const t=new MaterialSide;for(const n of Ll)t[n]=this[n]+e[n];return t}nonEmpty(){return Ll.some((e=>this[e]>0))}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}count(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}}class Material{constructor(e,t){this.white=e,this.black=t}static empty(){return new Material(MaterialSide.empty(),MaterialSide.empty())}static fromBoard(e){return new Material(MaterialSide.fromBoard(e,"white"),MaterialSide.fromBoard(e,"black"))}clone(){return new Material(this.white.clone(),this.black.clone())}equals(e){return this.white.equals(e.white)&&this.black.equals(e.black)}add(e){return new Material(this.white.add(e.white),this.black.add(e.black))}count(){return this.white.count()+this.black.count()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}}class RemainingChecks{constructor(e,t){this.white=e,this.black=t}static default(){return new RemainingChecks(3,3)}clone(){return new RemainingChecks(this.white,this.black)}equals(e){return this.white===e.white&&this.black===e.black}}function $l(e){return void 0!==e}function Fl(e){return"white"===e?"black":"white"}function Ul(e){return e>>3}function zl(e){return 7&e}function Wl(e){switch(e){case"pawn":return"p";case"knight":return"n";case"bishop":return"b";case"rook":return"r";case"queen":return"q";case"king":return"k"}}function Hl(e){switch(e){case"P":case"p":return"pawn";case"N":case"n":return"knight";case"B":case"b":return"bishop";case"R":case"r":return"rook";case"Q":case"q":return"queen";case"K":case"k":return"king";default:return}}function Vl(e){if(2!==e.length)return;const t=e.charCodeAt(0)-"a".charCodeAt(0),n=e.charCodeAt(1)-"1".charCodeAt(0);return t<0||t>=8||n<0||n>=8?void 0:t+8*n}function Gl(e){return Nl[zl(e)]+jl[Ul(e)]}function Kl(e){if("@"===e[1]&&4===e.length){const t=Hl(e[0]),n=Vl(e.slice(2));if(t&&$l(n))return{role:t,to:n}}else if(4===e.length||5===e.length){const t=Vl(e.slice(0,2)),n=Vl(e.slice(2,4));let r;if(5===e.length&&(r=Hl(e[4]),!r))return;if($l(t)&&$l(n))return{from:t,to:n,promotion:r}}}function Yl(e,t){return"white"===e?"a"===t?2:6:"a"===t?58:62}const Xl="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ql="8/8/8/8/8/8/8/8 w - - 0 1";var Jl;!function(e){e.Fen="ERR_FEN",e.Board="ERR_BOARD",e.Pockets="ERR_POCKETS",e.Turn="ERR_TURN",e.Castling="ERR_CASTLING",e.EpSquare="ERR_EP_SQUARE",e.RemainingChecks="ERR_REMAINING_CHECKS",e.Halfmoves="ERR_HALFMOVES",e.Fullmoves="ERR_FULLMOVES"}(Jl||(Jl={}));class FenError extends Error{}function Zl(e){return/^\d{1,4}$/.test(e)?parseInt(e,10):void 0}function eu(e){const t=Hl(e);return t&&{role:t,color:e.toLowerCase()===e?"black":"white"}}function tu(e){const t=Board.empty();let n=7,r=0;for(let i=0;i<e.length;i++){const a=e[i];if("/"===a&&8===r)r=0,n--;else{const o=parseInt(a,10);if(o>0)r+=o;else{if(r>=8||n<0)return Ol.err(new FenError(Jl.Board));const o=r+8*n,s=eu(a);if(!s)return Ol.err(new FenError(Jl.Board));"~"===e[i+1]&&(s.promoted=!0,i++),t.set(o,s),r++}}}return 0!==n||8!==r?Ol.err(new FenError(Jl.Board)):Ol.ok(t)}function nu(e){if(e.length>64)return Ol.err(new FenError(Jl.Pockets));const t=Material.empty();for(const n of e){const e=eu(n);if(!e)return Ol.err(new FenError(Jl.Pockets));t[e.color][e.role]++}return Ol.ok(t)}function ru(e,t){let n=SquareSet.empty();if("-"===t)return Ol.ok(n);if(!/^[KQABCDEFGH]{0,2}[kqabcdefgh]{0,2}$/.test(t))return Ol.err(new FenError(Jl.Castling));for(const r of t){const t=r.toLowerCase(),i=r===t?"black":"white",a=SquareSet.backrank(i).intersect(e[i]);let o;o="q"===t?a:"k"===t?a.reversed():SquareSet.fromSquare(t.charCodeAt(0)-"a".charCodeAt(0)).intersect(a);for(const t of o){if(e.king.has(t)&&!e.promoted.has(t))break;if(e.rook.has(t)){n=n.with(t);break}}}return Ol.ok(n)}function iu(e){const t=e.split("+");if(3===t.length&&""===t[0]){const e=Zl(t[1]),n=Zl(t[2]);return!$l(e)||e>3||!$l(n)||n>3?Ol.err(new FenError(Jl.RemainingChecks)):Ol.ok(new RemainingChecks(3-e,3-n))}if(2===t.length){const e=Zl(t[0]),n=Zl(t[1]);return!$l(e)||e>3||!$l(n)||n>3?Ol.err(new FenError(Jl.RemainingChecks)):Ol.ok(new RemainingChecks(e,n))}return Ol.err(new FenError(Jl.RemainingChecks))}function au(e){const t=e.split(" "),n=t.shift();let r,i,a=Ol.ok(void 0);if(n.endsWith("]")){const e=n.indexOf("[");if(-1===e)return Ol.err(new FenError(Jl.Fen));r=tu(n.substr(0,e)),a=nu(n.substr(e+1,n.length-1-e-1))}else{const e=function(e,t,n){let r=e.indexOf(t);for(;n-- >0&&-1!==r;)r=e.indexOf(t,r+t.length);return r}(n,"/",7);-1===e?r=tu(n):(r=tu(n.substr(0,e)),a=nu(n.substr(e+1)))}const o=t.shift();if($l(o)&&"w"!==o){if("b"!==o)return Ol.err(new FenError(Jl.Turn));i="black"}else i="white";return r.chain((e=>{const n=t.shift(),r=$l(n)?ru(e,n):Ol.ok(SquareSet.empty()),o=t.shift();let s;if($l(o)&&"-"!==o&&(s=Vl(o),!$l(s)))return Ol.err(new FenError(Jl.EpSquare));let c,l=t.shift();$l(l)&&l.includes("+")&&(c=iu(l),l=t.shift());const u=$l(l)?Zl(l):0;if(!$l(u))return Ol.err(new FenError(Jl.Halfmoves));const d=t.shift(),h=$l(d)?Zl(d):1;if(!$l(h))return Ol.err(new FenError(Jl.Fullmoves));const p=t.shift();let m=Ol.ok(void 0);if($l(p)){if($l(c))return Ol.err(new FenError(Jl.RemainingChecks));m=iu(p)}else $l(c)&&(m=c);return t.length>0?Ol.err(new FenError(Jl.Fen)):a.chain((t=>r.chain((n=>m.map((r=>({board:e,pockets:t,turn:i,unmovedRooks:n,remainingChecks:r,epSquare:s,halfmoves:u,fullmoves:Math.max(1,h)})))))))}))}function ou(e,t){let n=Wl(e.role);return"white"===e.color&&(n=n.toUpperCase()),(null==t?void 0:t.promoted)&&e.promoted&&(n+="~"),n}function su(e,t){let n="",r=0;for(let i=7;i>=0;i--)for(let a=0;a<8;a++){const o=a+8*i,s=e.get(o);s?(r>0&&(n+=r,r=0),n+=ou(s,t)):r++,7===a&&(r>0&&(n+=r,r=0),0!==i&&(n+="/"))}return n}function cu(e){return Ll.map((t=>Wl(t).repeat(e[t]))).join("")}function lu(e,t,n){const r=null==n?void 0:n.shredder;let i="";for(const n of Dl){const a=SquareSet.backrank(n),o=e.kingOf(n);if(!$l(o)||!a.has(o))continue;const s=e.pieces(n,"rook").intersect(a);for(const e of t.intersect(s).reversed())if(!r&&e===s.first()&&e<o)i+="white"===n?"Q":"q";else if(!r&&e===s.last()&&o<e)i+="white"===n?"K":"k";else{const t=Nl[zl(e)];i+="white"===n?t.toUpperCase():t}}return i||"-"}function uu(e,t){return[su(e.board,t)+(e.pockets?`[${r=e.pockets,cu(r.white).toUpperCase()+cu(r.black)}]`:""),e.turn[0],lu(e.board,e.unmovedRooks,t),$l(e.epSquare)?Gl(e.epSquare):"-",...e.remainingChecks?[(n=e.remainingChecks,`${n.white}+${n.black}`)]:[],...(null==t?void 0:t.epd)?[]:[Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))]].join(" ");var n,r}let du,hu,pu="";const mu=Cn(!1);function fu(e){e?(du=e,pu=yt("challengeToPlay")):(du=void 0,pu=yt("playWithAFriend")),bi.backbutton.stack.push(gu),mu(!0),hu=void 0}function gu(e){"backbutton"!==e&&mu()&&bi.backbutton.stack.pop(),mu(!1)}function vu(){return function(e,t){const n=lt.gameSetup.challenge,r=e?`/setup/friend?user=${e}`:"/setup/friend",i={variant:n.variant(),timeMode:n.timeMode(),days:n.days(),time:n.time(),increment:n.increment(),color:n.color(),mode:Yr.isConnected()?n.mode():"0"};return t&&(i.fen=t),Gn(r,{method:"POST",body:JSON.stringify(i)},!0)}(du,hu).then((e=>{e.challenge.destUser&&jr.isPersistent(e.challenge)?Jc.open(Yr.nowPlaying().length+jr.all().length):bi.set(`/game/${e.challenge.id}`)})).catch(rn)}function bu(){const e="invite",t=lt.gameSetup.challenge,n=lt.gameSetup.challenge.availableVariants,r=lt.gameSetup.challenge.availableTimeModes,i=t.timeMode(),a="1"===i,o="2"===i,s=En(t.mode(),t.variant());1===s.length&&t.color(s[0][1]);const c=Yr.isConnected()?[["casual","0"],["rated","1"]]:[["casual","0"]],l=[An("div.select_input",pl.renderSelect("side",e+"color",s,t.color)),An("div.select_input",pl.renderSelect("variant",e+"variant",n,t.variant)),"3"===t.variant()?An("div.setupPosition",[An("div.setupPositionInput",[An("input[type=text][name=fen]",{placeholder:yt("pasteTheFenStringHere"),oninput:e=>{const t=e.target.value;hu=""===t?void 0:au(t).unwrap((e=>uu(e)),(()=>!1)),Kt()}}),An("button.withIcon",{oncreate:Ui((()=>{gu(),bi.set("/editor")}))},An("span.fa.fa-pencil"))]),!1===hu?An("div.setupFenError","Invalid FEN"):null,void 0!==hu&&!1!==hu?[An("div",{style:{width:"100px",height:"100px"},oncreate:Ui((()=>{gu(),hu&&bi.set(`/editor/${encodeURIComponent(hu)}`)}))},[An(Kc,{fen:hu,orientation:"white"})])]:null]):null,"3"!==t.variant()?An("div.select_input",pl.renderSelect("mode",e+"mode",c,t.mode)):null],u=[An("div.select_input",pl.renderSelect("clock",e+"timeMode",r,t.timeMode))];return a&&u.push(An("div.select_input.inline",pl.renderSelect("time",e+"time",lt.gameSetup.availableTimes,t.time,!1)),An("div.select_input.inline",pl.renderSelect("increment",e+"increment",lt.gameSetup.availableIncrements.map(tt),t.increment,!1))),o&&u.push(An("div.select_input.large_label",pl.renderSelect("daysPerTurn",e+"days",lt.gameSetup.availableDays.map(tt),t.days,!1))),An("form#invite_form.game_form",{onsubmit(e){e.preventDefault(),lt.gameSetup.isTimeValid(t)&&(gu(),vu())}},[An("fieldset",l),An("fieldset#clock",u),An("div.popupActionWrapper",[An("button[type=submit].defaultButton",pu)])])}var wu={view:()=>fl("invite_form_popup game_form_popup",void 0,bu,mu(),gu),open:fu,openFromPosition(e){fu(),hu=e,lt.gameSetup.challenge.variant("3"),lt.gameSetup.challenge.mode("0")}};let yu=!1;var ku={open:function(){bi.backbutton.stack.push(Su),yu=!0},close:Su,view:()=>fl({onlineFriends:!0,native_scroller:!1},(function(){return[An("span",St("nbFriendsOnline",Qn.count()))]}),Cu,yu,Su)};function Su(e){"backbutton"!==e&&yu&&bi.backbutton.stack.pop(),yu=!1}function Cu(){const e=Qn.list();return e.length?An("ul",null,e.map(Tu)):An("div",{className:"native_scroller nofriend"})}function Tu(e){const t=e.name.toLowerCase(),n="BOT"===e.title;return An("li",{className:"list_item",key:t,oncreate:Wi((function(){Su(),bi.set("/@/"+t)}))},An("div",{className:"friend_name"},e.patron?An("span",{className:"patron is-green","data-icon":""}):null,An("span",null,e.title?An("span",{className:"userTitle"+(n?" bot":"")},e.title," "):null,e.name)),An("div",{className:"onlineFriends_actions"},e.playing?An("span",{className:"friend_tv","data-icon":"1",oncreate:Wi((function(e){e.stopPropagation(),Su(),bi.set("/@/"+t+"/tv")}))}," "):null,An("span",{"data-icon":"U",oncreate:Wi((e=>{e.stopPropagation(),Su(),wu.open(t)}))}),An("span",{"data-icon":"c",oncreate:Wi((e=>{e.stopPropagation(),Su(),bi.set(`/inbox/new/${t}`)}))})))}const Pu=An("div",{className:"svg_icon"},An("div",{className:"svg_icon_inner"},An("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},An("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})))),Eu=An("div",{className:"svg_icon"},An("div",{className:"svg_icon_inner"},An("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},An("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})))),Ou=An("div",{className:"svg_icon"},An("div",{className:"svg_icon_inner"},An("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},An("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})))),xu=An("div",{className:"svg_icon"},An("div",{className:"svg_icon_inner"},An("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},An("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}))));function _u(){return An("button.fa.fa-navicon.main_header_button.menu_button",{oncreate:Ui(Ja.toggle)})}function Mu(e){return An("div.back_button",[An("button",{oncreate:Ui(bi.backHistory)},Pu),void 0!==e?"string"==typeof e?An("div.main_header_title",e):e:null])}function Nu(e,t){return Yr.isConnected()?An("button.main_header_button.bookmarkButton",{oncreate:Ui(e,(()=>z.show({text:yt("bookmarkThisGame"),duration:"short",position:"top"})))},An("span",{"data-icon":t?"t":"s"})):null}function ju(){if(!lt.general.bluetooth.useDevice())return null;const e=Vc.isConnected(),t=Vc.batteryLevel(),n=()=>{"/settings/bluetooth"!==bi.get()&&bi.set("/settings/bluetooth")},r=[An("button.main_header_button.fa."+(e?"fa-bluetooth":"fa-bluetooth-b"),{oncreate:Ui(n),disabled:!e})];if(e&&void 0!==t){let e="fa-battery-full";t<=5?e="fa-battery-empty":t<=35?e="fa-battery-quarter":t<=65?e="fa-battery-half":t<=95&&(e="fa-battery-three-quarters"),r.unshift(An(`button.main_header_button.fa.${e}`,{oncreate:Ui(n)}))}return r}let Du;function Lu(e){Du=e}function Iu(){Du=Du||lt.general.theme.board();const e=Yr.myTurnGames().length,t=jr.incoming().length,n=["main_header_button","game_menu_button",Du,t?"new_challenge":""].join(" ");return An("button",{className:n,"data-button":"games"},!t&&e?An("span",{className:"chip nb_playing"},e):null,t?An("span",{className:"chip nb_challenges"},t):null)}function qu(e){const t=aa(e,".main_header_button"),n=null==t?void 0:t.dataset.button;if(t&&n)if("games"===n){const e=jr.all().length;Yr.nowPlaying().length||e?Jc.open():yl.open()}else"friends"===n&&ku.open()}function Ru(){const e=Ui(qu,void 0,void 0,oa(".main_header_button"));return Yr.isConnected()&&Qn.count()?An("div",{className:"buttons",oncreate:e},ju(),function(){const e=Qn.count();return An("button",{className:"main_header_button friends_button","data-icon":"f","data-button":"friends"},e>0?An("span",{className:"chip nb_friends"},e):null)}(),Iu()):An("div",{className:"buttons",oncreate:e},ju(),Iu())}function Au(e,t){return An("nav",[t||_u(),"string"==typeof e?An("div.main_header_title",e):e,Ru()])}function Bu(e,t){return[An("nav",[t||_u(),e?An("div",{className:"main_header_title"},e):null,Ru()])]}const $u=An("div",{className:"loader_circles"},[1,2,3].map((e=>An("div",{className:"circle_"+e}))));function Fu(e){return An("nav",null,_u(),An("div",{className:"main_header_title reconnecting"+(e?"withTitle":"")},e?An("span",null,e):null,$u),Ru())}function Uu(e){return[An("nav",[_u(),An("div.main_header_title.reconnecting",{className:e?"withTitle":""}),e?An("div.main_header_title",e):null,Ru()])]}function zu(e){return An("nav",[Mu(An("div.main_header_title.reconnecting",{className:e?"withTitle":""},[e?An("span",e):null,$u])),Ru()])}function Wu(e){const t=e.online?"online":"offline";return An("div",{className:"user"},e.patron?An("span",{className:"patron userStatus "+t,"data-icon":""}):An("span",{className:"fa fa-circle userStatus "+t}),e.title?An("span",{className:"userTitle"},e.title," "):null,e.username)}const Hu="setup.custom.last";let Vu,Gu,Ku=0,Yu=0,Xu=!1,Qu=null,Ju=null;const Zu={redirect:e=>{id(),null!==Qu&&(Oa(Qu)?cd(Qu):_n.set(Hu,Qu)),Ea.redirectToGame(e)},n:(e,t)=>{Ku=t.d,Yu=t.r,Kt()}};var ed={startSeeking(e){rd(e)},appCancelSeeking(){Xu&&sd()},onNewOpponent(e){if("pool"===e.game.source){const t=e.clock;rd({id:t.initial/60+"+"+t.increment})}else{rd(Qu&&xa(Qu)?Qu:_n.get(Hu)||cr(lt.gameSetup.human),e.game.id)}},view:()=>fl("",void 0,(function(){const e=St("nbPlayers",Ku,Ku?void 0:"?"),t=St("nbGames",Yu,Yu?void 0:"?");return An("div.lobby-waitingPopup",null===Qu?"Something went wrong. Please try again":[An("div.lobby-waitingForOpponent",yt("waitingForOpponent")),An("br"),Oa(Qu)?nd(Qu):td(Qu),An("br"),$n.getVdom(),An("div.lobby-nbPlayers",Ea.isConnected()?[An("div",An.trust(e.replace(/(\d+)/,"<strong>$1</strong>"))),An("div",An.trust(t.replace(/(\d+)/,"<strong>$1</strong>")))]:An("div",[yt("reconnecting"),$u])),An("button[data-icon=L]",{oncreate:Ui((()=>ad()))},yt("cancel"))])}),Xu)};function td(e){const t=lt.gameSetup.human.availableVariants.find((t=>t[1]===String(e.variant))),n=t&&t[0]||"Standard",r=e.timeMode,i=0===e.mode?yt("casual"):yt("rated"),a=e.time;let o;o=1===r?function(e){return"0.75"===e?"¾":"0.5"===e?"½":"0.25"===e?"¼":e}(String(a))+"+"+e.increment:2===r?St("nbDays",e.days):"∞";const s=` • ${n} • ${i}`;return An("div.gameInfos",[An("span[data-icon=p]",o),s])}function nd(e){const t=` • Standard • ${Yr.isConnected()?yt("rated"):yt("casual")}`;return An("div.gameInfos",[An("span[data-icon=p]",e.id),t])}function rd(e,t){var n;bi.backbutton.stack.push(ad),Xu=!0,ha(),Oa(e)?(Qu=n=e,Gu=Ea.createLobby(ga,(()=>{Xu&&Yr.refresh().then((()=>{if(Yr.isConnected())ud("poolIn",n),clearInterval(Vu),Vu=setInterval((()=>{ud("poolIn",n)}),1e4);else{const e=br.find((e=>e.id===n.id));e&&od({mode:0,variant:1,timeMode:1,time:e.lim,increment:e.inc,days:1,color:"random"})}}))}),Zu)):Yr.refresh().then((()=>od(e,t)))}function id(e){"backbutton"!==e&&Xu&&bi.backbutton.stack.pop(),Xu=!1}function ad(e){id(e),sd(),bi.reload(),pa()}function od(e,t){Qu=e,Ju&&ld(),Gu=Ea.createLobby(ga,(()=>{Xu&&(Ju||(t?function(e,t){const n=Yr.get(),r=n?lr(n,t):null;Gn(`/setup/hook/${Xt()}/like/${e}?rr=${r||""}`,{method:"POST"},!0)}(t,e):hr(e).then((e=>{Ju=e.hook.id})).catch(rn)))}),Zu)}function sd(){null!==Qu&&(Oa(Qu)?cd(Qu):Ju&&ld())}function cd(e){clearInterval(Vu),ud("poolOut",e.id)}function ld(){ud("cancel",Ju),Ju=null}function ud(e,t){Gu&&Gu.send(e,t)}const dd=r("Badge");let hd=!0;function pd(e,t,r,i,a,o){window.lichess.cpuArch=o,window.deviceInfo={platform:t.platform,osVersion:t.osVersion,uuid:r.identifier,appVersion:e.version,cpuCores:i,stockfishMaxMemory:16*Math.ceil(a/16)},"ios"===n.getPlatform()&&p.setAccessoryBarVisible({isVisible:!0}),Sn((()=>{ji(),rr.load()})),s.addListener("appStateChange",(e=>{e.isActive?(rr.resume(),er=!0,Yr.refresh().then((()=>{"ios"===n.getPlatform()&&dd.setNumber({badge:Yr.myTurnGames().length})})),Ea.cancelDelayedDisconnect(),Ea.connect(),Kt()):(er=!1,Ea.delayedDisconnect(18e4),ed.appCancelSeeking())})),u.addListener("networkStatusChange",(e=>{e.connected?tr()&&(hd?(hd=!1,function(){const e=window.deviceInfo.appVersion||"web-dev";Gn("/api/status",{query:{v:e}}).then((t=>{if(t.mustUpgrade){const t="warn_bug_"+e,n=Number(_n.get(t))||0;0===n?sr.alert({title:"Alert",message:"A new version of lichess mobile is available. Please upgrade as soon as possible."}).then((()=>{_n.set(t,1)})):10===n?_n.remove(t):_n.set(t,n+1)}else if(t.api.current>At.apiVersion){const e=t.api.olds.find((e=>e.version===At.apiVersion));if(e){const t=new Date,n=new Date(e.unsupportedAt),r=new Date(e.deprecatedAt),i="warn_old_"+e.version,a=Number(_n.get(i))||0;t>n?sr.alert({title:"Alert",message:yt("apiUnsupported")}):t>r&&(0===a?sr.alert({title:"Alert",message:yt("apiDeprecated",Tt(n))}).then((()=>{_n.set(i,1)})):15===a?_n.remove(i):_n.set(i,a+1))}}}))}(),gd(),Yr.rememberLogin().then((()=>{Yn.register(),jr.refresh(),"ios"===n.getPlatform()&&dd.setNumber({badge:Yr.myTurnGames().length}),Kt()})).catch((()=>{"ios"===n.getPlatform()&&dd.setNumber({badge:0})}))):(Ea.connect(),Yr.refresh())):tr()&&(Ea.disconnect(),Kt())})),s.addListener("backButton",bi.backbutton),window.addEventListener("resize",U(md),!1),Yr.restoreStoredSession()}function md(){Pi=null,Ti=void 0,Kt()}let fd=1;function gd(){return wr().then(Kt).catch((()=>{fd<=5&&(fd++,setTimeout(gd,1e3*fd))}))}const vd=r("Stockfish"),bd=r("StockfishVariants",{web:()=>import("./StockfishVariantsWeb-4ef57b74.js").then((e=>new e.StockfishVariantsWeb))});class StockfishPlugin{constructor(e){this.variant=e,this.plugin=!this.isVariant()&&kd()&&lt.analyse.cevalUseNNUE()?vd:bd}async start(){return new Promise((e=>{let t="Stockfish";const n=r=>{const i=r.output;i.startsWith("id name ")&&(t=i.substring(8)),i.startsWith("uciok")&&(window.removeEventListener("stockfish",n,!1),e({engineName:t}))};window.addEventListener("stockfish",n,{passive:!0}),this.plugin.start().then((()=>this.send("uci")))}))}isReady(){return new Promise((e=>{const t=n=>{n.output.startsWith("readyok")&&(window.removeEventListener("stockfish",t,!1),e())};window.addEventListener("stockfish",t,{passive:!0}),this.send("isready")}))}send(e){return this.plugin.cmd({cmd:e})}setOption(e,t){return this.send(`setoption name ${e} value ${t}`)}setVariant(){return this.isVariant()?"web"!==n.getPlatform()&&"threeCheck"===this.variant?this.setOption("UCI_Variant","3check"):"web"===n.getPlatform()&&"antichess"===this.variant?this.setOption("UCI_Variant","giveaway"):this.setOption("UCI_Variant",this.variant.toLowerCase()):this.setOption("UCI_Chess960","chess960"===this.variant)}exit(){return this.plugin.exit()}isVariant(){return!("standard"===this.variant||"fromPosition"===this.variant||"chess960"===this.variant)}}async function wd(){return Promise.resolve(window.deviceInfo.stockfishMaxMemory)}function yd(){const e=window.deviceInfo.cpuCores;return e>2?e-1:1}function kd(){return"android"===n.getPlatform()?"arm64-v8a"===window.lichess.cpuArch:"ios"===n.getPlatform()}var Sd,Cd;!function(e){e.Documents="DOCUMENTS",e.Data="DATA",e.Library="LIBRARY",e.Cache="CACHE",e.External="EXTERNAL",e.ExternalStorage="EXTERNAL_STORAGE",e.ExternalCache="EXTERNAL_CACHE",e.LibraryNoCloud="LIBRARY_NO_CLOUD",e.Temporary="TEMPORARY"}(Sd||(Sd={})),function(e){e.UTF8="utf8",e.ASCII="ascii",e.UTF16="utf16"}(Cd||(Cd={}));const Td=r("Filesystem",{web:()=>import("./web-cf465c6a.js").then((e=>new e.FilesystemWeb))});var Pd,Ed;!function(e=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},void 0===window.Capacitor||e?void 0!==window.cordova&&function(e){e.CapacitorUtils.Synapse=new Proxy({},{get:(t,n)=>e.cordova.plugins[n]})}(window):function(e){e.CapacitorUtils.Synapse=new Proxy({},{get:(t,n)=>new Proxy({},{get:(t,r)=>(t,i,a)=>{const o=e.Capacitor.Plugins[n];void 0!==o?"function"==typeof o[r]?(async()=>{try{const e=await o[r](t);i(e)}catch(e){a(e)}})():a(new Error(`Method ${r} not found in Capacitor plugin ${n}`)):a(new Error(`Capacitor plugin ${n} not found`))}})})}(window))}(),function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Pd||(Pd={})),function(e){e.None="NONE",e.Slide="SLIDE",e.Fade="FADE"}(Ed||(Ed={}));const Od=r("StatusBar"),xd="https://veloce.github.io/lichobile-themes";let _d,Md;function Nd(e){return"dark"!==e&&"light"!==e&&"system"!==e}function jd(e,t){return Td.readFile({path:e+"-"+t,directory:Sd.Data})}function Dd(e){return Td.readdir({path:"",directory:Sd.Data}).then((({files:t})=>t.map((e=>e.name)).filter((t=>t.startsWith(e)))))}function Ld(e){return e.key+"."+e.ext}function Id(e,t,n){const r=Ad(e,t);return jd(e,r).catch((()=>function(e,t,n){return new Promise(((r,i)=>{const a=new XMLHttpRequest,o="bg"===e?"/background":"/board";a.open("GET",`${xd}${o}/${t}`,!0),a.responseType="blob",n&&(a.onprogress=n),a.onload=()=>{if(200===a.status){const n=a.response;if(n){const i=new FileReader;i.readAsDataURL(n),i.onloadend=()=>{const n=i.result;Td.writeFile({path:e+"-"+t,data:n,directory:Sd.Data}).then((()=>r()))}}else i("could not get file")}else i(`Request returned ${a.status}`)},a.send()}))}(e,r,n).then((()=>jd(e,r))))).then((n=>{Rd(e,t,r,n)}))}function qd(e){z.show({text:"Cannot load theme file",duration:"short"})}function Rd(e,t,n,{data:r}){_d||(_d=document.createElement("style"),_d.type="text/css",document.head.appendChild(_d));const i=r,a=("png"===n.split(".").pop()?"data:image/png;base64,":"data:image/jpeg;base64,")+i,o="bg"===e?`.view-container.transp.${t} > main { background-image: url(${a}); }`:`:root { --board-background: url(${a}); }\n.board-${t} > .cg-board { background-image: var(--board-background); }\n.game_menu_button.${t}::before { background-image: var(--board-background); background-size: 40px; }`;_d.appendChild(document.createTextNode(o))}function Ad(e,t){return Ld(("bg"===e?lt.general.theme.availableBackgroundThemes:lt.general.theme.availableBoardThemes).find((e=>e.key===t)))}function Bd(){if(void 0===Md){const e=window.matchMedia("(prefers-color-scheme: light)");Md=e.matches?"light":"dark",e.addEventListener("change",(e=>{Md=e.matches?"light":"dark"}))}return Md}function $d(e){const t="system"===e?Bd():e;return Promise.all(["android"===n.getPlatform()?Od.setBackgroundColor({color:"light"===t?"#edebe9":"dark"===t?"#161512":"#000000"}):Promise.resolve(),Od.setStyle({style:"light"===t?Pd.Light:Pd.Dark})]).then((()=>{}))}var Fd={init(){!function(e){e(ii)}((e=>{e.add("",(({params:e})=>{import("./home-a2a1f1be.js").then((t=>{li(t.default,e)}))})),e.add("timeline",(({params:e})=>{import("./timeline-d414b2c8.js").then((t=>{li(t.default,e)}))})),e.add("otb",(({params:e})=>{import("./otb-16a6d303.js").then((t=>{li(t.default,e)}))})),e.add("otb/variant/:variant/fen/:fen",(({params:e})=>{import("./otb-16a6d303.js").then((t=>{li(t.default,e)}))})),e.add("ai",(({params:e})=>{import("./ai-fb666c84.js").then((t=>{li(t.default,e)}))})),e.add("ai/variant/:variant/fen/:fen/color/:color",(({params:e})=>{import("./ai-fb666c84.js").then((t=>{li(t.default,e)}))})),e.add("game/:id",(({params:e})=>{import("./game-c563e8e0.js").then((t=>{li(t.default,e)}))})),e.add("tournament/:tournamentId/game/:id",(({params:e})=>{import("./game-c563e8e0.js").then((t=>{li(t.default,e)}))})),e.add("analyse/:source/:id/:color",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("analyse/:source/:id",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("analyse/fen/:fen",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("analyse/variant/:variant",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("analyse/variant/:variant/fen/:fen",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("analyse",(({params:e})=>{import("./analyse-0e344473.js").then((t=>{li(t.default,e)}))})),e.add("importer",(({params:e})=>{import("./importer-13328a11.js").then((t=>{li(t.default,e)}))})),e.add("tv",(({params:e})=>{import("./tv-ae3ac537.js").then((t=>{li(t.default,e)}))})),e.add("tv/:channel",(({params:e})=>{import("./tv-ae3ac537.js").then((t=>{li(t.default,e)}))})),e.add("@/:id",(({params:e})=>{import("./user-96c0b365.js").then((t=>{li(t.default,e)}))})),e.add("@/:id/related",(({params:e})=>{import("./related-6b0bebc2.js").then((t=>{li(t.default,e)}))})),e.add("@/:id/games",(({params:e})=>{import("./games-7d40afcc.js").then((t=>{li(t.default,e)}))})),e.add("@/:id/games/:filter",(({params:e})=>{import("./games-7d40afcc.js").then((t=>{li(t.default,e)}))})),e.add("@/:id/:perf/perf",(({params:e})=>{import("./perfStats-0ceaa2f0.js").then((t=>{li(t.default,e)}))})),e.add("@/:id/tv",(({params:e})=>{import("./userTv-3647ffca.js").then((t=>{li(t.default,e)}))})),e.add("about",(({params:e})=>{import("./about-f25e1112.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences",(({params:e})=>{import("./preferences-1c633d3f.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences/game-display",(({params:e})=>{import("./gameDisplay-1cb4e820.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences/game-behavior",(({params:e})=>{import("./gameBehavior-731e948e.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences/clock",(({params:e})=>{import("./clock-52cdcda9.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences/privacy",(({params:e})=>{import("./privacy-51f42c0c.js").then((t=>{li(t.default,e)}))})),e.add("account/preferences/kidMode",(({params:e})=>{import("./kid-5ee20a39.js").then((t=>{li(t.default,e)}))})),e.add("clock",(({params:e})=>{import("./clock-60e0da60.js").then((t=>{li(t.default,e)}))})),e.add("editor",(({params:e})=>{import("./editor-a8154d55.js").then((t=>{li(t.default,e)}))})),e.add("editor/:fen",(({params:e})=>{import("./editor-a8154d55.js").then((t=>{li(t.default,e)}))})),e.add("inbox",(({params:e})=>{import("./msg-3a1abe2e.js").then((t=>{li(t.default,e)}))})),e.add("inbox/:id",(({params:e})=>{import("./msg-3a1abe2e.js").then((t=>{li(t.default,e)}))})),e.add("inbox/new",(({params:e})=>{import("./msg-3a1abe2e.js").then((t=>{li(t.default,e)}))})),e.add("inbox/new/:id",(({params:e})=>{import("./msg-3a1abe2e.js").then((t=>{li(t.default,e)}))})),e.add("players",(({params:e})=>{import("./players-ef1e467b.js").then((t=>{li(t.default,e)}))})),e.add("search",(({params:e})=>{import("./search-1759ae4e.js").then((t=>{li(t.default,e)}))})),e.add("settings",(({params:e})=>{import("./settings-45ceb0b9.js").then((t=>{li(t.default,e)}))})),e.add("settings/gameDisplay",(({params:e})=>{import("./gameDisplay-dc22876b.js").then((t=>{li(t.default,e)}))})),e.add("settings/clock",(({params:e})=>{import("./clock-18befa72.js").then((t=>{li(t.default,e)}))})),e.add("settings/gameBehavior",(({params:e})=>{import("./gameBehavior-b3cf9f87.js").then((t=>{li(t.default,e)}))})),e.add("settings/bluetooth",(({params:e})=>{import("./bluetooth-ffe5bbe7.js").then((t=>{li(t.default,e)}))})),e.add("settings/soundNotifications",(({params:e})=>{import("./soundNotifications-01429fbc.js").then((t=>{li(t.default,e)}))})),e.add("settings/background",(({params:e})=>{import("./background-1d3fa12f.js").then((t=>{li(t.default,e)}))})),e.add("settings/themes/board",(({params:e})=>{import("./boardTheme-6c481c96.js").then((t=>{li(t.default,e)}))})),e.add("settings/themes/piece",(({params:e})=>{import("./pieceThemes-21e1e921.js").then((t=>{li(t.default,e)}))})),e.add("settings/lang",(({params:e})=>{import("./lang-14964f8c.js").then((t=>{li(t.default,e)}))})),e.add("teams",(({params:e})=>{import("./teamsList-7fb44746.js").then((t=>{li(t.default,e)}))})),e.add("teams/:id",(({params:e})=>{import("./teamDetail-9ab58ff6.js").then((t=>{li(t.default,e)}))})),e.add("training",(({params:e})=>{import("./training-abe0ebfd.js").then((t=>{li(t.default,e)}))})),e.add("training/:id",(({params:e})=>{import("./training-abe0ebfd.js").then((t=>{li(t.default,e)}))})),e.add("tournament",(({params:e})=>{import("./tournamentList-7665f097.js").then((t=>{li(t.default,e)}))})),e.add("tournament/:id",(({params:e})=>{import("./tournamentDetail-41dd8a4d.js").then((t=>{li(t.default,e)}))})),e.add("study",(({params:e})=>{import("./studyIndex-36b52887.js").then((t=>{li(t.default,e)}))})),e.add("study/:id",(({params:e})=>{import("./study-a5166df5.js").then((t=>{li(t.default,e)}))})),e.add("study/:id/:chapterId",(({params:e})=>{import("./study-a5166df5.js").then((t=>{li(t.default,e)}))})),e.add("coord",(({params:e})=>{import("./coordinates-bad6a752.js").then((t=>{li(t.default,e)}))}))})),window.addEventListener("popstate",ui)}};let Ud=!1,zd=!1,Wd=null;var Hd={open:function(){bi.backbutton.stack.push(qi(Kd,"loginModal")),Ud=!0,zd=!1,Wd=null},close:Kd,view:()=>Ud?An("div.modal#loginModal",{oncreate:Ii},[An("header",[An("button.modal_close",{oncreate:Ui(qi(Kd,"loginModal"))},Eu),An("h2",yt("signIn"))]),An("div.modal_content",[An("form.defaultForm.login",{onsubmit:Vd},[Wd&&!Gd(Wd)?An("div.form-error",Wd):null,"InvalidTotpToken"===Wd?An("div.form-error",yt("invalidAuthenticationCode")):null,An("div.field",[An("input#username",{type:Gd(Wd)?"hidden":"text",className:Wd?"form-error":"",placeholder:yt("username"),autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:!1,required:!0})]),An("div.field",[An("input#password",{type:Gd(Wd)?"hidden":"password",className:Wd?"form-error":"",placeholder:yt("password"),required:!0})]),Gd(Wd)?[An("div.field",[An("input#token[type=number]",{className:"MissingTotpToken"!==Wd?"form-error":"",placeholder:yt("authenticationCode"),pattern:"\\d{6}",required:!0})]),An("p.twofactorhelp",[An("i.fa.fa-mobile-phone"),An.trust("&nbsp"),"Open the two-factor authentication app on your device to view your authentication code and verify your identity."])]:null,An("div.submit",[An("button.defaultButton",{disabled:zd},yt("signIn"))])]),An("div.loginActions",[An("a",{oncreate:Ui(Zd.open)},[yt("signUp")]),An("a",{href:"https://lichess.org/password/reset"},[yt("passwordReset")])])])]):null};function Vd(e){if(zd)return!1;e.preventDefault();const t=e.target,n=t.username.value.trim(),r=t.password.value,i=t.token?t.token.value:null;n&&r&&(Kt(),p.hide(),zd=!0,Yr.login(n,r,i).then((()=>{zd=!1,Kd(),Ut.afterLogin.dispatch(),Kt(),Ea.reconnectCurrent(),Yn.register(),jr.refresh(),Yr.refresh()})).catch((e=>{zd=!1,e.body.ipban?Kd():400!==e.status&&401!==e.status?rn(e):e.body.global&&(Wd=e.body.global[0],Kt())})))}function Gd(e){return"MissingTotpToken"===e||"InvalidTotpToken"===e}function Kd(e){p.hide(),"backbutton"!==e&&Ud&&bi.backbutton.stack.pop(),Ud=!1}let Yd=!1,Xd=!1,Qd=!1,Jd=null;var Zd={open:function(){bi.backbutton.stack.push(qi(ih,"signupModal")),Jd=null,Yd=!0,Xd=!1},close:ih,view:()=>Yd?An("div.modal#signupModal",{oncreate:Ii},[An("header",[An("button.modal_close",{oncreate:Ui(qi(ih,"signupModal"))},Eu),An("h2",yt("signUp"))]),An("div#signupModalContent.modal_content",{},Qd?[An("h1.signup-emailCheck.withIcon[data-icon=E]",yt("checkYourEmail")),An("p",yt("weHaveSentYouAnEmailClickTheLink")),An("p",yt("ifYouDoNotSeeTheEmailCheckOtherPlaces")),An("p","Not receiving it? Visit https://lichess.org/contact to request a manual confirmation.")]:[An("p.signupWarning.withIcon[data-icon=!]",[yt("computersAreNotAllowedToPlay")]),An("p.tosWarning",["By registering, you agree to be bound by our ",An("a",{oncreate:Ui((()=>window.open("https://lichess.org/terms-of-service","_blank")))},"Terms of Service"),"."]),An("form.defaultForm.login",{onsubmit:rh},[An("div.field",[Jd&&Jd.username?An("div.form-error",Jd.username[0]):null,An("input#pseudo[type=text]",{className:Jd&&Jd.username?"form-error":"",placeholder:yt("username"),autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:!1,required:!0,onfocus:nh,oninput:U(eh,500)})]),An("div.field",[Jd&&Jd.email?An("div.form-error",Jd.email[0]):null,An("input#email[type=email]",{onfocus:nh,className:Jd&&Jd.email?"form-error":"",placeholder:yt("email"),autocapitalize:"off",autocorrect:"off",spellcheck:!1,required:!0})]),An("div.field",[Jd&&Jd.password?An("div.form-error",Jd.password[0]):null,An("input#password[type=password]",{onfocus:nh,className:Jd&&Jd.password?"form-error":"",placeholder:yt("password"),required:!0})]),An("div.submit",[An("button.defaultButton",{disabled:Xd},yt("signUp"))])])])]):null};function eh(e){const t=e.target.value.trim();var n;t&&t.match(/^[a-z0-9][\w-]{2,29}$/i)?(n=t,Gn("/api/player/autocomplete?exists=1",{query:{term:n}})).then((e=>{th(e)})):th(!1)}function th(e){Jd=e?{username:["This username is already in use, please try another one."]}:null,Kt()}function nh(e){setTimeout((()=>{e.target.scrollIntoView(!0)}),300)}function rh(e){e.preventDefault();const t=e.target,n=t[0].value.trim(),r=t[1].value.trim(),i=t[2].value;!Xd&&n&&r&&i&&(p.hide(),Xd=!0,Jd=null,Kt(),Yr.signup(n,r,i).then((e=>{Xd=!1,e&&function(e){return void 0!==e.email_confirm}(e)?(Qd=!0,Kt()):(Ea.reconnectCurrent(),Kt(),Hd.close(),ih())})).catch((e=>{Xd=!1,void 0!==e.body.error?(Jd=e.body.error,Kt()):rn(e)})))}function ih(e){!0===Qd&&Hd.close(),p.hide(),"backbutton"!==e&&Yd&&bi.backbutton.stack.pop(),Yd=!1}const ah=":r1/:r2/:r3/:r4/:r5/:r6/:r7/:r8";function oh(e){return e.r1+"/"+e.r2+"/"+e.r3+"/"+e.r4+"/"+e.r5+"/"+e.r6+"/"+e.r7+"/"+e.r8.split("_").join(" ")}var sh={init(){s.addListener("appUrlOpen",(({url:e})=>{setTimeout((()=>{const t=new URL(e),n=t.pathname;if(!ch.run(n)){const e=lh.exec(n);if(e){const n=e[2],r=uh.exec(t.hash),i={};n&&(i.color=n.substring(1)),r&&(i.ply=r[1]);const a=Un(i);bi.set(`/game/${e[1]}?${a}`)}}}),100)}))}};const ch=new ei,lh=/^\/(\w{8})(\/black|\/white)?$/,uh=/^#(\d+)$/;ch.add("analysis",(()=>bi.set("/analyse"))),ch.add(`analysis/${ah}`,(({params:e})=>{const t=encodeURIComponent(oh(e));bi.set(`/analyse/fen/${t}`)})),ch.add("editor",(()=>bi.set("/editor"))),ch.add(`editor/${ah}`,(({params:e})=>{const t=encodeURIComponent(oh(e));bi.set(`/editor/${t}`)})),ch.add("inbox",(()=>bi.set("/inbox"))),ch.add("inbox/new",(()=>bi.set("/inbox/new"))),ch.add("challenge/:id",(({params:e})=>bi.set(`/game/${e.id}`))),ch.add("study",(()=>bi.set("/study"))),ch.add("study/:id",(({params:e})=>bi.set(`/study/${e.id}`))),ch.add("study/:id/:chapterId",(({params:e})=>bi.set(`/study/${e.id}/${e.chapterId}`))),ch.add("player",(()=>bi.set("/players"))),ch.add("tournament",(()=>bi.set("/tournament"))),ch.add("tournament/:id",(({params:e})=>bi.set(`/tournament/${e.id}`))),ch.add("training",(()=>bi.set("/training"))),ch.add("training/:id",(({params:e})=>bi.set(`/training/${e.id}`))),ch.add("tv",(()=>bi.set("/tv"))),ch.add("tv/:channel",(({params:e})=>bi.set(`/tv/${e.channel}`))),ch.add("@/:id",(({params:e})=>bi.set(`/@/${e.id}`))),ch.add("@/:id/tv",(({params:e})=>bi.set(`/@/${e.id}/tv`))),ch.add("@/:id/all",(({params:e})=>bi.set(`/@/${e.id}/games`))),ch.add("@/:id/perf/:key",(({params:e})=>bi.set(`/@/${e.id}/${e.key}/perf`))),ch.add("signup/confirm/:token",(({params:e})=>{const t=e.token;t&&Yr.confirmEmail(t).then((e=>{Zd.close(),bi.set(`/@/${e.id}`)})).catch(rn)}));const dh=r("CPUInfo");(async function(){await Ye.migrate();const e=await Ye.get(it);Object.assign(ct,e)})().then((()=>Promise.all([s.getInfo().catch((()=>({version:At.packageVersion}))),c.getInfo(),c.getId(),"ios"===n.getPlatform()?dh.nbCores().then((e=>e.value)).catch((()=>1)):Promise.resolve(navigator.hardwareConcurrency||1),bd.getMaxMemory().then((e=>e.value)).catch((()=>16)),bd.getCPUArch().then((e=>e.value)).catch((()=>"x86"))]))).then((([e,t,n,r,i,a])=>pd(e,t,n,r,i,a))).then((()=>{Fd.init(),sh.init()})).then((function(){const e=lt.general.theme.background(),t=lt.general.theme.board();if($d(e),Nd(e)){const t=Ad("bg",e);jd("bg",t).then((n=>{Rd("bg",e,t,n)})).catch((()=>{lt.general.theme.background("dark")}))}if(!lt.general.theme.bundledBoardThemes.includes(t)){const e=Ad("board",t);jd("board",e).then((n=>{Rd("board",t,e,n)})).catch((()=>{lt.general.theme.board("brown")}))}})).then((async function(){const e=import("./i18n/"+dt+".js").then((({default:e})=>{Object.assign(ht,e)})),t=lt.general.locale();return t&&void 0!==Lt[t]?e.then((()=>jt(t))):e.then((()=>c.getLanguageCode())).then((({value:e})=>jt(Mt(e)||dt)))})).then(zc.init).then((()=>ui())).then((()=>{setTimeout((()=>{l.hide()}),500)}));export{Ui as $,s as A,za as B,n as C,Ja as D,Ya as E,Hi as F,St as G,Qn as H,Ka as I,an as J,Qa as K,Xa as L,to as M,u as N,Fa as O,ra as P,Za as Q,eo as R,Jc as S,yl as T,ku as U,fl as V,WebPlugin as W,pl as X,au as Y,Jr as Z,uu as _,Ut as a,Kn as a$,Kc as a0,tt as a1,dr as a2,rn as a3,Ua as a4,xt as a5,Eu as a6,Cn as a7,Rr as a8,Gi as a9,ha as aA,pa as aB,Au as aC,$n as aD,Wu as aE,lo as aF,Vc as aG,Ht as aH,Ni as aI,zi as aJ,fc as aK,Nu as aL,_u as aM,Ru as aN,ta as aO,$u as aP,uo as aQ,Fu as aR,Oo as aS,Eo as aT,_a as aU,ln as aV,qi as aW,p as aX,Sn as aY,Ii as aZ,LRUMap as a_,ro as aa,Hd as ab,Zd as ac,wu as ad,ed as ae,Bd as af,Mu as ag,kt as ah,cn as ai,Ye as aj,z as ak,r as al,At as am,Tt as an,nn as ao,wn as ap,Et as aq,Vi as ar,fn as as,rr as at,bo as au,mo as av,un as aw,uc as ax,Yi as ay,Zi as az,Yr as b,Il as b$,Wn as b0,As as b1,Bs as b2,A as b3,fa as b4,Chessground as b5,pn as b6,Tn as b7,ho as b8,StockfishPlugin as b9,Zt as bA,kd as bB,ql as bC,Wl as bD,Gl as bE,zl as bF,SquareSet as bG,Ul as bH,Nl as bI,jl as bJ,Kl as bK,Tr as bL,Qe as bM,Mo as bN,ni as bO,m as bP,Ki as bQ,cc as bR,Xt as bS,SideMenuCtrl as bT,gc as bU,sc as bV,vo as bW,Pt as bX,vc as bY,Dl as bZ,$l as b_,yd as ba,wd as bb,dc as bc,hc as bd,pc as be,hn as bf,vr as bg,jr as bh,gr as bi,fr as bj,mr as bk,kr as bl,_i as bm,xi as bn,so as bo,zu as bp,_n as bq,sr as br,lc as bs,mc as bt,Er as bu,Sr as bv,dd as bw,fo as bx,go as by,en as bz,Ot as c,Board as c0,Ol as c1,Fl as c2,Yl as c3,Material as c4,RemainingChecks as c5,na as c6,Mi as c7,Di as c8,ms as c9,Ld as cA,Lu as cB,Lt as cC,Mt as cD,It as cE,Nt as cF,Pr as cG,jt as cH,kn as cI,vn as cJ,gn as cK,dn as cL,mn as cM,Ri as cN,Ai as cO,ia as cP,Uu as cQ,bn as cR,Ou as cS,xu as cT,Pn as cU,o as cV,Cd as cW,Qs as cX,Xs as cY,Ks as cZ,co as ca,Od as cb,Fi as cc,Xl as cd,Ql as ce,Jt as cf,ru as cg,Ma as ch,Na as ci,ja as cj,Da as ck,qa as cl,La as cm,Ia as cn,MessageSocket as co,aa as cp,Pu as cq,ea as cr,oa as cs,zc as ct,Bc as cu,Nd as cv,Id as cw,qd as cx,$d as cy,Dd as cz,U as d,yr as e,Gn as f,lt as g,On as h,tr as i,Cr as j,bi as k,wr as l,An as m,on as n,yt as o,Wi as p,yn as q,Kt as r,Ea as s,Or as t,Bu as u,Li as v,Wa as w,ji as x,Ha as y,Va as z};
