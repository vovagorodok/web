import{r as e,ac as t,D as a,s,o as l,u as i,q as o,p as n,B as r,m as c,G as g,F as u,H as h,am as f}from"./main.js";import{l as m}from"./layout-ae040024.js";import{a as d,f as p,d as N}from"./userXhr-d3b3ac60.js";class RelatedCtrl{constructor(l,i){this.userId=l,this.defaultTab=i,this.isLoadingNextPage=!1,this.loadNextPage=a=>{this.isLoadingNextPage=!0,this.getData(this.userId,a).then((()=>{this.isLoadingNextPage=!1,e()})).catch(t),e()},this.toggleFollowing=e=>{e.relation?d(e.user).then((t=>this.setNewUserState(e,t))):p(e.user).then((t=>this.setNewUserState(e,t)))},this.challenge=e=>{a.open(e)},s.createDefault(),this.getData(this.userId,1).then(e).catch(t)}getData(e,t){return N(e,t).then((e=>{this.following=(this.following||[]).concat(e.paginator.currentPageResults),this.followingPaginator=e.paginator}))}setNewUserState(t,a){t.relation=a.following,e()}}function w(e){return function(e,t,a){if(t){if(t.length){const s=a&&a.nextPage;return l("ul",{className:"native_scroller page"},t.map(((t,a)=>function(e,t,a){const s=t.online?"online":"offline",i=t.perfs&&Object.keys(t.perfs)[0],g=t.perfs&&t.perfs[i],u=o((()=>c.set(`/@/${t.user}`))),h=a%2==0?"even":"odd";return l("li",{className:`list_item followingList ${h}`},l("div",{className:"followingPlayerTitle",oncreate:u},l("div",{className:"user"},t.patron?l("span",{className:"patron userStatus "+s,"data-icon":""}):l("span",{className:"fa fa-circle userStatus "+s}),t.title?l("span",{className:"userTitle"},t.title," "):null,t.user),i?l("span",{className:"rating","data-icon":r(i)},g.rating):null),t.followable?l("div",{className:"followingPlayerItem"},l("div",{className:"check_container"},l("label",null,n("follow")),l("input",{type:"checkbox",checked:t.relation,onchange:()=>e.toggleFollowing(t)}))):null)}(e,t,a))),s?l("li",{className:"list_item followingList moreFollow",oncreate:o((()=>e.loadNextPage(s)))},e.isLoadingNextPage?i.getVdom("monochrome"):"..."):null)}return l("div",{className:"followingListEmpty"},"Oops! Nothing here.")}return l("div",{className:"followingListEmpty"},i.getVdom("monochrome"))}(e,e.following,e.followingPaginator)}var P={oncreate:g,oninit(e){this.ctrl=new RelatedCtrl(e.attrs.id,u(e.attrs.tab))},view(){const e=l("div.title",[l("span",n("friends"))]);return m.free(h(null,f(e)),w(this.ctrl))}};export{P as default};
