import{a5 as e,o as a,y as c,a6 as n,g as t,m as o,ci as i,r as l,af as s,cj as r,ap as u,G as k,aL as d,I as m,A as f,aM as g}from"./main.js";import{l as p}from"./layout-ae040024.js";import{c as b,a as h,f as v,i as S}from"./clockSet-be46f3b1.js";var w={controller(e,a){let c=!1;function n(e){"backbutton"!==e&&c&&o.backbutton.stack.pop(),c=!1}return{open:function(){a().isRunning()&&!a().flagged()||(o.backbutton.stack.push(n),c=!0)},close:n,isOpen:function(){return c},reload:e}},view:o=>o.isOpen()?e("new_offline_game clock_settings",void 0,(function(){return a("div",null,a("div",{className:"action"},a("div",{className:"select_input"},n.renderSelect("Clock","clock",t.clock.availableClocks,t.clock.clockType,!1,T)),b(t.clock.clockType(),T)),a("button",{className:"newClockButton","data-icon":"E",oncreate:c((function(){o.reload(),o.close()}))},"Set Clock"))}),o.isOpen(),o.close):null};function T(){i.hide(),l()}function N(){}function j(e,c){const n=e.getState(),t="white"===c?n.whiteStage:n.blackStage;return a("div",{className:"clockStageInfo"},a("span",null,"Stage ",t+1))}function y(e){return null!==e?a("div",{className:"clockStageInfo"},a("span",null,"Moves remaining: ",e)):null}function C(e,a){("white"!==e.clockObj().activeSide()&&"black"===a||"black"!==e.clockObj().activeSide()&&"white"===a)&&e.clockTap(a)}const M=u("FullScreen");function R(){i.hide()}const O={oncreate:k,oninit(){d(),"android"===m.getPlatform()&&M.hideSystemUI(),R(),f.addListener("appStateChange",(e=>{e.isActive&&R()})).then((e=>this.appStateListener=e)),window.addEventListener("resize",R),this.ctrl=function(){const e=s(t.clock.clockType()),a=s(h[e()](N));let c=1;function n(){a()&&a().isRunning()&&!a().flagged()||(e(t.clock.clockType()),a(h[e()](N)),c=1)}return{startStop:function(){a().startStop()},clockSettingsCtrl:w.controller(n,a),clockObj:a,reload:n,goHome:function(){a().isRunning()&&!a().flagged()||o.set("/")},clockTap:function(e){a().clockHit(e),c+=.5},clockType:e,getMove:function(){return Math.floor(c)}}}()},onremove(){const e=this.ctrl.clockObj();void 0!==e&&e.clear(),g(),this.appStateListener.remove(),window.removeEventListener("resize",R),i.show(),"android"===m.getPlatform()&&M.showSystemUI()},view(){return p.clock((()=>function(e){const n=e.clockObj();if(!n)return null;const t="white"===n.activeSide(),o="black"===n.activeSide(),i="white"===n.flagged(),l="black"===n.flagged(),s=i||l,u=["clockTapArea","white",t?"active":"",n.isRunning()?"running":"",i?"flagged":""].join(" "),k=["clockTapArea","black",o?"active":"",n.isRunning()?"running":"",l?"flagged":""].join(" "),d=["clockTime",i?"flagged":"",n.whiteTime()>=3600?"long":""].join(" "),m=["clockTime",n.whiteTime()<6e4&&!i?"short":"noshort"].join(" "),f=["clockTime",l?"flagged":"",n.blackTime()>=3600?"long":""].join(" "),g=["clockTime",n.blackTime()<6e4&&!l?"short":"noshort"].join(" ");return a("div",{className:"clockContainer"},a("div",{className:u,oncreate:r((()=>C(e,"white")))},S(n)?j(n,"white"):null,S(n)?y(n.whiteMoves()):null,a("div",{className:"clockTapAreaContent"},a("span",{className:d},i?"b":v(e.clockType(),n.whiteTime()/1e3)),a("span",{className:m},"."+Math.trunc(n.whiteTime()/100%10)))),a("div",{className:"clockControls"},a("button",{className:"fa"+(n.isRunning()?" fa-pause":" fa-play"),oncreate:c((()=>e.startStop())),disabled:s||!n.activeSide()}),a("button",{className:"fa fa-refresh"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.reload)}),a("button",{className:"fa fa-cog"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.clockSettingsCtrl.open)}),a("button",{hey:"home",className:"fa fa-home"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.goHome)}),a("span",{className:"moveNumber"},e.getMove())),a("div",{className:k,oncreate:r((()=>C(e,"black")))},a("div",{className:"clockTapAreaContent"},a("span",{className:f},l?"b":v(e.clockType(),n.blackTime()/1e3)),a("span",{className:g},"."+Math.trunc(n.blackTime()/100%10))),S(n)?j(n,"black"):null,S(n)?y(n.blackMoves()):null))}(this.ctrl)),(()=>{return e=this.ctrl,[w.view(e.clockSettingsCtrl)];var e}))}};export{O as default};
