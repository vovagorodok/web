import{r as e,a3 as t,ak as a,u as n,ag as i,m as o,o as s,G as r,v as m}from"./main.js";import{b as u,j as l,l as d}from"./teamsXhr-5a9ef5f8.js";import{l as c}from"./layout-b3635a82.js";class TeamCtrl{constructor(a){this.teamId=a,u(a).then((t=>{this.team=t,e()})).catch(t)}join(e){const n=this.team;if(!n)return null;const i=n.open?null:e[0].value;l(n.id,i).then((e=>{e.ok||a.show({text:"Join failed",duration:"short"}),this.reload(this.teamId)})).catch(t)}leave(){const e=this.team;if(!e)return null;d(e.id).then((e=>{e.ok||a.show({text:"Leave failed",duration:"short"}),this.reload(this.teamId)})).catch(t)}reload(a){u(a,!0).then((t=>{this.team=t,e()})).catch(t)}}function h(e){const t=e.patron?o("span.patron.userStatus",{"data-icon":"î€™"},[]):null,a=e.title?o("span.userTitle",[e.title+" "]):null;return o("div.user",[o("span",[r("teamLeaders",1)+": "]),t,a,e.name])}function f(e){const t=e.team;if(!t)return null;const a=t.open?null:o("textarea.joinMessage",{id:"message",minLength:30,maxLength:2e3},["Hello, I would like to join the team!"]);return o("div.teamJoinLeave",[o("form",{id:"joinForm",onsubmit:t=>{t.preventDefault(),e.join(t.target)}},[a,o("button.fatButton.joinLeaveButton",{type:"submit"},[o("span.fa.fa-check"),s("joinTeam")])])])}function v(e){return e.team?o("div.teamJoinLeave",[o("form",{id:"leaveForm",onsubmit:t=>{t.preventDefault(),e.leave()}},[o("button.fatButton.joinLeaveButton",{type:"submit"},[o("span.fa.fa-check"),s("quitTeam")])])]):null}var p={oninit({attrs:e}){this.ctrl=new TeamCtrl(e.id)},oncreate:m,view(){const e=this.ctrl,t=function(e){const t=e.team;return t?n(null,i(o("div.main_header_title.withSub",[o("h1",[t.name])]))):null}(e),a=function(e){const t=e.team;return t?o("div.teamPage.native_scroller.page",[o("section.teamInfos",[o("div.teamLeader",t.leaders.map(h)),o("div.teamMembers",[t.nbMembers+" "+s("members")]),o("div.teamDescription",[t.description])]),o("section.teamJoinLeave",[t.requested?o("div.teamRequestPending",[o("span",["Your join request is being reviewed by the team leader."])]):t.joined?v(e):f(e)])]):null}(e);return c.free(t,a,void 0)}};export{p as default};
