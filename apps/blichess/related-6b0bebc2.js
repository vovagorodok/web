import{r as e,a3 as t,ad as a,m as s,aD as l,p as i,o,ai as n,k as r,v as c,q as g,u,ag as h}from"./main.js";import{l as f}from"./layout-b3635a82.js";import{a as m,f as d,d as p}from"./userXhr-e893d0da.js";class RelatedCtrl{constructor(s,l){this.userId=s,this.defaultTab=l,this.isLoadingNextPage=!1,this.loadNextPage=a=>{this.isLoadingNextPage=!0,this.getData(this.userId,a).then((()=>{this.isLoadingNextPage=!1,e()})).catch(t),e()},this.toggleFollowing=e=>{e.relation?m(e.user).then((t=>this.setNewUserState(e,t))):d(e.user).then((t=>this.setNewUserState(e,t)))},this.challenge=e=>{a.open(e)},this.getData(this.userId,1).then(e).catch(t)}getData(e,t){return p(e,t).then((e=>{this.following=(this.following||[]).concat(e.paginator.currentPageResults),this.followingPaginator=e.paginator}))}setNewUserState(t,a){t.relation=a.following,e()}}function N(e){return function(e,t,a){if(t){if(t.length){const c=a&&a.nextPage;return s("ul",{className:"native_scroller page"},t.map(((t,a)=>function(e,t,a){const l=t.online?"online":"offline",c=t.perfs&&Object.keys(t.perfs)[0],g=t.perfs&&t.perfs[c],u=i((()=>r.set(`/@/${t.user}`))),h=a%2==0?"even":"odd";return s("li",{className:`list_item followingList ${h}`},s("div",{className:"followingPlayerTitle",oncreate:u},s("div",{className:"user"},t.patron?s("span",{className:"patron userStatus "+l,"data-icon":""}):s("span",{className:"fa fa-circle userStatus "+l}),t.title?s("span",{className:"userTitle"},t.title," "):null,t.user),c?s("span",{className:"rating","data-icon":n(c)},g.rating):null),t.followable?s("div",{className:"followingPlayerItem"},s("div",{className:"check_container"},s("label",null,o("follow")),s("input",{type:"checkbox",checked:t.relation,onchange:()=>e.toggleFollowing(t)}))):null)}(e,t,a))),c?s("li",{className:"list_item followingList moreFollow",oncreate:i((()=>e.loadNextPage(c)))},e.isLoadingNextPage?l.getVdom("monochrome"):"..."):null)}return s("div",{className:"followingListEmpty"},"Oops! Nothing here.")}return s("div",{className:"followingListEmpty"},l.getVdom("monochrome"))}(e,e.following,e.followingPaginator)}var w={oncreate:c,oninit(e){this.ctrl=new RelatedCtrl(e.attrs.id,g(e.attrs.tab))},view(){const e=s("div.title",[s("span",o("friends"))]);return f.free(u(null,h(e)),N(this.ctrl))}};export{w as default};
