import{V as e,m as a,$ as c,X as n,g as t,k as o,cb as l,r as i,a7 as s,cc as r,al as u,v as k,aA as d,C as m,A as g,aB as f}from"./main.js";import{l as p}from"./layout-b3635a82.js";import{c as b,a as h,f as v,i as S}from"./clockSet-92fe743e.js";var w={controller(e,a){let c=!1;function n(e){"backbutton"!==e&&c&&o.backbutton.stack.pop(),c=!1}return{open:function(){a().isRunning()&&!a().flagged()||(o.backbutton.stack.push(n),c=!0)},close:n,isOpen:function(){return c},reload:e}},view:o=>o.isOpen()?e("new_offline_game clock_settings",void 0,(function(){return a("div",null,a("div",{className:"action"},a("div",{className:"select_input"},n.renderSelect("Clock","clock",t.clock.availableClocks,t.clock.clockType,!1,T)),b(t.clock.clockType(),T)),a("button",{className:"newClockButton","data-icon":"E",oncreate:c((function(){o.reload(),o.close()}))},"Set Clock"))}),o.isOpen(),o.close):null};function T(){l.hide(),i()}function N(){}function j(e,c){const n=e.getState(),t="white"===c?n.whiteStage:n.blackStage;return a("div",{className:"clockStageInfo"},a("span",null,"Stage ",t+1))}function C(e){return null!==e?a("div",{className:"clockStageInfo"},a("span",null,"Moves remaining: ",e)):null}function y(e,a){("white"!==e.clockObj().activeSide()&&"black"===a||"black"!==e.clockObj().activeSide()&&"white"===a)&&e.clockTap(a)}const R=u("FullScreen");function M(){l.hide()}const O={oncreate:k,oninit(){d(),"android"===m.getPlatform()&&R.hideSystemUI(),M(),g.addListener("appStateChange",(e=>{e.isActive&&M()})).then((e=>this.appStateListener=e)),window.addEventListener("resize",M),this.ctrl=function(){const e=s(t.clock.clockType()),a=s(h[e()](N));let c=1;function n(){a()&&a().isRunning()&&!a().flagged()||(e(t.clock.clockType()),a(h[e()](N)),c=1)}return{startStop:function(){a().startStop()},clockSettingsCtrl:w.controller(n,a),clockObj:a,reload:n,goHome:function(){a().isRunning()&&!a().flagged()||o.set("/")},clockTap:function(e){a().clockHit(e),c+=.5},clockType:e,getMove:function(){return Math.floor(c)}}}()},onremove(){const e=this.ctrl.clockObj();void 0!==e&&e.clear(),f(),this.appStateListener.remove(),window.removeEventListener("resize",M),l.show(),"android"===m.getPlatform()&&R.showSystemUI()},view(){return p.clock((()=>function(e){const n=e.clockObj();if(!n)return null;const t="white"===n.activeSide(),o="black"===n.activeSide(),l="white"===n.flagged(),i="black"===n.flagged(),s=l||i,u=["clockTapArea","white",t?"active":"",n.isRunning()?"running":"",l?"flagged":""].join(" "),k=["clockTapArea","black",o?"active":"",n.isRunning()?"running":"",i?"flagged":""].join(" "),d=["clockTime",l?"flagged":"",n.whiteTime()>=3600?"long":""].join(" "),m=["clockTime",n.whiteTime()<6e4&&!l?"short":"noshort"].join(" "),g=["clockTime",i?"flagged":"",n.blackTime()>=3600?"long":""].join(" "),f=["clockTime",n.blackTime()<6e4&&!i?"short":"noshort"].join(" ");return a("div",{className:"clockContainer"},a("div",{className:u,oncreate:r((()=>y(e,"white")))},S(n)?j(n,"white"):null,S(n)?C(n.whiteMoves()):null,a("div",{className:"clockTapAreaContent"},a("span",{className:d},l?"b":v(e.clockType(),n.whiteTime()/1e3)),a("span",{className:m},"."+Math.trunc(n.whiteTime()/100%10)))),a("div",{className:"clockControls"},a("button",{className:"fa"+(n.isRunning()?" fa-pause":" fa-play"),oncreate:c((()=>e.startStop())),disabled:s||!n.activeSide()}),a("button",{className:"fa fa-refresh"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.reload)}),a("button",{className:"fa fa-cog"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.clockSettingsCtrl.open)}),a("button",{hey:"home",className:"fa fa-home"+(n.isRunning()&&!s?" disabled":""),oncreate:c(e.goHome)}),a("span",{className:"moveNumber"},e.getMove())),a("div",{className:k,oncreate:r((()=>y(e,"black")))},a("div",{className:"clockTapAreaContent"},a("span",{className:g},i?"b":v(e.clockType(),n.blackTime()/1e3)),a("span",{className:f},"."+Math.trunc(n.blackTime()/100%10))),S(n)?j(n,"black"):null,S(n)?C(n.blackMoves()):null))}(this.ctrl)),(()=>{return e=this.ctrl,[w.view(e.clockSettingsCtrl)];var e}))}};export{O as default};
