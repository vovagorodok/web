import{m as e,X as t,g as i,a1 as n,$ as c,as as a,r as l,at as r}from"./main.js";const o=1e3,m=6e4,s=100;function u(e,t){return a("hourglass"===e?Math.round(t):Math.floor(t))}function g(e){return void 0!==e.whiteMoves}function d(a,r){return{none:()=>"",simple:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.simple.time,!1,r))),increment:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.increment.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.increment.increment,!1,r))),handicapInc:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Top"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Time","topTime",i.clock.availableTimes,i.clock.handicapInc.topTime,!1,r)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Increment","topIncrement",i.clock.availableIncrements.map(n),i.clock.handicapInc.topIncrement,!1,r))),e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Bottom"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Time","bottomTime",i.clock.availableTimes,i.clock.handicapInc.bottomTime,!1,r)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Increment","bottomIncrement",i.clock.availableIncrements.map(n),i.clock.handicapInc.bottomIncrement,!1,r)))),delay:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.delay.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.delay.increment,!1,r))),bronstein:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.bronstein.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.bronstein.increment,!1,r))),hourglass:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.hourglass.time,!1,r))),stage:()=>e("div",{className:"clockSettingParameters"},i.clock.stage.stages().map(((a,o)=>function(a,r){const o=v.bind(void 0,r),m=f.bind(void 0,r),s=i.clock.stage.stages().length>=5,u=i.clock.stage.stages().length<=2;return e("div",{className:"stageRow"},e("div",{className:"stageRowTitle"},r+1),e("div",{className:"select_input inline stage stageRowMember"},t.renderSelect("Time","time",i.clock.availableTimes,o,!1,a)),e("div",{className:"select_input inline stage stageRowMember"+(r===i.clock.stage.stages().length-1?" lastStage":"")},t.renderSelect("Moves","moves",i.clock.availableMoves.map(n),m,!1,a)),e("div",{className:"stageRowMember addSubtractStage"+(r===i.clock.stage.stages().length-1?" lastStage":"")},e("span",{className:"fa fa-plus-square-o"+(s?" hiddenButton":""),oncreate:c((()=>function(e){const t=e();t[t.length-1].moves=t[t.length-2].moves,t.push({time:t[t.length-1].time,moves:null}),e(t),l()}(i.clock.stage.stages)))})," ",e("span",{className:"fa fa-minus-square-o"+(u?" hiddenButton":""),oncreate:c((()=>function(e){const t=e();t.length<=2||(t.pop(),e(t),l())}(i.clock.stage.stages)))})))}(r,o))),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.stage.increment,!1,r)))}[a]()}function v(e,t){const n=i.clock.stage.stages();return t&&(n[e].time=t,i.clock.stage.stages(n)),n[e].time}function f(e,t){const n=i.clock.stage.stages();return t&&(n[e].moves=t,i.clock.stage.stages(n)),n[e].moves}function k(e,t,i,n,c,a){let o,m,u,g={clockType:"handicapInc",whiteTime:0!==e?e:t,blackTime:0!==i?i:n,whiteIncrement:t,blackIncrement:n,activeSide:void 0,flagged:void 0,isRunning:!1};function d(){const e=performance.now();if("white"===v()){const t=e-m;m=e,g.whiteTime=Math.max(g.whiteTime-t,0),h()<=0&&(g.flagged="white",c(g.flagged),a&&r.dong(),clearInterval(o))}else if("black"===v()){const t=e-u;u=e,g.blackTime=Math.max(g.blackTime-t,0),w()<=0&&(g.flagged="black",c(g.flagged),a&&r.dong(),clearInterval(o))}l()}function v(){return g.activeSide}function f(){return g.flagged}function k(){return g.isRunning}function h(){return g.whiteTime}function w(){return g.blackTime}return{clockType:"handicapInc",getState:function(){return g},setState:function(e){g=e},activeSide:v,flagged:f,isRunning:k,clockHit:function(e){f()||(a&&r.clock(),"white"===e?("white"===v()&&(g.whiteTime=g.whiteTime+g.whiteIncrement),u=performance.now(),g.activeSide="black"):"black"===e&&("black"===v()&&(g.blackTime=g.blackTime+g.blackIncrement),m=performance.now(),g.activeSide="white"),clearInterval(o),o=setInterval(d,s),g.isRunning=!0,l())},startStop:function(){k()?(clearInterval(o),g.isRunning=!1):(g.isRunning=!0,"white"===v()?m=performance.now():u=performance.now(),o=setInterval(d,s))},whiteTime:h,blackTime:w,getTime:function(e){return"white"===e?h():w()},toggleActiveSide:function(){g.activeSide&&("white"===g.activeSide?(u=performance.now(),g.activeSide="black"):(m=performance.now(),g.activeSide="white"))},clear(){clearInterval(o)}}}function h(e,t,i){return k(e,t,e,t,i,!0)}var w={simple:e=>function(e,t){return h(e,0,t)}(Number(i.clock.simple.time())*m,e),increment:e=>h(Number(i.clock.increment.time())*m,Number(i.clock.increment.increment())*o,e),handicapInc:e=>k(Number(i.clock.handicapInc.topTime())*m,Number(i.clock.handicapInc.topIncrement())*o,Number(i.clock.handicapInc.bottomTime())*m,Number(i.clock.handicapInc.bottomIncrement())*o,e,!0),delay:e=>function(e,t,i,n){let c,a,o,m={clockType:"delay",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function u(){const e=performance.now();if("white"===g()){const t=e-a;a=e,Math.floor(m.whiteDelay)>0?m.whiteDelay=m.whiteDelay-t:(m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&r.dong(),clearInterval(c)))}else if("black"===g()){const t=e-o;o=e,m.blackDelay>0?m.blackDelay=m.blackDelay-t:(m.blackTime=Math.max(m.blackTime-t,0),f()<=0&&(m.flagged="black",i(m.flagged),n&&r.dong(),clearInterval(c)))}l()}function g(){return m.activeSide}function d(){return m.flagged}function v(){return m.whiteTime}function f(){return m.blackTime}return{clockType:"delay",getState:function(){return m},setState:function(e){m=e},activeSide:g,flagged:d,isRunning:function(){return m.isRunning},clockHit:function(e){d()||(n&&r.clock(),"white"===e?("white"===m.activeSide&&(m.blackDelay=m.increment),o=performance.now(),m.activeSide="black"):"black"===e&&("black"===m.activeSide&&(m.whiteDelay=m.increment),a=performance.now(),m.activeSide="white"),clearInterval(c),c=setInterval(u,s),m.isRunning=!0,l())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(u,s),"white"===g()?a=performance.now():o=performance.now())},whiteTime:v,blackTime:f,getTime:function(e){return"white"===e?v():f()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(o=performance.now(),m.activeSide="black"):(a=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(Number(i.clock.delay.time())*m,Number(i.clock.delay.increment())*o,e,!0),bronstein:e=>function(e,t,i,n){let c,a,o,m={clockType:"bronstein",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function u(){const e=performance.now();if("white"===m.activeSide){const t=e-a;a=e,m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteDelay=Math.max(m.whiteDelay-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&r.dong(),clearInterval(c))}else if("black"===g()){const t=e-o;o=e,m.blackTime=Math.max(m.blackTime-t,0),m.blackDelay=Math.max(m.blackDelay-t,0),m.blackTime<=0&&(m.flagged="black",i(m.flagged),n&&r.dong(),clearInterval(c))}l()}function g(){return m.activeSide}function d(){return m.whiteTime}function v(){return m.blackTime}return{clockType:"bronstein",getState:function(){return m},setState:function(e){m=e},activeSide:g,flagged:function(){return m.flagged},isRunning:function(){return m.isRunning},clockHit:function(e){m.flagged||(n&&r.clock(),"white"===e?("white"===m.activeSide&&(m.whiteTime=m.whiteTime+(m.increment-m.whiteDelay),m.blackDelay=m.increment),o=performance.now(),m.activeSide="black"):("black"===m.activeSide&&(m.blackTime=m.blackTime+(m.increment-m.blackDelay),m.whiteDelay=m.increment),a=performance.now(),m.activeSide="white"),c&&clearInterval(c),c=setInterval(u,s),m.isRunning=!0,l())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(u,s),"white"===m.activeSide?a=performance.now():o=performance.now())},whiteTime:d,blackTime:v,getTime:function(e){return"white"===e?d():v()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(o=performance.now(),m.activeSide="black"):(a=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(Number(i.clock.bronstein.time())*m,Number(i.clock.bronstein.increment())*o,e,!0),hourglass:e=>function(e,t,i){let n,c,a,o={clockType:"hourglass",whiteTime:e/2,blackTime:e/2,activeSide:void 0,flagged:void 0,isRunning:!1};function m(){const m=performance.now();if("white"===u()){const a=m-c;c=m,o.whiteTime=Math.max(o.whiteTime-a,0),o.blackTime=e-o.whiteTime,v()<=0&&(o.flagged="white",t(o.flagged),i&&r.dong(),clearInterval(n))}else if("black"===u()){const c=m-a;a=m,o.blackTime=Math.max(o.blackTime-c,0),o.whiteTime=e-o.blackTime,f()<=0&&(o.flagged="black",t(o.flagged),i&&r.dong(),clearInterval(n))}l()}function u(){return o.activeSide}function g(){return o.flagged}function d(){return o.isRunning}function v(){return o.whiteTime}function f(){return o.blackTime}return{clockType:"hourglass",getState:function(){return o},setState:function(e){o=e},activeSide:u,flagged:g,isRunning:d,clockHit:function(e){g()||(i&&r.clock(),"white"===e?(a=performance.now(),o.activeSide="black"):(c=performance.now(),o.activeSide="white"),n&&clearInterval(n),n=setInterval(m,s),o.isRunning=!0,l())},startStop:function(){d()?(o.isRunning=!1,clearInterval(n)):(o.isRunning=!0,n=setInterval(m,s),"white"===u()?c=performance.now():a=performance.now())},whiteTime:v,blackTime:f,getTime:function(e){return"white"===e?v():f()},toggleActiveSide:function(){o.activeSide&&("white"===o.activeSide?(a=performance.now(),o.activeSide="black"):(c=performance.now(),o.activeSide="white"))},clear(){clearInterval(n)}}}(Number(i.clock.hourglass.time())*m,e,!0),stage:e=>function(e,t,i,n){let c,a,o,u={clockType:"stage",whiteTime:Number(e[0].time)*m,blackTime:Number(e[0].time)*m,whiteMoves:Number(e[0].moves),blackMoves:Number(e[0].moves),whiteStage:0,blackStage:0,stages:e,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function g(){const e=performance.now();if("white"===u.activeSide){const t=e-a;a=e,u.whiteTime=Math.max(u.whiteTime-t,0),u.whiteTime<=0&&(u.flagged="white",i(u.flagged),n&&r.dong(),clearInterval(c))}else if("black"===u.activeSide){const t=e-o;o=e,u.blackTime=Math.max(u.blackTime-t,0),u.blackTime<=0&&(u.flagged="black",i(u.flagged),n&&r.dong(),clearInterval(c))}l()}function d(){return u.flagged}function v(){return u.whiteMoves}function f(){return u.blackMoves}function k(){return u.whiteTime}function h(){return u.blackTime}return{clockType:"stage",getState:function(){return u},setState:function(e){u=e},activeSide:function(){return u.activeSide},flagged:d,isRunning:function(){return u.isRunning},clockHit:function(e){if(d())return;n&&r.clock();const t=u.whiteMoves,i=u.blackMoves;"white"===e?(null!==t&&(u.whiteMoves=t-1),u.whiteTime=u.whiteTime+u.increment,0===u.whiteMoves&&(u.whiteStage=u.whiteStage+1,u.whiteTime=u.whiteTime+Number(u.stages[u.whiteStage].time)*m,u.whiteStage===u.stages.length-1?u.whiteMoves=null:u.whiteMoves=u.stages[u.whiteStage].moves),o=performance.now(),u.activeSide="black"):(null!==i&&(u.blackMoves=i-1),u.blackTime=u.blackTime+u.increment,0===u.blackMoves&&(u.blackStage=u.blackStage+1,u.blackTime=u.blackTime+Number(u.stages[u.blackStage].time)*m,u.blackStage===u.stages.length-1?u.blackMoves=null:u.blackMoves=u.stages[u.blackStage].moves),a=performance.now(),u.activeSide="white"),c&&clearInterval(c),c=setInterval(g,s),u.isRunning=!0,l()},startStop:function(){u.isRunning?(u.isRunning=!1,clearInterval(c)):(u.isRunning=!0,c=setInterval(g,s),"white"===u.activeSide?a=performance.now():o=performance.now())},whiteTime:k,blackTime:h,whiteMoves:v,blackMoves:f,getTime:function(e){return"white"===e?k():h()},getMoves:function(e){return"white"===e?v():f()},toggleActiveSide:function(){u.activeSide&&("white"===u.activeSide?(o=performance.now(),u.activeSide="black"):(a=performance.now(),u.activeSide="white"))},clear(){clearInterval(c)}}}(i.clock.stage.stages().map((e=>({time:Number(e.time),moves:null!==e.moves?Number(e.moves):null}))),Number(i.clock.stage.increment())*o,e,!0)};export{w as a,d as c,u as f,g as i};
