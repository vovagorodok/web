import{ch as e,r as a,cL as s,J as l,an as i,p as o,e as t,o as n,q as r,cM as d,ai as c,G as h,cN as u,cI as g,cJ as m}from"./main.js";import{l as f}from"./layout-26cca27d.js";const p=t.general.theme;let b;var y={oncreate:e,oninit(){this.loading=!1,this.progress=null,this.selected=p.board(),this.onProgress=e=>{e.lengthComputable&&(this.progress=e,a())},this.stopLoading=()=>{this.progress?(clearTimeout(b),b=setTimeout((()=>{this.loading=!1,this.progress=null,a()}),1500)):(this.loading=!1,this.progress=null,a())},this.isLocal=({key:e,filenames:a})=>p.bundledBoardThemes.includes(e)||a.every((e=>Boolean(this.localFiles&&this.localFiles["board-"+e]))),s("board").then((e=>{this.localFiles=e.reduce(((e,a)=>Object.assign({[a]:"1"},e)),{}),a()}))},view(){const e=l(null,i(o("boardTheme")));return f.free(e,function(e){function s(s){if(e.loading)return;const l=h(s),i=l&&l.dataset.key,o=l&&l.dataset.filenames;if(i&&o){const s=e.selected;e.selected=i,p.bundledBoardThemes.includes(i)?(p.board(i),u(i)):(e.loading=!0,g("board",i,e.onProgress).then((()=>{p.board(i),u(i),o.split(",").forEach((a=>{e.localFiles&&(e.localFiles["board-"+a]="1")})),e.stopLoading()})).catch((a=>{e.selected=s,e.stopLoading(),m()}))),a()}}return[n("div.native_scroller.page.settings_list",[n("ul",{oncreate:r(s,void 0,h)},p.availableBoardThemes.map((a=>{const s=a.key===e.selected,l=d(a),i=e.loading&&s;return n("li.list_item.board_theme",{className:c({selected:s,loading:s&&!!e.loading}),"data-key":a.key,"data-filenames":l.join(",")},[n("span.name",a.name),i||e.isLocal({key:a.key,filenames:l})?null:n("i.fa.fa-cloud-download"),i?n("i.fa.fa-circle-o-notch.fa-spin"):null,!e.loading&&s?n("i.fa.fa-check"):null,n("div.board_thumbnail.vertical_align",{className:a.key})])})))])]}(this))}};export{y as default};
