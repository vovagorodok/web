import{ag as t,t as e,r as a,ad as n,I as s,J as r,an as o,p as i,o as l,q as d,ao as u,G as m,m as c,ap as p,aq as f,ar as y,C as g}from"./main.js";import{l as w}from"./layout-26cca27d.js";const v=["follow","game-end","tour-join","study-create","study-like","forum-post","blog-post","ublog-post","ublog-post-like","stream-start"];var k={oninit(){this.timelineData=t({entries:[],users:{}}),e(20).then((t=>{this.timelineData(N(t)),a()})).catch(n)},oncreate:s,view(){const t=r(null,o(i("timeline"))),e=this.timelineData();return w.free(t,[l("ul.timeline.native_scroller.page",{oncreate:d(h,void 0,m)},e.entries.map((t=>I(t,e.users))))])}};function N(t){return{users:t.users,entries:t.entries.filter((t=>v.includes(t.type))).map((t=>(t.fromNow=u(new Date(t.date)),t)))}}function h(t){const e=m(t),a=e&&e.dataset.path,n=e&&e.dataset.external;a&&c.set(a),n&&p(n)}function I(t,e){switch(t.type){case"follow":return function(t){const e=y("xStartedFollowingY",l("strong",t.data.u1),t.data.u2),a="follow"+t.date;return l("li",{className:"list_item timelineEntry",key:a,"data-path":`/@/${t.data.u2}`},l("span",{className:"fa fa-arrow-circle-right"}),e,l("small",null,l("em",null," ",t.fromNow)))}(t);case"game-end":return function(t){const e=g(t.data.perf),a=void 0===t.data.win?i("draw"):t.data.win?i("victory"):i("defeat"),n="game-end"+t.date;return l("li",{className:"list_item timelineEntry",key:n,"data-icon":e,"data-path":`/game/${t.data.playerId}?goingBack=1`},l("strong",null,a)," vs. ",t.data.opponent,l("small",null,l("em",null," ",t.fromNow)))}(t);case"tour-join":return function(t){const e=y("xCompetesInY",l("strong",t.data.userId),t.data.tourName),a="tour"+t.date;return l("li",{className:"list_item timelineEntry",key:a,"data-path":`/tournament/${t.data.tourId}`},l("span",{className:"fa fa-trophy"}),e,l("small",null,l("em",null," ",t.fromNow)))}(t);case"study-create":case"study-like":return function(t,e){var a;const n=t.data,s="study-create"===t.type?"xHostsY":"xLikesY",r=e[n.userId],o=y(s,f(void 0,null!==(a=r.patron)&&void 0!==a&&a,r.id,r.title),l("strong",t.data.studyName));return l("li.list_item.timelineEntry",{key:"study-like"+t.date,"data-path":`/study/${n.studyId}`},[l("span[data-icon=4].withIcon"),o,l("small",l("em",t.fromNow))])}(t,e);case"forum-post":return function(t,e){var a;const n=t.data,s=e[n.userId];return l("li.list_item.timelineEntry",{key:"forum-post"+n.postId,"data-external":`/forum/redirect/post/${n.postId}`},[f(void 0,null!==(a=s.patron)&&void 0!==a&&a,s.id,s.title),y("xPostedInForumY","",l("strong",n.topicName))," ",l("small",l("em",t.fromNow))])}(t,e);case"blog-post":return function(t){const e=t.data;return l("li.list_item.timelineEntry.blogEntry",{key:"blog-post"+e.id,"data-external":`/blog/${e.id}/${e.slug}`},[l("span[data-icon=6].withIcon"),l("span",e.title)," ",l("small",l("em",t.fromNow))])}(t);case"ublog-post":return function(t,e){var a;const n=t.data,s=e[n.userId];return l("li.list_item.timelineEntry",{key:`ublog-post${n.id}`,"data-external":`/@/${n.userId}/blog/${n.slug}/${n.id}`},[f(void 0,null!==(a=s.patron)&&void 0!==a&&a,s.id,s.title),y("xPublishedY","",l("strong",n.title))," ",l("small",l("em",t.fromNow))])}(t,e);case"ublog-post-like":return function(t,e){var a;const n=t.data,s=e[n.userId];return l("li.list_item.timelineEntry",{key:`ublog-post-like${n.id}`,"data-external":`/ublog/${n.id}/redirect`},[f(void 0,null!==(a=s.patron)&&void 0!==a&&a,s.id,s.title),y("xLikesY","",l("strong",n.title))," ",l("small",l("em",t.fromNow))])}(t,e);case"stream-start":return function(t){const e=t.data;return l("li.list_item.timelineEntry",{key:`stream-start${e.date}`,"data-external":`/streamer/${e.id}/redirect`},[l("span[data-icon=î€ƒ].withIcon"),l("strong",i("xStartedStreaming",e.name))," ",l("small",l("em",t.fromNow))])}(t);default:return null}}export{k as default,N as makeTimeline,I as renderTimelineEntry,v as supportedTypes,h as timelineOnTap};
