import{at as t,bg as e,Y as a,a6 as s,p as o,bh as n,d as i,r,m as c,bb as h,bc as d,o as l,z as u,af as p,v as g,be as b}from"./main.js";function m(e){return t(e.data.url.round)}function v(t,a,s=!1){return e(`/game/export/${t}${(s?"?evals=0&clocks=0":"?literate=1")+"&algebraic="+(a?"1":"0")}`,{headers:{Accept:"application/x-draughts-pdn, text/*","X-Requested-With":"__delete",[n]:"__delete"},credentials:"omit"},!0)}function x(e,a){return t("/api/crosstable/"+e+"/"+a,{cache:"reload"})}class NotesCtrl{constructor(t){var n;this.syncNotes=i((t=>{const n=t.target.value;var i,c;this.data.note!==n&&(i=this.data.game.id,c=n,e(`/${i}/note`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json, text/*"},body:a({text:c})},!1).catch((t=>{throw s.show({text:o("notesSynchronizationHasFailed"),duration:"short"}),t}))).then((()=>{this.data.note=n,r()}))}),1e3),this.open=()=>{c.backbutton.stack.push(h(this.close,"notes")),this.showing=!0},this.close=t=>{d.hide(),"backbutton"!==t&&this.showing&&c.backbutton.stack.pop(),this.showing=!1},this.syncing=!0,this.data=t,this.showing=!1,this.inputValue="",(n=t.game.id,e(`/${n}/note`)).then((t=>{this.data.note=t,this.syncing=!1,r()})).catch((()=>{this.syncing=!1,r(),s.show({text:"Could not read notes from server.",position:"bottom",duration:"short"})}))}}function w(t){return t.showing?l("div#notes.modal",{oncreate:b},[l("header",[l("button.modal_close",{oncreate:u(h(t.close,"notes"))},p),l("h2",o("notes"))]),l("div.modal_content",[t.syncing?l("div.notesTextarea.loading",g.getVdom()):l("textarea#notesTextarea.native_scroller",{placeholder:o("typePrivateNotesHere"),oninput:t.syncNotes,value:t.data.note})])]):null}export{NotesCtrl as N,x as a,v as g,w as n,m as r};
