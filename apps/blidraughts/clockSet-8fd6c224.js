import{o as e,a8 as t,p as i,e as n,ab as c,z as a,az as l,r,aI as o}from"./main.js";const m=1e3,s=6e4,u=100;function g(e,t){return l("hourglass"===e?Math.round(t):Math.floor(t))}function d(e){return void 0!==e.whiteMoves}function v(l,o){return{none:()=>"",simple:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect(i("time"),"time",n.clock.availableTimes,n.clock.simple.time,!1,o))),increment:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect(i("time"),"time",n.clock.availableTimes,n.clock.increment.time,!1,o)),e("div",{className:"select_input"},t.renderSelect(i("increment"),"increment",n.clock.availableIncrements.map(c),n.clock.increment.increment,!1,o))),handicapInc:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Top"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect(i("time"),"topTime",n.clock.availableTimes,n.clock.handicapInc.topTime,!1,o)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect(i("increment"),"topIncrement",n.clock.availableIncrements.map(c),n.clock.handicapInc.topIncrement,!1,o))),e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Bottom"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect(i("time"),"bottomTime",n.clock.availableTimes,n.clock.handicapInc.bottomTime,!1,o)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect(i("increment"),"bottomIncrement",n.clock.availableIncrements.map(c),n.clock.handicapInc.bottomIncrement,!1,o)))),delay:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect(i("time"),"time",n.clock.availableTimes,n.clock.delay.time,!1,o)),e("div",{className:"select_input"},t.renderSelect(i("increment"),"increment",n.clock.availableIncrements.map(c),n.clock.delay.increment,!1,o))),bronstein:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect(i("time"),"time",n.clock.availableTimes,n.clock.bronstein.time,!1,o)),e("div",{className:"select_input"},t.renderSelect(i("increment"),"increment",n.clock.availableIncrements.map(c),n.clock.bronstein.increment,!1,o))),hourglass:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect(i("time"),"time",n.clock.availableTimes,n.clock.hourglass.time,!1,o))),stage:()=>e("div",{className:"clockSettingParameters"},n.clock.stage.stages().map(((l,m)=>function(l,o){const m=f.bind(void 0,o),s=k.bind(void 0,o),u=n.clock.stage.stages().length>=5,g=n.clock.stage.stages().length<=2;return e("div",{className:"stageRow"},e("div",{className:"stageRowTitle"},o+1),e("div",{className:"select_input inline stage stageRowMember"},t.renderSelect(i("time"),"time",n.clock.availableTimes,m,!1,l)),e("div",{className:"select_input inline stage stageRowMember"+(o===n.clock.stage.stages().length-1?" lastStage":"")},t.renderSelect("Moves","moves",n.clock.availableMoves.map(c),s,!1,l)),e("div",{className:"stageRowMember addSubtractStage"+(o===n.clock.stage.stages().length-1?" lastStage":"")},e("span",{className:"fa fa-plus-square-o"+(u?" hiddenButton":""),oncreate:a((()=>function(e){const t=e();t[t.length-1].moves=t[t.length-2].moves,t.push({time:t[t.length-1].time,moves:null}),e(t),r()}(n.clock.stage.stages)))})," ",e("span",{className:"fa fa-minus-square-o"+(g?" hiddenButton":""),oncreate:a((()=>function(e){const t=e();t.length<=2||(t.pop(),e(t),r())}(n.clock.stage.stages)))})))}(o,m))),e("div",{className:"select_input"},t.renderSelect(i("increment"),"increment",n.clock.availableIncrements.map(c),n.clock.stage.increment,!1,o)))}[l]()}function f(e,t){const i=n.clock.stage.stages();return t&&(i[e].time=t,n.clock.stage.stages(i)),i[e].time}function k(e,t){const i=n.clock.stage.stages();return t&&(i[e].moves=t,n.clock.stage.stages(i)),i[e].moves}function h(e,t,i,n,c,a){let l,m,s,g={clockType:"handicapInc",whiteTime:0!==e?e:t,blackTime:0!==i?i:n,whiteIncrement:t,blackIncrement:n,activeSide:void 0,flagged:void 0,isRunning:!1};function d(){const e=performance.now();if("white"===v()){const t=e-m;m=e,g.whiteTime=Math.max(g.whiteTime-t,0),h()<=0&&(g.flagged="white",c(g.flagged),a&&o.dong(),clearInterval(l))}else if("black"===v()){const t=e-s;s=e,g.blackTime=Math.max(g.blackTime-t,0),w()<=0&&(g.flagged="black",c(g.flagged),a&&o.dong(),clearInterval(l))}r()}function v(){return g.activeSide}function f(){return g.flagged}function k(){return g.isRunning}function h(){return g.whiteTime}function w(){return g.blackTime}return{clockType:"handicapInc",getState:function(){return g},setState:function(e){g=e},activeSide:v,flagged:f,isRunning:k,clockHit:function(e){f()||(a&&o.clock(),"white"===e?("white"===v()&&(g.whiteTime=g.whiteTime+g.whiteIncrement),s=performance.now(),g.activeSide="black"):"black"===e&&("black"===v()&&(g.blackTime=g.blackTime+g.blackIncrement),m=performance.now(),g.activeSide="white"),clearInterval(l),l=setInterval(d,u),g.isRunning=!0,r())},startStop:function(){k()?(clearInterval(l),g.isRunning=!1):(g.isRunning=!0,"white"===v()?m=performance.now():s=performance.now(),l=setInterval(d,u))},whiteTime:h,blackTime:w,getTime:function(e){return"white"===e?h():w()},toggleActiveSide:function(){g.activeSide&&("white"===g.activeSide?(s=performance.now(),g.activeSide="black"):(m=performance.now(),g.activeSide="white"))},clear(){clearInterval(l)}}}function w(e,t,i){return h(e,t,e,t,i,!0)}var b={simple:e=>function(e,t){return w(e,0,t)}(Number(n.clock.simple.time())*s,e),increment:e=>w(Number(n.clock.increment.time())*s,Number(n.clock.increment.increment())*m,e),handicapInc:e=>h(Number(n.clock.handicapInc.topTime())*s,Number(n.clock.handicapInc.topIncrement())*m,Number(n.clock.handicapInc.bottomTime())*s,Number(n.clock.handicapInc.bottomIncrement())*m,e,!0),delay:e=>function(e,t,i,n){let c,a,l,m={clockType:"delay",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function s(){const e=performance.now();if("white"===g()){const t=e-a;a=e,Math.floor(m.whiteDelay)>0?m.whiteDelay=m.whiteDelay-t:(m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&o.dong(),clearInterval(c)))}else if("black"===g()){const t=e-l;l=e,m.blackDelay>0?m.blackDelay=m.blackDelay-t:(m.blackTime=Math.max(m.blackTime-t,0),f()<=0&&(m.flagged="black",i(m.flagged),n&&o.dong(),clearInterval(c)))}r()}function g(){return m.activeSide}function d(){return m.flagged}function v(){return m.whiteTime}function f(){return m.blackTime}return{clockType:"delay",getState:function(){return m},setState:function(e){m=e},activeSide:g,flagged:d,isRunning:function(){return m.isRunning},clockHit:function(e){d()||(n&&o.clock(),"white"===e?("white"===m.activeSide&&(m.blackDelay=m.increment),l=performance.now(),m.activeSide="black"):"black"===e&&("black"===m.activeSide&&(m.whiteDelay=m.increment),a=performance.now(),m.activeSide="white"),clearInterval(c),c=setInterval(s,u),m.isRunning=!0,r())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(s,u),"white"===g()?a=performance.now():l=performance.now())},whiteTime:v,blackTime:f,getTime:function(e){return"white"===e?v():f()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(l=performance.now(),m.activeSide="black"):(a=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(Number(n.clock.delay.time())*s,Number(n.clock.delay.increment())*m,e,!0),bronstein:e=>function(e,t,i,n){let c,a,l,m={clockType:"bronstein",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function s(){const e=performance.now();if("white"===m.activeSide){const t=e-a;a=e,m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteDelay=Math.max(m.whiteDelay-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&o.dong(),clearInterval(c))}else if("black"===g()){const t=e-l;l=e,m.blackTime=Math.max(m.blackTime-t,0),m.blackDelay=Math.max(m.blackDelay-t,0),m.blackTime<=0&&(m.flagged="black",i(m.flagged),n&&o.dong(),clearInterval(c))}r()}function g(){return m.activeSide}function d(){return m.whiteTime}function v(){return m.blackTime}return{clockType:"bronstein",getState:function(){return m},setState:function(e){m=e},activeSide:g,flagged:function(){return m.flagged},isRunning:function(){return m.isRunning},clockHit:function(e){m.flagged||(n&&o.clock(),"white"===e?("white"===m.activeSide&&(m.whiteTime=m.whiteTime+(m.increment-m.whiteDelay),m.blackDelay=m.increment),l=performance.now(),m.activeSide="black"):("black"===m.activeSide&&(m.blackTime=m.blackTime+(m.increment-m.blackDelay),m.whiteDelay=m.increment),a=performance.now(),m.activeSide="white"),c&&clearInterval(c),c=setInterval(s,u),m.isRunning=!0,r())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(s,u),"white"===m.activeSide?a=performance.now():l=performance.now())},whiteTime:d,blackTime:v,getTime:function(e){return"white"===e?d():v()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(l=performance.now(),m.activeSide="black"):(a=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(Number(n.clock.bronstein.time())*s,Number(n.clock.bronstein.increment())*m,e,!0),hourglass:e=>function(e,t,i){let n,c,a,l={clockType:"hourglass",whiteTime:e/2,blackTime:e/2,activeSide:void 0,flagged:void 0,isRunning:!1};function m(){const m=performance.now();if("white"===s()){const a=m-c;c=m,l.whiteTime=Math.max(l.whiteTime-a,0),l.blackTime=e-l.whiteTime,v()<=0&&(l.flagged="white",t(l.flagged),i&&o.dong(),clearInterval(n))}else if("black"===s()){const c=m-a;a=m,l.blackTime=Math.max(l.blackTime-c,0),l.whiteTime=e-l.blackTime,f()<=0&&(l.flagged="black",t(l.flagged),i&&o.dong(),clearInterval(n))}r()}function s(){return l.activeSide}function g(){return l.flagged}function d(){return l.isRunning}function v(){return l.whiteTime}function f(){return l.blackTime}return{clockType:"hourglass",getState:function(){return l},setState:function(e){l=e},activeSide:s,flagged:g,isRunning:d,clockHit:function(e){g()||(i&&o.clock(),"white"===e?(a=performance.now(),l.activeSide="black"):(c=performance.now(),l.activeSide="white"),n&&clearInterval(n),n=setInterval(m,u),l.isRunning=!0,r())},startStop:function(){d()?(l.isRunning=!1,clearInterval(n)):(l.isRunning=!0,n=setInterval(m,u),"white"===s()?c=performance.now():a=performance.now())},whiteTime:v,blackTime:f,getTime:function(e){return"white"===e?v():f()},toggleActiveSide:function(){l.activeSide&&("white"===l.activeSide?(a=performance.now(),l.activeSide="black"):(c=performance.now(),l.activeSide="white"))},clear(){clearInterval(n)}}}(Number(n.clock.hourglass.time())*s,e,!0),stage:e=>function(e,t,i,n){let c,a,l,m={clockType:"stage",whiteTime:Number(e[0].time)*s,blackTime:Number(e[0].time)*s,whiteMoves:Number(e[0].moves),blackMoves:Number(e[0].moves),whiteStage:0,blackStage:0,stages:e,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function g(){const e=performance.now();if("white"===m.activeSide){const t=e-a;a=e,m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&o.dong(),clearInterval(c))}else if("black"===m.activeSide){const t=e-l;l=e,m.blackTime=Math.max(m.blackTime-t,0),m.blackTime<=0&&(m.flagged="black",i(m.flagged),n&&o.dong(),clearInterval(c))}r()}function d(){return m.flagged}function v(){return m.whiteMoves}function f(){return m.blackMoves}function k(){return m.whiteTime}function h(){return m.blackTime}return{clockType:"stage",getState:function(){return m},setState:function(e){m=e},activeSide:function(){return m.activeSide},flagged:d,isRunning:function(){return m.isRunning},clockHit:function(e){if(d())return;n&&o.clock();const t=m.whiteMoves,i=m.blackMoves;"white"===e?(null!==t&&(m.whiteMoves=t-1),m.whiteTime=m.whiteTime+m.increment,0===m.whiteMoves&&(m.whiteStage=m.whiteStage+1,m.whiteTime=m.whiteTime+Number(m.stages[m.whiteStage].time)*s,m.whiteStage===m.stages.length-1?m.whiteMoves=null:m.whiteMoves=m.stages[m.whiteStage].moves),l=performance.now(),m.activeSide="black"):(null!==i&&(m.blackMoves=i-1),m.blackTime=m.blackTime+m.increment,0===m.blackMoves&&(m.blackStage=m.blackStage+1,m.blackTime=m.blackTime+Number(m.stages[m.blackStage].time)*s,m.blackStage===m.stages.length-1?m.blackMoves=null:m.blackMoves=m.stages[m.blackStage].moves),a=performance.now(),m.activeSide="white"),c&&clearInterval(c),c=setInterval(g,u),m.isRunning=!0,r()},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(g,u),"white"===m.activeSide?a=performance.now():l=performance.now())},whiteTime:k,blackTime:h,whiteMoves:v,blackMoves:f,getTime:function(e){return"white"===e?k():h()},getMoves:function(e){return"white"===e?v():f()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(l=performance.now(),m.activeSide="black"):(a=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(n.clock.stage.stages().map((e=>({time:Number(e.time),moves:null!==e.moves?Number(e.moves):null}))),Number(n.clock.stage.increment())*m,e,!0)};export{b as a,v as c,g as f,d as i};
