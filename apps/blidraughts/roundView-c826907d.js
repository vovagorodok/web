import{a7 as a,o as e,v as n,b as t,aT as o,z as r,p as s,aU as i,ar as c,C as l,aV as u,aW as d,m,ai as p,k as f,B as b,aX as h,al as g,ad as v,aY as y,aZ as w,aB as k,q as _,a_ as N,au as T,aN as O,M as C,a9 as A,aO as D,e as S,an as B,a$ as L,b0 as M,b1 as U,u as P,s as j,b2 as x,b3 as R,r as I,b4 as $,b5 as G,ay as E,b6 as V,a6 as F,n as Z,b7 as z}from"./main.js";import{r as H,a as W,u as q,b as K,g as X,m as Y,c as J,p as Q,d as aa,e as ea,h as na,t as ta,j as oa,k as ra,l as sa,n as ia}from"./game-3e605d21.js";import{l as ca}from"./layout-26cca27d.js";import{G as la}from"./GameTitle-898aeee2.js";import{C as ua}from"./CountdownTimer-ca9a10d1.js";import{B as da}from"./Board-25b97c43.js";import{S as ma}from"./index-28ac80d9.js";import{w as pa}from"./tournamentXhr-d3fb9e28.js";import{g as fa,n as ba}from"./notes-2c1d8afe.js";import{c as ha}from"./chat-1f5c68bb.js";var ga={view({attrs:p}){const{player:f,mini:b,isOpen:h,close:g,opponent:v,score:y}=p;return f.user?a("miniUserInfos",void 0,(()=>function(a,p,f,b){const h=p.user;if(!a||!h)return e("div",{className:"miniUser"},n.getVdom());const g=t.getUserId()===h.id,v=f.user,y=o(h),w=t.get(),k=w&&w.id,_=k&&a.crosstable&&a.crosstable.nbGames>0;return e("div",{className:"miniUser"},e("div",{className:"title"},e("div",{className:"username",oncreate:r((()=>m.set(`/@/${h.username}`)))},y),h.profile&&h.profile.country?e("p",{className:"country"},e("img",{className:"flag",src:u("images/flags/"+h.profile.country+".png")}),d[h.profile.country]):null),h.engine||h.booster?e("div",{className:"warning"},h.engine?s("thisPlayerUsesDraughtsComputerAssistance"):"",h.booster?s("thisPlayerArtificiallyIncreasesTheirRating"):""):null,a.perfs?e("div",{className:"mini_perfs"},Object.keys(a.perfs).map((n=>{const t=a.perfs[n];return e("div",{className:"perf"},e("span",{"data-icon":l(n)}),t.games>0?t.rating+(t.prov?"?":""):"-")}))):null,void 0!==k&&_?e("div",{className:"score_wrapper"},c("yourScore",e("span",{className:"score"},`${a.crosstable.users[k]} - ${a.crosstable.users[h.id]}`))):null,!_&&v&&b&&b.nbGames>0?e("div",{className:"score_wrapper"},"Lifetime score ",e("em",null,"vs")," ",i(f),":",e("br",null),e("span",{className:"score"},b.users[h.id])," - ",e("span",{className:"score"},b.users[v.id])):null,g?null:e("div",{className:"mini_user_actions_wrapper"},e("button",{"data-icon":"1",oncreate:r((()=>{m.set(`/@/${h.id}/tv`)}))},s("watchGames"))))}(b,f,v,y)),h,g):null}};var va={oninit({attrs:a}){const{ctrl:e,color:n}=a;this.clockOnCreate=({dom:a})=>{e.elements[n]=a,e.updateElement(n,e.millisOf(n))},this.clockOnUpdate=({dom:a})=>{e.elements[n]=a,e.updateElement(n,e.millisOf(n))}},view({attrs:a}){const{ctrl:n,color:t,isBerserk:o}=a,r=n.millisOf(t),s=t===n.times.activeColor,i=p({clock:!0,outoftime:!r,running:s,berserk:o});return e("div",{className:i,oncreate:this.clockOnCreate,onupdate:this.clockOnUpdate},ka(r,!1))}};const ya=":",wa=" ";function ka(a,e,n=!1){const t=new Date(a),o=t.getUTCMilliseconds(),r=_a(t.getUTCMinutes()),s=_a(t.getUTCSeconds());if(a>=36e5){return _a(t.getUTCHours())+(n&&o<500?wa:ya)+r}if(e){let e=Math.floor(o/100).toString();return!n&&a<1e3&&(e+="<huns>"+Math.floor(o/10)%10+"</huns>"),r+ya+s+"<tenths>."+e+"</tenths>"}return r+ya+s}function _a(a){return(a<10?"0":"")+a}var Na={standard:(a,n,t,o,i,c)=>n(a.data)&&f()?e("button",{className:i,"data-icon":t,oncreate:r(c||(()=>{a.socket.iface.send(i)}))},s(o)):null,bookmark:a=>t.isConnected()?e("button",{oncreate:r(a.toggleBookmark),"data-icon":a.data.bookmarked?"t":"s"},[s("bookmarkThisGame")]):null,toggleZen:a=>a.zenAvailable()?e("button",{className:a.isZen()?"on":"",oncreate:r(a.toggleZenMode)},[e("span.fa.fa-volume-off"),s("zenMode")]):null,shareLink:a=>e("button",{oncreate:r((()=>{const e=a.draughtsground.state.orientation;ma.share({url:`${Q(a.data)}/${e}#${a.vm.ply}`})}))},[s("shareGameURL")]),sharePDN:a=>e("button",{oncreate:r((function(){fa(a.data.game.id,a.isAlgebraic()).catch((a=>{throw v(a),a})).then((a=>ma.share({text:a})))}))},s("sharePDN")),submitMove:a=>e("div.negotiationButtonsWrapper",[e("p",s("moveConfirmation")),e("div.negotiationButtons",{className:a.vm.submitFeedback?"loading":""},[e("button.accept",{"data-icon":a.vm.submitFeedback?null:"E",oncreate:r((()=>a.submitMove(!0)))},a.vm.submitFeedback?n.getVdom("monochrome white"):null),e("button.decline",{"data-icon":"L",oncreate:r((()=>a.submitMove(!1)))})])]),resign:a=>H(a.data)&&!a.vm.confirmResign?e("button",{className:"resign","data-icon":"b",oncreate:r((()=>{a.vm.confirmResign=!0}))},s("resign")):null,resignConfirmation:a=>H(a.data)&&a.vm.confirmResign?e("div",{className:"negotiation"},e("div",{className:"binary_choice_wrapper"},e("button",{className:"binary_choice","data-icon":"E",oncreate:r((()=>{a.socket.iface.send("resign")}))},s("resign")),e("button",{className:"binary_choice","data-icon":"L",oncreate:r((()=>{a.vm.confirmResign=!1}))},s("cancel")))):null,forceResign:a=>W(a.data)?e("div.force_resign_zone",[e("div.notice",s("opponentLeftChoices")),e("div.binary_choice_wrapper",[e("button.binary_choice.left",{oncreate:r((()=>{a.socket.iface.send("resign-force")}))},s("forceResignation")),e("button.binary_choice.right",{oncreate:r((()=>{a.socket.iface.send("draw-force")}))},s("forceDraw"))])]):null,threefoldClaimDraw:a=>a.data.game.threefold?e("div.claim_draw_zone",[e("div.notice",s("threefoldRepetition")),e.trust("&nbsp;"),e("button[data-icon=E]",{oncreate:r((()=>{a.socket.iface.send("draw-claim")}))},s("claimADraw"))]):null,offerDraw:a=>a.vm.confirmDraw?null:e("button",{className:"draw-yes","data-icon":"2",oncreate:r((()=>{a.vm.confirmDraw=!0})),disabled:!a.canOfferDraw()},s("offerDraw")),drawConfirmation:a=>a.canOfferDraw()&&a.vm.confirmDraw?e("div",{className:"negotiation"},e("div",{className:"binary_choice_wrapper"},e("button",{className:"binary_choice","data-icon":"E",oncreate:r((()=>{a.vm.confirmDraw=!1,a.offerDraw()}))},s("offerDraw")),e("button",{className:"binary_choice","data-icon":"L",oncreate:r((()=>{a.vm.confirmDraw=!1}))},s("cancel")))):null,cancelDrawOffer:a=>a.data.player.offeringDraw?e("div.negotiation",[e("div.notice",s("drawOfferSent"))]):null,answerOpponentDrawOffer:a=>a.data.opponent.offeringDraw?e("div.negotiation",[e("div.notice",s("yourOpponentOffersADraw")),e("div.binary_choice_wrapper",[e("button.binary_choice[data-icon=E]",{oncreate:r((()=>{a.socket.iface.send("draw-yes")}))},s("accept")),e("button.binary_choice[data-icon=L]",{oncreate:r((()=>{a.socket.iface.send("draw-no")}))},s("decline"))])]):null,cancelTakebackProposition:a=>a.data.player.proposingTakeback?e("div.negotiation",[e("div.notice",s("takebackPropositionSent")),e("button[data-icon=L]",{oncreate:r((()=>{a.socket.iface.send("takeback-no")}))},s("cancel"))]):null,answerOpponentTakebackProposition:a=>a.data.opponent.proposingTakeback?e("div.negotiation",[e("div.notice",s("yourOpponentProposesATakeback")),e("div.binary_choice_wrapper",[e("button.binary_choice[data-icon=E]",{oncreate:r((()=>{a.acceptTakeback()}))},s("accept")),e("button.binary_choice[data-icon=L]",{oncreate:r((()=>{a.socket.iface.send("takeback-no")}))},s("decline"))])]):null,analysisBoard(a){const n=a.data;return q(n)||K(n)?e("button",{oncreate:r(a.goToAnalysis)},[e("span[data-icon=A].withIcon"),s("analysis")]):null},notes:a=>a.notes?e("button",{oncreate:r((()=>a.notes&&a.notes.open()))},[e("span.fa.fa-pencil.withIcon"),s("notes")]):null,analysisBoardIconOnly(a){const n=a.data;return q(n)||K(n)?e("button.action_bar_button[data-icon=A]",{oncreate:r(a.goToAnalysis)}):null},newOpponent(a){const n=a.data,t=(X.finished(n)||X.aborted(n))&&("lobby"===n.game.source||"pool"===n.game.source);return!a.data.opponent.ai&&t?e("button[data-icon=r]",{oncreate:r((()=>{a.hideActions(),g.onNewOpponent(a.data)}))},s("newOpponent")):null},rematch(a){const n=a.data,t=!n.game.rematch&&(X.finished(n)||X.aborted(n))&&!n.game.tournamentId&&!n.game.boosted&&(n.opponent.onGame||!n.clock&&n.player.user&&n.opponent.user);return a.data.opponent.offeringRematch?e("div.negotiation",[e("div.notice",s("yourOpponentWantsToPlayANewGameWithYou")),e("div.binary_choice_wrapper",[e("button.binary_choice[data-icon=E]",{oncreate:r((()=>{a.socket.iface.send("rematch-yes")}))},s("joinTheGame")),e("button.binary_choice[data-icon=L]",{oncreate:r((()=>{a.socket.iface.send("rematch-no")}))},s("decline"))])]):a.data.player.offeringRematch?e("div.negotiation",[e("div.notice",s("rematchOfferSent")),e("div.notice",s("waitingForOpponent")),e("button[data-icon=L]",{oncreate:r((()=>{a.socket.iface.send("rematch-no")}))},s("cancelRematchOffer"))]):e("button",{oncreate:r((()=>{a.socket.iface.send("rematch-yes")})),disabled:!t},[e("span.fa.fa-refresh"),s("rematch")])},moretime:a=>Y(a.data)?e("button[data-icon=O]",{oncreate:r(a.socket.moreTime)},b("giveNbSeconds",15)):null,flipBoard(a){const n=p({action_bar_button:!0,highlight:a.vm.flip});return e("button",{className:n,"data-icon":"B",oncreate:r(a.flip)})},first(a){const n=a.vm.ply-1,t=a.vm.ply!==n&&n>=a.firstPly(),o=p({action_bar_button:!0,fa:!0,"fa-fast-backward":!0,disabled:!t});return e("button",{className:o,oncreate:r(a.jumpFirst)})},autocomplete(a){const n=a.draughtsground.state.peripheral,t=!n.isSynchronized&&n.isSettable,o=p({action_bar_button:!0,fa:!0,"fa-magic":!0,disabled:!t});return h.features().setState?e("button",{className:o,oncreate:r(h.onCentralSetState)}):null},backward(a){const n=a.vm.ply-1,t=a.vm.ply!==n&&n>=a.firstPly(),o=p({action_bar_button:!0,fa:!0,"fa-backward":!0,disabled:!t});return e("button",{className:o,oncreate:r(a.jumpPrev,void 0,a.jumpPrev)})},forward(a){const n=a.vm.ply+1,t=a.vm.ply!==n&&n<=a.lastPly(),o=p({action_bar_button:!0,fa:!0,"fa-forward":!0,disabled:!t});return e("button",{className:o,oncreate:r(a.jumpNext,void 0,a.jumpNext)})},last(a){const n=a.vm.ply+1,t=a.vm.ply!==n&&n<=a.lastPly(),o=p({action_bar_button:!0,fa:!0,"fa-fast-forward":!0,disabled:!t});return e("button",{className:o,oncreate:r(a.jumpLast)})},returnToTournament:a=>e("button",{oncreate:r((function(){a.hideActions();const e=`/tournament/${a.data.game.tournamentId}`;a.data.tv?m.set(e):m.set(e,!0)}))},e("span",{className:"fa fa-trophy"}),s("backToTournament")),withdrawFromTournament:(a,n)=>e("button",{oncreate:r((function(){a.hideActions(),pa(n),m.set(`/tournament/${n}`,!0)}))},e("span",{className:"fa fa-flag"}),"Pause"),goBerserk(a){if(!J(a.data))return null;if(a.vm.goneBerserk[a.data.player.color])return null;return e("button",{className:"berserk",oncreate:r((function(){a.hideActions(),a.goBerserk()}))},e("span",{"data-icon":"`"})," GO BERSERK!",e("br",null),e("small",null,"Half the time, bonus point"))}};function Ta(a,e){return(a/Math.pow(10,e)).toFixed(e).substr(2)}function Oa(a){const e=new Date(a),n=Ta(e.getUTCMinutes(),2),t=Ta(e.getSeconds(),2);let o,r="";if(a>=864e5){const a=e.getUTCDate()-1;o=e.getUTCHours(),r+=b("nbDays",a),0!==o&&(r+=" "+b("nbHours",o))}else a>=36e5?(o=e.getUTCHours(),r+=Ta(o,2)+":"+n):r+=n+":"+t;return r+(f()?"":"?")}function Ca(a){a&&w((()=>{const e=a.querySelector(".current");e&&(a.scrollTop=e.offsetTop-a.offsetHeight/2+e.offsetHeight/2)}))}function Aa(a){a&&w((()=>{const e=a.querySelector(".current");e&&(a.scrollLeft=e.offsetLeft-a.offsetWidth/2+e.offsetWidth/2)}))}function Da(a){const e=a.target;return"MOVE"===e.tagName?e:k(e,"move")}function Sa(a,e){const n=Da(e);n&&n.dataset.ply&&a.jump(Number(n.dataset.ply))}function Ba(a,e){a.ply=e.ply,a.fen=e.fen,a.san=null!==a.san&&null!==e.san?a.san.slice(0,a.san.indexOf("x")+1)+e.san.substr(e.san.indexOf("x")+1):a.san,a.uci=null!==a.uci&&null!==e.uci?a.uci+e.uci.substr(2,2):a.uci}function La(a,e){return 0===a.length||0===y(a[a.length-1].fen)?a.push(e):Ba(a[a.length-1],e),y(a[a.length-1].fen)>0&&a[a.length-1].ply++,a[a.length-1]}function Ma(a){const e=[];if(0===a.length)return e;if(e.push(a[0]),1===a.length)return e;for(let n=1;n<a.length;n++){const t=a[n-1];if(void 0===t.captLen||t.captLen<2||t.ply<a[n].ply)e.push(a[n]);else{const o=a[n];for(let e=0;e<t.captLen-1&&n+1<a.length;e++){if(0===e)o.uci=o.uci.slice(0,4);else if(a[n].uci.slice(-2)!==a[n+1].uci.slice(0,2))break;n++,Ba(o,a[n])}y(o.fen)>0&&o.ply++,e.push(o)}}return e}function Ua(a){return!a.vm.moveList||a.isZen()?null:e("div.replay.box",{oncreate:e=>{setTimeout((()=>Ca(e.dom)),100),_((e=>Sa(a,e)),void 0,Da)(e)},onupdate:a=>Ca(a.dom)},ja(a))}function Pa(a){return a.vm.moveList?e("div.replay_inline",{className:p({hidden:a.isZen()}),oncreate:e=>{setTimeout((()=>Aa(e.dom)),100),N((e=>Sa(a,e)),void 0,Da)(e)},onupdate:a=>Aa(a.dom)},ja(a)):null}function ja(a){return a.data.steps.filter((a=>null!==a.san)).map((n=>{return e("move.replayMove",{className:n.ply===a.vm.ply?"current":"","data-ply":n.ply},[1&n.ply?(t=n.ply,o=!0,e("index",xa(t,o))):null,a.isAlgebraic()?T(n.san):n.san]);var t,o}))}function xa(a,e){return function(a){return Math.floor((a-1)/2)+1}(a)+(e?a%2==1?".":"...":"")}function Ra(a){const n=O();return ca.board(function(a){let n;n=a.goingBack||!a.data.tv&&!a.data.userTV&&a.data.player.spectator?[B([Va(a),L(a.toggleBookmark,a.data.bookmarked)])]:[M(),Va(a)];return n.push(U()),e("nav",{key:"roundHeader",className:j.isConnected()?"":"reconnecting"},n)}(a),function(a,n){const t=C(),o=a.draughtsground.getMaterialDiff(),r=!a.data.tv&&a.vm.flip,s=Wa(a,a.data.player,o[a.data.player.color],"player",r),i=Wa(a,a.data.opponent,o[a.data.opponent.color],"opponent",r),c=aa(a.data),l=ea(a.data),u=e(da,{variant:a.data.game.variant.key,draughtsground:a.draughtsground},c?[l?null:Za(a,"opponent",l),l?Za(a,"player",l):null]:[]);return n?[D(t,n)?Pa(a):null,r?s:i,u,r?i:s,Xa(a)]:[u,e("section.table",[r?s:i,Ua(a),Xa(a),r?i:s])]}(a,n),"round",function(a){let n=!a.data.opponent.user||a.data.player.spectator?s("chat"):a.data.opponent.user.username;const t=a.data.watchers;a.data.player.spectator&&t&&t.nb>=2?n=s("spectators")+" "+t.nb:a.data.player.spectator&&(n=s("spectatorRoom"));return[a.chat?ha(a.chat,n):null,a.notes?ba(a.notes):null,Ka(a),za(a),e(ga,{player:a.data.player,opponent:a.data.opponent,mini:a.vm.miniUser.player.data,score:a.score,isOpen:a.vm.miniUser.player.showing,close:()=>a.closeUserPopup("player")}),e(ga,{player:a.data.opponent,opponent:a.data.player,mini:a.vm.miniUser.opponent.data,score:a.score,isOpen:a.vm.miniUser.opponent.showing,close:()=>a.closeUserPopup("opponent")})]}(a),void 0,void 0,"roundView")}function Ia(a,n){const t=a&&$(a)?a:"standard";return ca.board(function(a,n){const t=[M(),Fa(a,n),U()];return e("nav",{className:j.isConnected()?"":"reconnecting"},t)}(a,n),Ga(P,"white",t))}function $a(a){const n=Object.keys(a.pieces).map((n=>a.pieces[n]?e("div.tomb",Array.from(Array(a.pieces[n]).keys()).map((a=>e("piece",{className:n})))):null));return a.score>0&&n.push(e("span","+"+a.score)),n}function Ga(a,n,t,o,r,s){const i=O(),c=C(),l=e("section",{className:"board_wrapper"+(r?" "+r:"")},e(A,{fen:a,lastMove:o,orientation:n,variant:t,customPieceTheme:s})),u=D(c,i)&&S.game.moveList()&&!S.game.zenMode();return i?e.fragment({},[u?e("div.replay_inline"):null,e("section.playTable.opponent"),l,e("section.playTable.player"),e("section.actions_bar")]):e.fragment({},[l,e("section.table")])}const Ea={view:()=>ca.board(z(),Ga(P,"white","standard"),"roundView")};function Va(a){const n=a.data,o=a.data.tournament;if(a.vm.offlineWatcher||j.isConnected()){const r=!n.player.spectator&&"correspondence"===n.game.speed;return a.data.tv?e("div.main_header_title.withSub",[e("h1.header-gameTitle",[qa(a.onFeatured)]),e("h2.header-subTitle",ta(a.data))]):a.data.userTV?e("div.main_header_title.withSub",[e("h1.header-gameTitle",[e("span.withIcon[data-icon=1]"),a.data.userTV]),e("h2.header-subTitle",[e(`span.withIcon[data-icon=${l(a.data.game.perf)}]`),ta(a.data)].concat(o?[" • ",e("span.fa.fa-trophy"),e(ua,{seconds:o.secondsToFinish||0})]:[]))]):e(la,{data:a.data,kidMode:t.isKidMode(),subTitle:o?"tournament":r?"corres":"date"})}return e("div",{className:"main_header_title reconnecting"},G)}function Fa(a,n){return a?e("div.main_header_title.withSub",[e("h1.header-gameTitle",[e("span.withIcon[data-icon=1]"),"Lidraughts TV"]),e("h2.header-subTitle",qa(n))]):e("div",{className:"main_header_title reconnecting"},G)}function Za(a,n,t){const o=a.data.expiration;if(!o)return null;const r=Math.max(0,o.movedAt-Date.now()+o.millisToMove);return e("div.round-expiration",{className:n},e(ua,{seconds:Math.round(r/1e3),emergTime:t?8:void 0,textWrap:(a,e)=>b("nbSecondsToPlayTheFirstMove",a,`<strong>${e}</<strong>`),showOnlySecs:!0}))}function za(a){return a.vm.moveToSubmit||a.vm.dropToSubmit||a.vm.submitFeedback?e("div",{className:"overlay_popup_wrapper submitMovePopup"},e("div",{className:"overlay_popup"},Na.submitMove(a))):null}function Ha(a,n,t,o){const s=function(a){var n,t,o;const r=(null===(n=a.user)||void 0===n?void 0:n.displayName)||a.name||a.username||(null===(t=a.user)||void 0===t?void 0:t.username);return r?e("span",[E(null===(o=a.user)||void 0===o?void 0:o.title),r]):a.ai?V({ai:a.ai}):"Anonymous"}(n),c=n.user?r((()=>n.user?a.openUserPopup(o,n.user.id):Z),(()=>function(a,e,n){let t;t=a?`${n}: ${a.online?"connected to lidraughts":"offline"}; ${e.onGame?"currently on this game":"currently not on this game"}`:n;F.show({text:t,position:"center",duration:"short"})}(n.user,n,i(n)))):r(Z,(()=>{var a,e;return F.show({text:(null===(a=n.user)||void 0===a?void 0:a.displayName)||n.name||n.username||(null===(e=n.user)||void 0===e?void 0:e.username),position:"center",duration:"short"})})),l=a.data.tournament&&a.data.tournament.ranks?"#"+a.data.tournament.ranks[n.color]+" ":null,u=n.user,d=a.vm.goneBerserk[n.color];return e("div",{className:"antagonistInfos"+(a.isZen()?" zen":""),oncreate:c},e("h2",{className:"antagonistUser"},u&&u.patron?e("span",{className:"patron status "+(n.onGame?"ongame":"offgame"),"data-icon":""}):e("span",{className:"fa fa-circle status "+(n.onGame?"ongame":"offgame")}),l,s,d?e("span",{className:"berserk","data-icon":"`"}):null),e("div",{className:"ratingAndMaterial"},"opponent"===o&&u&&(u.engine||u.booster)?e("span",{className:"warning","data-icon":"j"}):null,u?e("h3",{className:"rating"},n.rating,n.provisional?"?":"",x(n)):n.ai?e("h3",{className:"rating"},R[n.ai]):null,a.vm.showCaptured?$a(t):null))}function Wa(a,n,t,o,r){const s=p({playTable:!0,clockOnLeft:"left"===a.vm.clockPosition});return e("section",{className:s+" "+o},Ha(a,n,t,o),a.clock?[e(va,{key:r.toString(),ctrl:a.clock,color:n.color,isBerserk:a.vm.goneBerserk[n.color]})]:a.correspondenceClock?function(a,n,t){const o=a.data[n],r="correspondence clock "+p({outoftime:!o,running:t===n,emerg:o<a.data.emerg,offline:!f()});return e("div",{className:r},Oa(1e3*o))}(a.correspondenceClock,n.color,a.data.game.player):null)}function qa(a){const n=S.tv.channel(),t=l(n);return e("div.select_input.main_header-selector.round-tvChannelSelector",[e("label",{for:"channel_selector"},[e(`i[data-icon=${t}]`),e("span",e.trust("&nbsp;")),e("span","Lidraughts TV")]),e("select#channel_selector",{value:n,onchange(e){const n=e.target.value;S.tv.channel(n),a&&a(),setTimeout(I,10)}},S.tv.availableChannels.map((a=>e("option",{key:a[1],value:a[1]},a[0]))))])}function Ka(n){const t=aa(n.data)?void 0:()=>function(a){const n=sa(a.data),t=ia(a.data,a.data.game.winner),o=X.toLabel(a.data.game.status.name,a.data.game.winner,a.data.game.variant.key)+(t?("mate"!==a.data.game.status.name?". ":"")+s("white"===t.color?"whiteIsVictorious":"blackIsVictorious")+".":"");return(X.aborted(a.data)?[]:[e("strong",n),e("br")]).concat([e("em.resultStatus",o)])}(n);return a("player_controls",n.vm.showingShareActions?void 0:t,(()=>aa(n.data)?function(a){return e("div.gameControls",{key:"gameRunningActions"},a.data.player.spectator?[Na.shareLink(a)]:[Na.toggleZen(a),Na.analysisBoard(a),Na.notes(a),Na.moretime(a),Na.standard(a,oa,"L","abortGame","abort")].concat(W(a.data)?[Na.forceResign(a)]:[Na.standard(a,ra,"i","proposeATakeback","takeback-yes"),Na.cancelTakebackProposition(a),Na.offerDraw(a),Na.drawConfirmation(a),Na.cancelDrawOffer(a),Na.threefoldClaimDraw(a),Na.resign(a),Na.resignConfirmation(a),Na.goBerserk(a),Na.answerOpponentDrawOffer(a),Na.answerOpponentTakebackProposition(a)]))}(n):function(a){let n;const t=a.data.game.tournamentId,o=e("button",{oncreate:r(a.showShareActions)},[e("span.fa.fa-share-alt"),s("shareAndExport")]);return n=a.vm.showingShareActions?[Na.shareLink(a),Na.sharePDN(a)]:t?a.data.player.spectator?[o,Na.analysisBoard(a),Na.returnToTournament(a)]:[o,Na.analysisBoard(a),Na.withdrawFromTournament(a,t),Na.returnToTournament(a)]:a.data.player.spectator?[o,Na.analysisBoard(a)]:[o,Na.analysisBoard(a),Na.notes(a),Na.newOpponent(a),Na.rematch(a)],e("div.game_controls",{key:"gameEndedActions"},e.fragment({key:a.vm.showingShareActions?"shareMenu":"menu"},n))}(n)),n.vm.showingActions,n.hideActions)}function Xa(a){const n=(a.data.opponent.proposingTakeback||a.data.opponent.offeringDraw)&&!X.finished(a.data)||W(a.data)||a.data.opponent.offeringRematch,t=(a.data.opponent.proposingTakeback?["fa","fa-mail-reply"]:["fa","fa-list"]).concat(["action_bar_button",n?"glow":""]).join(" "),o=a.data.opponent.offeringDraw?"2":null,s=e("button",o?{className:t,"data-icon":o,oncreate:r(a.showActions)}:{className:t,oncreate:r(a.showActions)});return e("section",{className:"actions_bar"},s,a.chat&&!a.isZen()?e("button",{className:"action_bar_button fa fa-comments withChip",oncreate:r(a.chat.open)},a.chat.nbUnread>0?e("span",{className:"chip"},a.chat.nbUnread<=99?a.chat.nbUnread:99):null):null,na(a.data)?function(a){return e("button.action_bar_button[data-icon=A].withChip",{oncreate:r(a.goToAnalysis)},(a.data.forecastCount||0)>0?e("span.chip",a.data.forecastCount):null)}(a):null,Na.flipBoard(a),aa(a.data)?null:Na.analysisBoardIconOnly(a),Na.autocomplete(a),Na.backward(a),Na.forward(a))}export{Ea as L,Ca as a,Aa as b,Ra as c,Oa as d,La as e,ka as f,Da as g,Ia as h,Ma as m,Sa as o,$a as r,Ga as v};
